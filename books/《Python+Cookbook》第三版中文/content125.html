<div id="pf7d" class="pf w0 h0" data-page-no="7d"><div class="pc pc7d w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg7d.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 h11 y181 ffa fs5 fc9 sc0 ls0 ws13b">Depth-first traversal</div><div class="t m0 x15 h15 y182 ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x15 hf y184 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, start_node):</span></span></span></div><div class="t m0 x16 hf y185 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws458">_node </span><span class="ls32">=</span><span class="fc0">start_node</span></span></div><div class="t m0 x16 hf y186 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws169">_children_iter </span><span class="ls33">=</span></span>None</div><div class="t m0 x16 hf y187 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws208">_child_iter </span><span class="ls33">=</span></span>None</div><div class="t m0 x15 hf y98e ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__iter__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y98f ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8">self</span></div><div class="t m0 x15 hf y991 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__next__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 h11 y992 ffa fs5 fcd sc0 ls0 ws4"># Return myself if just started; create an iterator for children</div><div class="t m0 x16 hf y993 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0 ws169">_children_iter </span></span>is <span class="ff8 ws13a">None<span class="fc0">:</span></span></div><div class="t m0 x17 hf ya70 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws169">_children_iter </span><span class="ls33">=</span></span>iter<span class="fc0">(</span>self<span class="fc6 ls34">.</span><span class="fc0">_node)</span></div><div class="t m0 x17 hf y994 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">self<span class="fc6">.<span class="fc0">_node</span></span></span></div><div class="t m0 x16 h11 y995 ffa fs5 fcd sc0 ls0 ws4"># If processing a child, return its next item</div><div class="t m0 x16 hf y996 ff7 fs5 fca sc0 ls0 ws218">elif <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0">_child_iter:</span></span></div><div class="t m0 x17 hf y997 ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x18 hf y998 ff8 fs5 fc0 sc0 ls0 ws16e">nextchild <span class="fc6 ls32">=</span><span class="fca ws13a">next</span><span class="ls34">(</span><span class="fca ws13a">self<span class="fc6 ls34">.</span></span>_child_iter)</div><div class="t m0 x18 hf ya71 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">nextchild</span></div><div class="t m0 x17 hf y999 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 ws13a">StopIteration<span class="fc0">:</span></span></div><div class="t m0 x18 hf y99a ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws208">_child_iter </span><span class="ls32">=</span></span>None</div><div class="t m0 x18 hf y99b ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">next<span class="fc0">(</span>self<span class="fc0">)</span></span></div><div class="t m0 x16 h11 y99c ffa fs5 fcd sc0 ls0 ws4"># Advance to the next child and start its iteration</div><div class="t m0 x16 hf yddb ff7 fs5 fca sc0 ls0 ws156">else<span class="ff8 fc0">:</span></div><div class="t m0 x17 hf y99d ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws208">_child_iter </span><span class="ls33">=</span></span>next<span class="fc0 ls34">(</span>self<span class="fc6 ls34">.</span><span class="fc0">_children_iter)<span class="fc6">.</span>depth_first()</span></div><div class="t m0 x17 hf y99e ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">next<span class="fc0">(</span>self<span class="fc0">)</span></span></div><div class="t m0 x0 h9 yddc ff6 fs3 fc0 sc0 ls0 ws58e">DepthFirstIterator <span class="ff1 ls30 ws138">类和上面使用生成器的版本工作原理类似<span class="_ _1"></span>，但是它写起来很</span></div><div class="t m0 x5 h9 y7bb ff1 fs3 fc0 sc0 ls1e ws111">繁琐<span class="_ _1"></span>，因为迭代器必须在迭代处理过程中维护大量的状态信息<span class="_ _1"></span>。坦白来讲，没人<span class="_ _1"></span>愿意</div><div class="t m0 x5 h9 y7bc ff1 fs3 fc0 sc0 ls0">写这么晦涩的代码。将你的迭代器定义为一个生成器后一切迎刃而解。</div><div class="t m0 x5 hd yddd ff2 fs4 fc4 sc0 ls0 ws134">6.5<span class="_ _e"> </span>4.5 <span class="ff1">反向迭代</span></div><div class="t m0 x5 he ydde ff2 fs2 fc4 sc0 ls0 ws135">6.5.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 yddf ff1 fs3 fc0 sc0 ls0">你想反方向迭代一个序列</div><div class="t m0 x5 he yde0 ff2 fs2 fc4 sc0 ls0 ws135">6.5.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 yde1 ff1 fs3 fc0 sc0 ls0 ws38">使用内置的 <span class="ff6 ws17c">reversed() </span>函数，比如：</div><div class="t m0 x5 hf yde2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls34">[<span class="fc7 ls0 ws13a">1</span><span class="ls33">,<span class="fc7 ls0 ws13a">2</span>,</span><span class="fc7">3</span></span>,<span class="fc7 ls34">4</span><span class="ls0">]</span></span></div><div class="t m0 x5 hf yde3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">x</span><span class="ws157">in <span class="ff8 ws13a">reversed<span class="fc0">(a):</span></span></span></span></div><div class="t m0 x5 hf yde4 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(x)</span></span></div><div class="t m0 x5 h10 yde5 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">6.5.<span class="_ _5"> </span>4.5 <span class="ff1 ws563">反向迭代 </span>116</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
