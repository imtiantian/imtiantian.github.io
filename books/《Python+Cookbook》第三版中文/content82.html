<div id="pf52" class="pf w0 h0" data-page-no="52"><div class="pc pc52 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg52.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x16 hf y928 ff8 fs5 fc9 sc0 ls0 ws4">&quot;expression ::= term { (<span class="ff9 ls34">&apos;<span class="ff8">+</span><span class="ls0 ws13b">&apos;<span class="ffd">|</span></span>&apos;<span class="ff8">-</span>&apos;</span><span class="ws13b">) term }*&quot;</span></div><div class="t m0 x16 hf y929 ff8 fs5 fc0 sc0 ls0 ws155">exprval <span class="fc6 ls32">=</span><span class="fca ws13a">self<span class="fc6 ls34">.</span></span>term()</div><div class="t m0 x16 hf y92a ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0">_accept(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">PLUS<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws160">or <span class="ff8 ws13a">self<span class="fc6">.<span class="fc0">_accept(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">MINUS<span class="ff9 ls34">&apos;</span></span>):</span></span></span></span></div><div class="t m0 x17 hf y92b ff8 fs5 fc0 sc0 ls0 ws159">op <span class="fc6 ls32">=</span><span class="fca ws13a">self<span class="fc6 ls34">.</span><span class="fc0">tok<span class="fc6 ls34">.</span>type</span></span></div><div class="t m0 x17 hf y92c ff8 fs5 fc0 sc0 ls0 ws15f">right <span class="fc6 ls33">=</span><span class="fca ws13a">self<span class="fc6 ls34">.</span></span>term()</div><div class="t m0 x17 hf y92d ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws159">op <span class="fc6">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">PLUS<span class="ff9 ls34">&apos;</span></span></span>:</span></div><div class="t m0 x18 hf y92e ff8 fs5 fc0 sc0 ls0 ws1f4">exprval <span class="fc6 ws1a1">+= </span>right</div><div class="t m0 x17 hf y92f ff7 fs5 fca sc0 ls0 ws218">elif <span class="ff8 fc0 ws15c">op <span class="fc6 ws159">== <span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">MINUS</span><span class="ls34">&apos;</span></span></span>:</span></div><div class="t m0 x18 hf y930 ff8 fs5 fc0 sc0 ls0 ws1f4">exprval <span class="fc6 ws1a1">-= </span>right</div><div class="t m0 x16 hf y931 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">exprval</span></div><div class="t m0 x15 hf y932 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">term<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y933 ff8 fs5 fc9 sc0 ls0 ws4">&quot;term ::= factor { (<span class="ff9 ls34">&apos;<span class="ff8">*</span>&apos;</span><span class="ffd ws13b">|<span class="ff9">&apos;</span></span><span class="ls34">/<span class="ff9">&apos;</span></span><span class="ws13b">) factor }*&quot;</span></div><div class="t m0 x16 hf y934 ff8 fs5 fc0 sc0 ls0 ws155">termval <span class="fc6 ls32">=</span><span class="fca ws13a">self<span class="fc6 ls34">.</span></span>factor()</div><div class="t m0 x16 hf y935 ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0">_accept(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">TIMES<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws157">or <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0">_accept(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">DIVIDE<span class="ff9 ls34">&apos;</span></span>):</span></span></span></div><div class="t m0 x17 hf y936 ff8 fs5 fc0 sc0 ls0 ws159">op <span class="fc6 ls32">=</span><span class="fca ws13a">self<span class="fc6 ls34">.</span><span class="fc0">tok<span class="fc6 ls34">.</span>type</span></span></div><div class="t m0 x17 hf y937 ff8 fs5 fc0 sc0 ls0 ws15f">right <span class="fc6 ls33">=</span><span class="fca ws13a">self<span class="fc6 ls34">.</span></span>factor()</div><div class="t m0 x17 hf y938 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws159">op <span class="fc6">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">TIMES<span class="ff9 ws13b">&apos;</span></span></span>:</span></div><div class="t m0 x18 hf y939 ff8 fs5 fc0 sc0 ls0 ws1f4">termval <span class="fc6 ws1a1">*= </span>right</div><div class="t m0 x17 hf y93a ff7 fs5 fca sc0 ls0 ws218">elif <span class="ff8 fc0 ws15c">op <span class="fc6 ws159">== <span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">DIVIDE</span><span class="ls34">&apos;</span></span></span>:</span></div><div class="t m0 x18 hf y93b ff8 fs5 fc0 sc0 ls0 ws1f4">termval <span class="fc6 ws1a1">/= </span>right</div><div class="t m0 x16 hf y93c ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">termval</span></div><div class="t m0 x15 hf y93d ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">factor<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y93e ff8 fs5 fc9 sc0 ls0 ws13b">&quot;factor ::= NUM <span class="ffd lsbd">|</span><span class="ws4">( expr )&quot;</span></div><div class="t m0 x16 hf y93f ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0">_accept(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">NUM<span class="ff9 ls34">&apos;</span></span>):</span></span></div><div class="t m0 x17 hf y940 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">int<span class="fc0 ls34">(</span>self<span class="fc6">.<span class="fc0">tok</span>.<span class="fc0">value)</span></span></span></div><div class="t m0 x16 hf y941 ff7 fs5 fca sc0 ls0 ws218">elif <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0">_accept(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">LPAREN<span class="ff9 ls34">&apos;</span></span>):</span></span></div><div class="t m0 x17 hf y942 ff8 fs5 fc0 sc0 ls0 ws155">exprval <span class="fc6 ls32">=</span><span class="fca ws13a">self<span class="fc6 ls34">.</span></span>expr()</div><div class="t m0 x17 hf y943 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">_expect(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">RPAREN<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x17 hf y944 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">exprval</span></div><div class="t m0 x16 hf y945 ff7 fs5 fca sc0 ls0 ws156">else<span class="ff8 fc0">:</span></div><div class="t m0 x17 hf y946 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">SyntaxError<span class="fc0 ls34">(<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws4">Expected NUMBER or LPAREN<span class="ff9 ws13b">&apos;</span><span class="fc0">)</span></span></span></div><div class="t m0 x5 hf y947 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">descent_parser<span class="fc0">():</span></span></div><div class="t m0 x15 hf y948 ff8 fs5 fc0 sc0 ls32">e<span class="fc6 ls33">=</span><span class="ls0">ExpressionEvaluator()</span></div><div class="t m0 x15 hf y949 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(e<span class="fc6 ls34">.</span>parse(<span class="ff9 fc9 ls34">&apos;<span class="ff8">2</span><span class="ls0 ws13b">&apos;</span></span>))</span></div><div class="t m0 x15 hf y94a ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(e<span class="fc6 ls34">.</span>parse(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13b">2 + 3<span class="ff9 ls34">&apos;</span></span>))</span></div><div class="t m0 x15 hf y94b ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(e<span class="fc6 ls34">.</span>parse(<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls5e ws209">2+3*4<span class="_ _15"></span><span class="ff9 ls34">&apos;<span class="ff8 fc0 ls0">))</span></span></span></span></span></div><div class="t m0 x15 hf y94c ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(e<span class="fc6 ls34">.</span>parse(<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls5e ws209">2+(<span class="_ _3"></span>3+4<span class="_ _15"></span>)*5<span class="_ _21"></span><span class="ff9 ls0 ws13b">&apos;<span class="ff8 fc0">))</span></span></span></span></span></div><div class="t m0 x15 h11 y94d ffa fs5 fcd sc0 ls0 ws13b"># print(e.parse(<span class="ffb">&apos;</span><span class="ls5e ws209">2+(<span class="_ _15"></span>3+*4<span class="_ _15"></span>)<span class="_ _15"></span><span class="ffb ls0 ws13b">&apos;<span class="ffa">))</span></span></span></div><div class="t m0 x15 h11 y94e ffa fs5 fcd sc0 ls0 ws4"># Traceback (most recent call last):</div><div class="t m0 x15 h11 y94f ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</div><div class="t m0 x15 h11 y950 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;exprparse.py&quot;, line 40, in parse</div><div class="t m0 x15 h11 y951 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>return self.expr()</div><div class="t m0 x15 h11 y952 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;exprparse.py&quot;, line 67, in expr</div><div class="t m0 x15 h11 y953 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>right = self.term()</div><div class="t m0 x15 h11 y954 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;exprparse.py&quot;, line 77, in term</div><div class="t m0 x15 h11 y955 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>termval = self.factor()</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.19.<span class="_ _5"> </span>2.19 <span class="ff1 ws42c">实现一个简单的递归下降分析器 </span>73</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
