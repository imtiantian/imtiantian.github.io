<div id="pf4f" class="pf w0 h0" data-page-no="4f"><div class="pc pc4f w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg4f.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff8 fs5 fc0 sc0 ls0 ws15f">PRINT <span class="fc6 ls33">=<span class="fc9 ls34">r<span class="ff9 ls0 ws13b">&apos;<span class="ff8 ws13a">(?P&lt;PRINT&gt;print)</span>&apos;</span></span></span></div><div class="t m0 x5 hf y1ac ff8 fs5 fc0 sc0 ls0 ws13c">NAME <span class="fc6 ls32">=<span class="fc9 ls34">r<span class="ff9">&apos;</span><span class="ls0 ws13a">(?P&lt;NAME&gt;[a-zA-Z_][a-zA-Z_0-9]*)<span class="ff9">&apos;</span></span></span></span></div><div class="t m0 x5 hf y1ae ff8 fs5 fc0 sc0 ls0 ws2a3">master_pat <span class="fc6 ls32">=</span><span class="ws13a">re<span class="fc6 ls34">.</span>compile(<span class="ff9 fc9 ls34">&apos;<span class="ffd ls0 ws13b">|</span>&apos;<span class="ff8 fc6">.</span></span><span class="ws13b">join([PRINT, NAME]))</span></span></div><div class="t m0 x5 hf y1b0 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws158">tok </span><span class="ws157">in <span class="ff8 fc0 ws41e">generate_tokens(master_pat, <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">printer<span class="ff9 ls34">&apos;</span></span>):</span></span></div><div class="t m0 x15 hf y355 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(tok)</span></div><div class="t m0 x5 h11 y411 ffa fs5 fcd sc0 ls0 ws4"># Outputs :</div><div class="t m0 x5 h11 yba ffa fs5 fcd sc0 ls0 ws4"># Token(type=<span class="ffb ls34">&apos;</span><span class="ws13a">PRINT<span class="ffb ls34">&apos;</span><span class="ws13b">, value=<span class="ffb ls34">&apos;</span></span>print<span class="ffb ws13b">&apos;</span>)</span></div><div class="t m0 x5 h11 y8c6 ffa fs5 fcd sc0 ls0 ws4"># Token(type=<span class="ffb ls34">&apos;</span><span class="ws13a">NAME<span class="ffb ls34">&apos;</span><span class="ws13b">, value=<span class="ffb">&apos;</span></span>er<span class="ffb ls34">&apos;</span>)</span></div><div class="t m0 x0 h7 y8c7 ff1 fs3 fc0 sc0 lsb5 ws423">关于更高阶的令牌化技术<span class="_ _d"></span>，你可能需要查看 <span class="ff4 fc3 ls0 ws424">PyParsing </span><span class="ls0 ws425">或<span class="_ _6"></span>者 <span class="ff4 fc3 ws426">PL<span class="_ _d"></span>Y <span class="ff1 fc0 wsa0">包。<span class="_ _0"></span>一<span class="_ _6"></span>个<span class="_ _0"></span>调<span class="_ _0"></span>用</span></span></span></div><div class="t m0 x5 h7 y8c8 ff4 fs3 fc0 sc0 ls0 ws427">PL<span class="_ _8"></span>Y <span class="ff1">的例子在下一节会有演示。</span></div><div class="t m0 x5 hd y8c9 ff2 fs4 fc4 sc0 ls0 ws211">4.19<span class="_ _e"> </span>2.19 <span class="ff1">实现一个简单的递归下降分析器</span></div><div class="t m0 x5 he y245 ff2 fs2 fc4 sc0 ls0 ws212">4.19.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y8ca ff1 fs3 fc0 sc0 ls63 ws21f">你想根据一组语法规则解析文本并执行命令<span class="_ _c"></span>，或者构造一个代表输入的抽象语法<span class="_ _1"></span></div><div class="t m0 x5 h9 y8cb ff1 fs3 fc0 sc0 ls0">树。如果语法非常简单，你可以自己写这个解析器，而不是使用一些框架。</div><div class="t m0 x5 he y8cc ff2 fs2 fc4 sc0 ls0 ws212">4.19.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y8cd ff1 fs3 fc0 sc0 ls0 wsa0">在这个问题中，我们集<span class="_ _6"></span>中讨论根据特殊语法去解<span class="_ _6"></span>析文本的问题。为了这样<span class="_ _6"></span>做，你首</div><div class="t m0 x5 h7 y8ce ff1 fs3 fc0 sc0 ls0 ws428">先要<span class="_ _6"></span>以 <span class="ff4 ws429">BNF </span><span class="wse6">或<span class="_ _6"></span>者 <span class="ff4 ws42a">EBNF </span><span class="wsa0">形<span class="_ _6"></span>式指<span class="_ _6"></span>定<span class="_ _6"></span>一<span class="_ _6"></span>个标<span class="_ _6"></span>准<span class="_ _6"></span>语法。<span class="_ _6"></span>比<span class="_ _6"></span>如，<span class="_ _6"></span>一个<span class="_ _6"></span>简<span class="_ _6"></span>单<span class="_ _6"></span>数学<span class="_ _6"></span>表<span class="_ _6"></span>达式<span class="_ _6"></span>语<span class="_ _6"></span>法<span class="_ _6"></span>可</span></span></div><div class="t m0 x5 h9 y8cf ff1 fs3 fc0 sc0 ls0">能像下面这样：</div><div class="t m0 x5 hf y8d0 ff8 fs5 fc0 sc0 ls0 ws4">expr ::<span class="fc6 ls33">=</span><span class="ws161">expr <span class="fc6 ls33">+</span>term</span></div><div class="t m0 x15 hf y8d1 ffd fs5 fc6 sc0 lsb6">|<span class="ff8 fc0 ls0 ws13c">expr <span class="fc6 ls32">-</span>term</span></div><div class="t m0 x15 hf y8d2 ffd fs5 fc6 sc0 lsb6">|<span class="ff8 fc0 ls0">term</span></div><div class="t m0 x5 hf y8d3 ff8 fs5 fc0 sc0 ls0 ws4">term ::<span class="fc6 ls33">=</span><span class="ws161">term <span class="fc6 ls33">*</span>factor</span></div><div class="t m0 x15 hf y8d4 ffd fs5 fc6 sc0 lsb6">|<span class="ff8 fc0 ls0 ws13c">term <span class="fc6 ls32">/</span>factor</span></div><div class="t m0 x15 hf y8d5 ffd fs5 fc6 sc0 lsb6">|<span class="ff8 fc0 ls0">factor</span></div><div class="t m0 x5 hf y8d6 ff8 fs5 fc0 sc0 ls0 ws4">factor ::<span class="fc6 ls32">=</span>( expr )</div><div class="t m0 x15 hf y8d7 ffd fs5 fc6 sc0 lsb6">|<span class="ff8 fc0 ls0">NUM</span></div><div class="t m0 x0 h7 y8d8 ff1 fs3 fc0 sc0 ls0 wsc">或者，以 <span class="ff4 ws42b">EBNF </span>形式：</div><div class="t m0 x5 hf y8d9 ff8 fs5 fc0 sc0 ls0 ws4">expr ::<span class="fc6 ls33">=</span><span class="ws13b">term { (<span class="fc6 ls34">+<span class="ffd ls0">|</span>-</span>) term }<span class="fc6">*</span></span></div><div class="t m0 x5 hf y8da ff8 fs5 fc0 sc0 ls0 ws4">term ::<span class="fc6 ls33">=</span><span class="ws13b">factor { (<span class="fc6 ls34">*<span class="ffd ls0">|<span class="ff8 ws13a">/</span></span></span></span>) factor }<span class="fc6">*</span></div><div class="t m0 x5 hf y8db ff8 fs5 fc0 sc0 ls0 ws4">factor ::<span class="fc6 ls32">=</span>( expr )</div><div class="t m0 x15 hf y8dc ffd fs5 fc6 sc0 lsb6">|<span class="ff8 fc0 ls0">NUM</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.19.<span class="_ _5"> </span>2.19 <span class="ff1 ws42c">实现一个简单的递归下降分析器 </span>70</div><a class="l" href="http://pyparsing.wikispaces.com/"><div class="d m1" style="border-style:none;position:absolute;left:501.487500px;bottom:879.856500px;width:52.423000px;height:16.821000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.dabeaz.com/ply/index.html"><div class="d m1" style="border-style:none;position:absolute;left:631.657500px;bottom:879.856500px;width:23.074000px;height:16.821000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
