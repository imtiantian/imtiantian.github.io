<div id="pff1" class="pf w0 h0" data-page-no="f1"><div class="pc pcf1 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgf1.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">p<span class="fc6 ls33">=</span><span class="ls0 ws13a">Pair(<span class="fc7 ls34">3</span><span class="ls33">,</span><span class="fc7">4</span>)</span></span></div><div class="t m0 x5 hf y1ac ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">p</span></div><div class="t m0 x5 hf y1ad ff8 fs5 fc8 sc0 ls0 ws4">Pair(3, 4) # __repr__() output</div><div class="t m0 x5 hf y1ae ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(p)</span></span></div><div class="t m0 x5 hf y1af ff8 fs5 fc8 sc0 ls0 ws4">(3, 4) # __str__() output</div><div class="t m0 x5 hf y1b0 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1b1 ff1 fs3 fc0 sc0 ls22 ws119">我们在这里还演示了在格式化的时候怎样使用不同的字符串表现形式。特别来讲<span class="_ _1"></span>，</div><div class="t m0 x5 h9 y1b2 ff6 fs3 fc0 sc0 ls0 ws9ce">!r <span class="ff1 ls6b ws9cf">格式化代码指明输出使用 </span><span class="ws921">repr<span class="_ _e"> </span>() <span class="ff1 ls6b ws9d0">来代替默认的 </span>str<span class="_ _e"> </span>() <span class="ff1 ls6b ws28f">。你可以用前面的类</span></span></div><div class="t m0 x5 h9 y1cc ff1 fs3 fc0 sc0 ls0">来试着测试下：</div><div class="t m0 x5 hf ya8a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">p<span class="fc6 ls33">=</span><span class="ls0 ws13a">Pair(<span class="fc7 ls34">3</span><span class="ls33">,</span><span class="fc7">4</span>)</span></span></div><div class="t m0 x5 hf y1a18 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">p is {0!r}<span class="ff9 ls34">&apos;<span class="ff8 fc6">.</span></span></span>format(p))</span></span></div><div class="t m0 x5 hf y1a19 ff8 fs5 fc8 sc0 ls0 ws4">p is Pair(3, 4)</div><div class="t m0 x5 hf y18a1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">p is {0}<span class="ff9 ls34">&apos;</span></span><span class="fc6">.</span>format(p))</span></span></div><div class="t m0 x5 hf y1a1a ff8 fs5 fc8 sc0 ls0 ws4">p is (3, 4)</div><div class="t m0 x5 hf y171e ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y1a1b ff2 fs2 fc4 sc0 ls0 ws212">10.1.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y1a1c ff1 fs3 fc0 sc0 ls0 ws9d1">自定义 <span class="ff6 ws9d2">repr<span class="_ _e"> </span>() </span><span class="ls15d">和</span><span class="ff6 ws9d2">str<span class="_ _e"> </span>() </span><span class="wsa0">通常是很好的习惯，<span class="_ _c"></span>因为它能简化调试和实例输出。</span></div><div class="t m0 x5 h9 y1a1d ff1 fs3 fc0 sc0 ls13 wse5">例如<span class="_ _1"></span>，如果仅仅只是打印输出或日志输出某个实例，那么程序员会看到实例更加详细<span class="_ _c"></span></div><div class="t m0 x5 h9 y1a1e ff1 fs3 fc0 sc0 ls0">与有用的信息。</div><div class="t m0 x31 h9 y1a1f ff6 fs3 fc0 sc0 ls0 ws9d3">repr<span class="_ _e"> </span>() <span class="ff1 lse ws9d4">生成的文本字符串标准做法是需要让 </span><span class="ws9d5">eval(repr(x)) == x<span class="_ _16"> </span><span class="ff1 wsa0">为真。<span class="_ _6"></span>如果</span></span></div><div class="t m0 x5 h9 y1a20 ff1 fs3 fc0 sc0 ls0 ws14">实在不能这样子做，应该创建一个有用的文本表示，并使用 <span class="ff12 lse0">&lt;</span><span class="ls5">和<span class="ff12 lse0">&gt;</span></span>括起来。比如：</div><div class="t m0 x5 hf y1a21 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">file.dat<span class="ff9 ls34">&apos;</span></span>)</span></span></span></span></div><div class="t m0 x5 hf y1a22 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">f</span></div><div class="t m0 x5 hf y1a23 ff8 fs5 fc8 sc0 ls0 ws4">&lt;_io.TextIOWrapper name=<span class="ff9 ls34">&apos;</span><span class="ws13a">file.dat<span class="ff9 ls32">&apos;</span>mode=<span class="ff9 ls34">&apos;<span class="ff8">r</span><span class="ls32">&apos;</span></span>encoding=<span class="ff9 ws13b">&apos;</span>UTF-8<span class="ff9 ls34">&apos;</span>&gt;</span></div><div class="t m0 x5 hf y1a24 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1a25 ff1 fs3 fc0 sc0 ls0 ws9d6">如果 <span class="ff6 ws308">str<span class="_ _e"> </span>() </span><span class="ws592">没有被定义，那么就会使用 <span class="ff6 ws308">repr<span class="_ _e"> </span>() </span>来代替输出。</span></div><div class="t m0 x0 h7 y1a26 ff1 fs3 fc0 sc0 ls0 ws9d7">上面的 <span class="ff6 ws9d8">format() </span><span class="ws9d9">方法的使用看上去很有趣，格式化代码 <span class="ffd ls84">{</span><span class="ff6 ws303">0.x<span class="ffd ls15e">}</span></span></span>对应的是第 <span class="ff4 ls15f">1</span>个参</div><div class="t m0 x5 h7 y668 ff1 fs3 fc0 sc0 ls0 ws14">数的 <span class="ff4 ls155">x</span><span class="wsa0">属性。因此，在下面的函数中，<span class="ff4 lsc">0</span><span class="ws63">实际上指的就是 <span class="ff6 ws17a">self </span>本身：</span></span></div><div class="t m0 x5 hf y1a27 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__repr__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x15 hf y1a28 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13b">Pair({0.x!r}, {0.y!r})<span class="ff9">&apos;</span><span class="fc6 ls34">.</span><span class="fc0 ws13a">format(<span class="fca">self</span>)</span></span></span></div><div class="t m0 x0 h9 y1a29 ff1 fs3 fc0 sc0 ls0 ws14">作为这种实现的一个替代，你也可以使用 <span class="ff6 ls86">%</span>操作符，就像下面这样：</div><div class="t m0 x5 hf y1a2a ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__repr__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x15 hf y1a2b ff7 fs5 fca sc0 ls0 ws146">return <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">Pair(<span class="ffa fcf">%r</span><span class="ls32">,</span><span class="ffa fcf">%r</span>)</span><span class="ls33">&apos;<span class="ff8 fc6 ls32">%<span class="fc0 ls34">(</span></span></span></span><span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0 ws159">x, </span>self<span class="fc6 ls34">.</span><span class="fc0">y)</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws9da">10.1.<span class="_ _5"> </span>8.1 <span class="ff1 ws9db">改变对象的字符串显示 </span>232</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
