<div id="pf28" class="pf w0 h0" data-page-no="28"><div class="pc pc28 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg28.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff8 fs5 fc0 sc0 ls0 ws145">values <span class="fc6 ls33">=</span><span class="ws13a">[<span class="ff9 fc9 ls34">&apos;<span class="ff8">1</span><span class="ls0 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">2<span class="ff9 ls34">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">-3<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">-<span class="ff9 ls34">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">4<span class="ff9">&apos;</span></span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">N/A<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;<span class="ff8">5</span><span class="ls0 ws13b">&apos;</span></span></span>]</span></div><div class="t m0 x5 hf y1ac ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">is_int<span class="fc0">(val):</span></span></div><div class="t m0 x15 hf y1ad ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x16 hf y1ae ff8 fs5 fc0 sc0 ls32">x<span class="fc6 ls33">=<span class="fca ls0 ws13a">int<span class="fc0">(val)</span></span></span></div><div class="t m0 x16 hf y1af ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8">True</span></div><div class="t m0 x15 hf y1b0 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 ws13a">ValueError<span class="fc0">:</span></span></div><div class="t m0 x16 hf y355 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8">False</span></div><div class="t m0 x5 hf y410 ff8 fs5 fc0 sc0 ls0 ws15f">ivals <span class="fc6 ls33">=</span><span class="fca ws13a">list<span class="fc0">(</span>filter</span><span class="ws13b">(is_int, values))</span></div><div class="t m0 x5 hf y411 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(ivals)</span></div><div class="t m0 x5 h11 yba ffa fs5 fcd sc0 ls0 ws4"># Outputs [<span class="ffb ls34">&apos;</span><span class="ws13a">1<span class="ffb ls34">&apos;</span><span class="ls33">,</span><span class="ffb ws13b">&apos;</span><span class="ls34">2<span class="ffb">&apos;</span><span class="ls32">,</span><span class="ffb">&apos;</span></span>-3<span class="ffb ls34">&apos;</span><span class="ls33">,</span><span class="ffb ws13b">&apos;</span><span class="ls34">4<span class="ffb">&apos;</span><span class="ls32">,</span><span class="ffb">&apos;</span>5</span><span class="ffb ws13b">&apos;</span>]</span></div><div class="t m0 x0 h9 y412 ff6 fs3 fc0 sc0 ls0 ws293">filter() <span class="ff1 ls2d ws132">函数创建了一个迭代器，因此如果你想得到一个列表的话<span class="_ _c"></span>，就得像示例</span></div><div class="t m0 x5 h9 y413 ff1 fs3 fc0 sc0 ls0 ws14">那样使用 <span class="ff6 ws25d">list() </span>去转换。</div><div class="t m0 x5 he y414 ff2 fs2 fc4 sc0 ls0 ws212">3.16.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y415 ff1 fs3 fc0 sc0 ls3a ws153">列表推导和生成器表达式通常情况下是过滤数据最简单的方式。其实它们还能在过</div><div class="t m0 x5 h9 y416 ff1 fs3 fc0 sc0 ls0">滤的时候转换数据。比如：</div><div class="t m0 x5 hf y417 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">mylist <span class="fc6 ls32">=</span><span class="ls34">[<span class="fc7">1</span><span class="ls32">,</span><span class="fc7">4</span><span class="ls33">,</span></span><span class="fc6 ws13a">-<span class="fc7 ls34">5</span></span><span class="ls32">,</span><span class="fc7 ws13a">10</span><span class="ls32">,<span class="fc6 ls34">-<span class="fc7">7</span></span>,<span class="fc7 ls34">2</span>,<span class="fc7 ls34">3</span><span class="ls33">,</span></span><span class="fc6 ws13a">-<span class="fc7 ls34">1</span></span>]</span></div><div class="t m0 x5 h10 y418 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">math</span></span></div><div class="t m0 x5 hf y419 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">[math<span class="fc6">.</span><span class="ws155">sqrt(n) </span></span><span class="fca">for <span class="ff8 fc0 ls32">n</span><span class="ws160">in <span class="ff8 fc0 ws145">mylist </span><span class="ws157">if <span class="ff8 fc0 ls32">n<span class="fc6 ls33">&gt;<span class="fc7 ls34">0</span></span><span class="ls0">]</span></span></span></span></span></div><div class="t m0 x5 hf y41a ff8 fs5 fc8 sc0 ls0 ws4">[1.0, 2.0, 3.1622776601683795, 1.4142135623730951, 1.7320508075688772]</div><div class="t m0 x5 hf y41b ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y41c ff1 fs3 fc0 sc0 ls56 ws1fa">过滤操作的一个变种就是将不符合条件的值用新的值代替<span class="_ _c"></span>，而不是丢弃它们<span class="_ _1"></span>。比<span class="_ _1"></span></div><div class="t m0 x5 h9 y41d ff1 fs3 fc0 sc0 ls18 ws110">如，在一列数据中你可能不仅想找到正数<span class="_ _1"></span>，而且还想将不是正数的数替换成指定的数。</div><div class="t m0 x5 h9 y41e ff1 fs3 fc0 sc0 ls0">通过将过滤条件放到条件表达式中去，可以很容易的解决这个问题，就像这样：</div><div class="t m0 x5 hf y41f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws1f5">clip_neg <span class="fc6 ls33">=</span><span class="ws159">[n </span></span><span class="fca ws157">if <span class="ff8 fc0 ls33">n<span class="fc6 ls32">&gt;</span><span class="fc7">0</span></span><span class="ws218">else <span class="ff8 fc7 ls33">0</span><span class="ws139">for <span class="ff8 fc0 ls32">n</span></span></span>in <span class="ff8 fc0">mylist]</span></span></div><div class="t m0 x5 hf y420 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">clip_neg</span></div><div class="t m0 x5 hf y421 ff8 fs5 fc8 sc0 ls0 ws4">[1, 4, 0, 10, 0, 2, 3, 0]</div><div class="t m0 x5 hf y422 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws1f5">clip_pos <span class="fc6 ls33">=</span><span class="ws159">[n </span></span><span class="fca ws157">if <span class="ff8 fc0 ls33">n<span class="fc6 ls32">&lt;</span><span class="fc7">0</span></span><span class="ws218">else <span class="ff8 fc7 ls33">0</span><span class="ws139">for <span class="ff8 fc0 ls32">n</span></span></span>in <span class="ff8 fc0">mylist]</span></span></div><div class="t m0 x5 hf y423 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">clip_pos</span></div><div class="t m0 x5 hf y424 ff8 fs5 fc8 sc0 ls0 ws4">[0, 0, -5, 0, -7, 0, 0, -1]</div><div class="t m0 x5 hf y425 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y426 ff1 fs3 fc0 sc0 ls0 ws294">另<span class="_ _6"></span>外<span class="_ _6"></span>一<span class="_ _6"></span>个<span class="_ _6"></span>值<span class="_ _6"></span>得<span class="_ _6"></span>关<span class="_ _6"></span>注<span class="_ _6"></span>的<span class="_ _0"></span>过滤<span class="_ _6"></span>工<span class="_ _6"></span>具<span class="_ _0"></span>就是 <span class="ff6 ws295">itertools.compress() </span><span class="ws296">，<span class="_ _6"></span>它<span class="_ _6"></span>以<span class="_ _0"></span>一个 <span class="ff6">iterable</span></span></div><div class="t m0 x5 h9 y427 ff1 fs3 fc0 sc0 ls1e ws297">对象和一个相对应的 <span class="ff6 ls0 ws298">Boolean </span><span class="ws299">选择器序列作为输入参数。然后输出 <span class="ff6 ls0 ws29a">iterable </span><span class="ws111">对象中<span class="_ _c"></span></span></span></div><div class="t m0 x5 h9 y428 ff1 fs3 fc0 sc0 ls6c ws29b">对应选择器为 <span class="ff6 ls0 ws29c">True </span><span class="ws29d">的元素<span class="_ _c"></span>。<span class="_ _6"></span>当你需要用另外一个相关联的序列来过滤某个序列的时<span class="_ _c"></span></span></div><div class="t m0 x5 h9 y429 ff1 fs3 fc0 sc0 ls0">候，这个函数是非常有用的。比如，假如现在你有下面两列数据：</div><div class="t m0 x5 hf y42a ff8 fs5 fc0 sc0 ls0 ws16e">addresses <span class="fc6 ls33">=</span>[</div><div class="t m0 x15 hf y42b ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">5412 N CLARK</span>&apos;<span class="ff8 fc0 ls0">,</span></div><div class="t m0 x15 hf y42c ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">5148 N CLARK</span>&apos;<span class="ff8 fc0 ls0">,</span></div><div class="t m0 x15 hf y42d ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">5800 E 58TH<span class="ff9">&apos;</span><span class="fc0">,</span></span></div><div class="t m0 x15 hf y42e ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">2122 N CLARK<span class="ff9">&apos;</span></span></div><div class="t m0 x15 hf y42f ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">5645 N RAVENSWOOD</span>&apos;<span class="ff8 fc0 ls0">,</span></div><div class="t m0 x15 hf y430 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">1060 W ADDISON</span>&apos;<span class="ff8 fc0 ls0">,</span></div><div class="t m0 x15 hf y431 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">4801 N BROADWAY<span class="ff9">&apos;</span><span class="fc0">,</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">3.16.<span class="_ _5"> </span>1.16 <span class="ff1 ws292">过滤序列元素 </span>31</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
