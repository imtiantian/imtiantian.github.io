<div id="pf11a" class="pf w0 h0" data-page-no="11a"><div class="pc pc11a w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg11a.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1e8 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ls34">B</span><span class="ff8 fc0">(A):</span></div><div class="t m0 x15 hf y1e9 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">spam<span class="fc0">(<span class="fca">self</span><span class="ws4">, x):</span></span></span></div><div class="t m0 x16 hf y1ea ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">B.spam</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x16 hf y903 ff8 fs5 fca sc0 ls0 ws13a">super<span class="fc0">()<span class="fc6 ls34">.</span>spam(x)</span></div><div class="t m0 x15 hf y1eb ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">bar<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y1ec ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">B.bar<span class="ff9 ws13b">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x0 h9 y1e17 ff1 fs3 fc0 sc0 ls0">使用代理的话，就是下面这样：</div><div class="t m0 x5 hf y1e18 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ls34">A</span><span class="ff8 fc0">:</span></div><div class="t m0 x15 hf y1e19 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">spam<span class="fc0">(<span class="fca">self</span><span class="ws4">, x):</span></span></span></div><div class="t m0 x16 hf y1e1a ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">A.spam</span>&apos;</span><span class="ls0 ws13b">, x)</span></span></div><div class="t m0 x15 hf y1e1b ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">foo<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y1e1c ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">A.foo<span class="ff9 ws13b">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x5 hf y1e1d ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ls34">B</span><span class="ff8 fc0">:</span></div><div class="t m0 x15 hf y1e1e ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y1e1f ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws15c">_a </span><span class="ls32">=</span><span class="fc0">A()</span></span></div><div class="t m0 x15 hf y1e20 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">spam<span class="fc0">(<span class="fca">self</span><span class="ws4">, x):</span></span></span></div><div class="t m0 x16 hf y1e21 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">B.spam</span>&apos;</span><span class="ls0 ws13b">, x)</span></span></div><div class="t m0 x16 hf y1e22 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">_a</span><span class="ls34">.</span><span class="fc0">spam(x)</span></span></div><div class="t m0 x15 hf y1e23 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">bar<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y1e24 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">B.bar<span class="ff9 ws13b">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x15 hf y1e25 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__getattr__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws4">, name):</span></span></span></div><div class="t m0 x16 hf y1e26 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">getattr<span class="fc0 ls34">(</span>self<span class="fc6">.<span class="fc0 ws4">_a, name)</span></span></span></div><div class="t m0 x0 h9 y1e27 ff1 fs3 fc0 sc0 ls0 wsb20">当<span class="_ _6"></span>实<span class="_ _6"></span>现<span class="_ _6"></span>代理<span class="_ _6"></span>模<span class="_ _6"></span>式<span class="_ _6"></span>时，<span class="_ _6"></span>还<span class="_ _6"></span>有<span class="_ _6"></span>些<span class="_ _6"></span>细<span class="_ _6"></span>节<span class="_ _6"></span>需<span class="_ _6"></span>要<span class="_ _6"></span>注<span class="_ _6"></span>意。<span class="_ _6"></span>首<span class="_ _6"></span>先， <span class="ff6 wsb21">getattr<span class="_ _e"> </span>() </span><span class="ls48 ws242">实际是一个后备<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y1e28 ff1 fs3 fc0 sc0 ls0 wsa0">方<span class="_ _6"></span>法，<span class="_ _0"></span>只<span class="_ _6"></span>有<span class="_ _6"></span>在<span class="_ _0"></span>属<span class="_ _6"></span>性<span class="_ _6"></span>不<span class="_ _0"></span>存<span class="_ _6"></span>在<span class="_ _6"></span>时<span class="_ _0"></span>才<span class="_ _6"></span>会<span class="_ _6"></span>调<span class="_ _0"></span>用。<span class="_ _6"></span>因<span class="_ _6"></span>此，<span class="_ _0"></span>如<span class="_ _6"></span>果<span class="_ _6"></span>代<span class="_ _0"></span>理<span class="_ _6"></span>类<span class="_ _0"></span>实<span class="_ _6"></span>例<span class="_ _6"></span>本<span class="_ _0"></span>身<span class="_ _6"></span>有<span class="_ _6"></span>这<span class="_ _0"></span>个<span class="_ _6"></span>属<span class="_ _6"></span>性<span class="_ _0"></span>的<span class="_ _6"></span>话，</div><div class="t m0 x5 h9 y1e29 ff1 fs3 fc0 sc0 ls48 wsb22">那么不会触发这个方法的<span class="_ _1"></span>。另外<span class="_ _1"></span>， <span class="ff6 ls0 wsa78">setattr<span class="_ _e"> </span>() </span><span class="ls183">和<span class="ff6 ls0 wsa78">delattr<span class="_ _e"> </span>() <span class="ff1 wsa0">需<span class="_ _6"></span>要<span class="_ _6"></span>额<span class="_ _6"></span>外<span class="_ _6"></span>的魔<span class="_ _6"></span>法<span class="_ _6"></span>来</span></span></span></div><div class="t m0 x5 h9 y1e2a ff1 fs3 fc0 sc0 ls17 wsb23">区分代理实例和被代理实例 <span class="ff6 ls0 wsb24">obj </span><span class="wsf6">的属性。一个通常的约定是只代理那些不以下划线<span class="_ _1"></span></span></div><div class="t m0 x5 h7 y1e2b ff1 fs3 fc0 sc0 ls0 ws38">开头的属性 <span class="ff4 ls1b">(</span><span class="wsa0">代理类只暴露被代理类的公共属性<span class="ff4 wsa5">)</span>。</span></div><div class="t m0 x0 h7 y1e2c ff1 fs3 fc0 sc0 ls30 wsb25">还有一点需要注意的是<span class="_ _1"></span>， <span class="ff6 ls0 ws9e2">getattr<span class="_ _e"> </span>() </span><span class="wsb26">对于大部分以双下划线 <span class="ff4 ls0 wsb27">(<span class="_ _e"> </span>) </span><span class="ws138">开始和结尾的</span></span></div><div class="t m0 x5 h9 y1e2d ff1 fs3 fc0 sc0 ls0">属性并不适用。比如，考虑如下的类：</div><div class="t m0 x5 hf y60e ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">ListLike<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 h12 yc58 ffa fs5 fc9 sc0 ls0 ws169">&quot;&quot;&quot;__getattr__ <span class="ffc fs6 ws3d4">对于双下划线开始和结尾的方法是不能用的，需要一个个去重定义</span>&quot;&quot;&quot;</div><div class="t m0 x15 hf yc5a ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf yc5b ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws19f">_items </span><span class="ls32">=</span><span class="fc0">[]</span></span></div><div class="t m0 x15 hf y1e2e ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__getattr__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws4">, name):</span></span></span></div><div class="t m0 x16 hf y1d37 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">getattr<span class="fc0 ls34">(</span>self<span class="fc6">.<span class="fc0 ws4">_items, name)</span></span></span></div><div class="t m0 x0 h7 y1e2f ff1 fs3 fc0 sc0 ls0 wsb28">如<span class="_ _0"></span>果<span class="_ _6"></span>是<span class="_ _0"></span>创<span class="_ _0"></span>建<span class="_ _6"></span>一<span class="_ _0"></span>个 <span class="ff4 wsb29">ListLik<span class="_ _1"></span>e <span class="ff1 lsb5 wsb2a">对象<span class="_ _c"></span>，会发现它支持普通的列表方法<span class="_ _c"></span>，如 <span class="ff4 ls0 wsb2b">app<span class="_ _6"></span>end() <span class="ff1">和</span></span></span></span></div><div class="t m0 x5 h7 y1e30 ff4 fs3 fc0 sc0 ls0 wsa5">insert()<span class="ff1 ws38">，但是却不支持 </span>len()<span class="ff1">、元素查找等。例如：</span></div><div class="t m0 x5 hf y1e31 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls0">ListLike()</span></span></div><div class="t m0 x5 hf y1e32 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">a<span class="fc6 ls0 ws13a">.<span class="fc0">append(</span></span><span class="fc7">2</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y1e33 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">a<span class="fc6 ls0 ws13a">.<span class="fc0">insert(</span></span><span class="fc7">0</span><span class="ls33">,<span class="fc7 ls0 ws13a">1<span class="fc0">)</span></span></span></span></div><div class="t m0 x5 hf y1e34 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">a<span class="fc6 ls0 ws13a">.<span class="fc0">sort()</span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">10.15.<span class="_ _5"> </span>8.15 <span class="ff1 wsb0f">属性的代理访问 </span>273</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
