<div id="pf5b" class="pf w0 h0" data-page-no="5b"><div class="pc pc5b w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg5b.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf ya0f ff8 fs5 fc8 sc0 ls0">1627700</div><div class="t m0 x5 hf ya10 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">round<span class="fc0 ws15b">(a, <span class="fc6 ls34">-<span class="fc7">3</span></span>)</span></span></div><div class="t m0 x5 hf ya11 ff8 fs5 fc8 sc0 ls0">1628000</div><div class="t m0 x5 hf ya12 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y217 ff2 fs2 fc4 sc0 ls0 ws135">5.1.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 ya13 ff1 fs3 fc0 sc0 ls22 ws119">不要将舍入和格式化输出搞混淆了。如果你的目的只是简单的输出一定宽度的数<span class="_ _1"></span>，</div><div class="t m0 x5 h9 ya14 ff1 fs3 fc0 sc0 ls0 ws14">你不需要使用 <span class="ff6 ws472">round() </span>函数。而仅仅只需要在格式化的时候指定精度即可。比如：</div><div class="t m0 x5 hf ya15 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">x<span class="fc6 ls33">=<span class="fc7 ls0">1.23456</span></span></span></div><div class="t m0 x5 hf ya16 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws16e">format(x, <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">0.2f<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf ya17 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">1.23<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf ya18 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws16e">format(x, <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">0.3f<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf ya19 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">1.235<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf ya1a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13b">value is {:0.3f}</span>&apos;<span class="ff8 fc6">.<span class="fc0 ls0">format(x)</span></span></span></div><div class="t m0 x5 hf ya1b ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">value is 1.235<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf ya1c ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 ya1d ff1 fs3 fc0 sc0 ls12 wse4">同样，不要试着去舍入浮点值来<span class="_ _c"></span><span class="ff4 lsca">”<span class="ff1 ls0 wsa0">修<span class="_ _6"></span>正</span><span class="lscb">”<span class="ff1 ls12">表面上看起来正确的问题。比如<span class="_ _1"></span>，你可能</span></span></span></div><div class="t m0 x5 h9 ya1e ff1 fs3 fc0 sc0 ls0">倾向于这样做：</div><div class="t m0 x5 hf ya1f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=<span class="fc7 ls0">2.1</span></span></span></div><div class="t m0 x5 hf ya20 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=<span class="fc7 ls0">4.2</span></span></span></div><div class="t m0 x5 hf ya21 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">c<span class="fc6 ls33">=</span>a<span class="fc6 ls33">+</span><span class="ls0">b</span></span></div><div class="t m0 x5 hf ya22 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">c</span></div><div class="t m0 x5 hf ya23 ff8 fs5 fc8 sc0 ls0">6.300000000000001</div><div class="t m0 x5 hf ya24 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">c<span class="fc6 ls33">=<span class="fca ls0 ws13a">round<span class="fc0 ws158">(c, <span class="fc7 ls34">2</span><span class="ls33">)</span><span class="ffa fcd ws4"># &quot;Fix&quot; result (???)</span></span></span></span></span></div><div class="t m0 x5 hf ya25 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">c</span></div><div class="t m0 x5 hf ya26 ff8 fs5 fc8 sc0 ls0">6.3</div><div class="t m0 x5 hf ya27 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 ya28 ff1 fs3 fc0 sc0 ls3a ws153">对于大多数使用到浮点的程序，没有必要也不推荐这样做。尽管在计算的时候会有</div><div class="t m0 x5 h9 ya29 ff1 fs3 fc0 sc0 ls13 wse5">一点点小的误差<span class="_ _1"></span>，但是这些小的误差是能被理解与容忍的。如果不能允许这样的小误<span class="_ _c"></span></div><div class="t m0 x5 h7 ya2a ff1 fs3 fc0 sc0 lscc">差<span class="ff4 ls1b">(</span><span class="ls0 wsa0">比如<span class="_ _6"></span>涉及<span class="_ _6"></span>到金<span class="_ _6"></span>融领域<span class="ff4 ls1b">)</span><span class="ws473">，<span class="_ _6"></span>那么<span class="_ _6"></span>就得<span class="_ _6"></span>考虑<span class="_ _6"></span>使用 <span class="ff6 ws474">decimal </span></span>模<span class="_ _6"></span>块了，<span class="_ _6"></span>下一节<span class="_ _6"></span>我们<span class="_ _6"></span>会详<span class="_ _6"></span>细讨</span></div><div class="t m0 x5 h9 ya2b ff1 fs3 fc0 sc0 ls0">论。</div><div class="t m0 x5 hd ya2c ff2 fs4 fc4 sc0 ls0 ws134">5.2<span class="_ _e"> </span>3.2 <span class="ff1">执行精确的浮点数运算</span></div><div class="t m0 x5 he ya2d ff2 fs2 fc4 sc0 ls0 ws135">5.2.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 ya2e ff1 fs3 fc0 sc0 ls0">你需要对浮点数执行精确的计算操作，并且不希望有任何小误差的出现。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">5.2.<span class="_ _5"> </span>3.2 <span class="ff1 ws1d2">执行精确的浮点数运算 </span>82</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
