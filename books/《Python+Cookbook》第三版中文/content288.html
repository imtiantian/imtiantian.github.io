<div id="pf120" class="pf w0 h0" data-page-no="120"><div class="pc pc120 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg120.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h7 y2a ff1 fs3 fc0 sc0 ls0 ws38">下面是一个多线程的 <span class="ff4 wsb43">XML-RPC </span>服务：</div><div class="t m0 x5 hf y18f8 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc wsb44">xmlrpc.server </span><span class="ws146">import <span class="ff8 fc0">SimpleXMLRPCServer</span></span></div><div class="t m0 x5 hf y1ea6 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws96c">socketserver </span><span class="ws146">import <span class="ff8 fc0">ThreadingMixIn</span></span></div><div class="t m0 x5 hf y18f9 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">ThreadedXMLRPCServer<span class="ff8 fc0 ws13b">(ThreadingMixIn, SimpleXMLRPCServer):</span></span></div><div class="t m0 x15 h10 y18fa ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x0 h9 y1ea7 ff1 fs3 fc0 sc0 ls3a ws153">同时在一些大型库和框架中也会发现混入类的使用，用途同样是增强已存在的类的</div><div class="t m0 x5 h9 y1ea8 ff1 fs3 fc0 sc0 ls0">功能和一些可选特征。</div><div class="t m0 x0 h9 y1ea9 ff1 fs3 fc0 sc0 ls35 ws144">对于混入类，有几点需要记住。首先是，混入类不能直接被实例化使用<span class="_ _1"></span>。其次，混</div><div class="t m0 x5 h9 y15f2 ff1 fs3 fc0 sc0 ls22 wsb45">入类没有自己的状态信息，也就是说它们并没有定义 <span class="ff6 ls0 ws8e8">init<span class="_ _e"> </span>() </span><span class="ws119">方法<span class="_ _c"></span>，并且没有实例</span></div><div class="t m0 x5 h9 y15f3 ff1 fs3 fc0 sc0 ls0 ws911">属性。这也是为什么我们在上面明确定义了 <span class="ff6 ws27b">slots<span class="_ _2f"> </span>=<span class="_ _11"> </span>() </span>。</div><div class="t m0 x0 h9 y1eaa ff1 fs3 fc0 sc0 ls0">还有一种实现混入类的方式就是使用类装饰器，如下所示：</div><div class="t m0 x5 hf y1eab ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">LoggedMapping<span class="fc0">(cls):</span></span></div><div class="t m0 x15 h12 y1317 ffa fs5 fc9 sc0 ls0 ws158">&quot;&quot;&quot; <span class="ffc fs6 ws3d4">第二种方式：使用类装饰器</span>&quot;&quot;&quot;</div><div class="t m0 x15 hf y1eac ff8 fs5 fc0 sc0 ls0 ws208">cls_getitem <span class="fc6 ls32">=</span><span class="ws13a">cls<span class="fc6 ls34">.</span>__getitem__</span></div><div class="t m0 x15 hf y1ead ff8 fs5 fc0 sc0 ls0 ws208">cls_setitem <span class="fc6 ls32">=</span><span class="ws13a">cls<span class="fc6 ls34">.</span>__setitem__</span></div><div class="t m0 x15 hf y33d ff8 fs5 fc0 sc0 ls0 ws208">cls_delitem <span class="fc6 ls32">=</span><span class="ws13a">cls<span class="fc6 ls34">.</span>__delitem__</span></div><div class="t m0 x15 hf y1eae ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__getitem__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws4">, key):</span></span></span></div><div class="t m0 x16 hf y1eaf ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws155">Getting </span><span class="ls32">&apos;</span></span><span class="fc6 ls33">+</span></span><span class="ff8 ws13a">str<span class="fc0">(key))</span></span></div><div class="t m0 x16 hf y1eb0 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">cls_getitem(<span class="fca">self</span><span class="ws13b">, key)</span></span></div><div class="t m0 x15 hf y1eb1 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__setitem__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws4">, key, value):</span></span></span></div><div class="t m0 x16 hf y1eb2 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws4">Setting {} = {!r}</span>&apos;</span><span class="fc6">.</span><span class="ls0 ws13b">format(key, value))</span></span></div><div class="t m0 x16 hf y1eb3 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">cls_setitem(<span class="fca">self</span><span class="ws13b">, key, value)</span></span></div><div class="t m0 x15 hf y1eb4 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__delitem__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws4">, key):</span></span></span></div><div class="t m0 x16 hf y1eb5 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws1f5">Deleting </span><span class="ls33">&apos;</span></span><span class="fc6 ls32">+</span></span><span class="ff8 ws13a">str<span class="fc0">(key))</span></span></div><div class="t m0 x16 hf y175 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">cls_delitem(<span class="fca">self</span><span class="ws13b">, key)</span></span></div><div class="t m0 x15 hf y1eb6 ff8 fs5 fc0 sc0 ls0 ws13a">cls<span class="fc6 ls34">.</span><span class="ws208">__getitem__ <span class="fc6 ls32">=</span>__getitem__</span></div><div class="t m0 x15 hf y1eb7 ff8 fs5 fc0 sc0 ls0 ws13a">cls<span class="fc6 ls34">.</span><span class="ws208">__setitem__ <span class="fc6 ls32">=</span>__setitem__</span></div><div class="t m0 x15 hf y1eb8 ff8 fs5 fc0 sc0 ls0 ws13a">cls<span class="fc6 ls34">.</span><span class="ws208">__delitem__ <span class="fc6 ls32">=</span>__delitem__</span></div><div class="t m0 x15 hf y1eb9 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">cls</span></div><div class="t m0 x5 h10 y1eba ff7 fs5 fc12 sc0 ls0">@LoggedMapping</div><div class="t m0 x5 hf y1ebb ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">LoggedDict<span class="ff8 fc0 ws13a">(<span class="fca">dict</span>):</span></span></div><div class="t m0 x15 h10 y1ebc ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x0 h7 y1ebd ff1 fs3 fc0 sc0 ls2d wsb46">这个效果跟之前的是一样的，而且不再需要使用多继承了<span class="_ _c"></span>。参考 <span class="ff4 ls0 wsb47">9.12 <span class="ff1 wsa0">小<span class="_ _6"></span>节<span class="_ _6"></span>获<span class="_ _6"></span>取更</span></span></div><div class="t m0 x5 h7 y1ebe ff1 fs3 fc0 sc0 ls0 ws38">多类装饰器的信息，参考 <span class="ff4 wsca">8.13 </span>小节查看更多混入类和类装饰器的例子。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">10.18.<span class="_ _5"> </span>8.18 <span class="ff1 ws16b">利用 </span><span class="wsb3c">Mixins <span class="ff1 wsb3d">扩展类功能 </span>279</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
