<div id="pf2b" class="pf w0 h0" data-page-no="2b"><div class="pc pc2b w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg2b.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">len<span class="fc0">(sub)</span></span></div><div class="t m0 x5 hf y1ac ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 hf y1ad ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13b">addr, joined <span class="fc6 ls33">=</span>sub</span></div><div class="t m0 x5 hf y1ae ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">addr</span></div><div class="t m0 x5 hf y1af ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">jonesy@example.com<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y1b0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">joined</span></div><div class="t m0 x5 hf y355 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">2012-10-19<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y410 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y46e ff1 fs3 fc0 sc0 ls3a ws153">命名元组的一个主要用途是将你的代码从下标操作中解脱出来。因此，如果你从数</div><div class="t m0 x5 h9 y46f ff1 fs3 fc0 sc0 ls13 wse5">据库调用中返回了一个很大的元组列表<span class="_ _1"></span>，通过下标去操作其中的元素，当你在表中添<span class="_ _c"></span></div><div class="t m0 x5 h9 y453 ff1 fs3 fc0 sc0 ls13 wse5">加了新的列的时候你的代码可能就会出错了<span class="_ _1"></span>。但是如果你使用了命名元组，那么就不<span class="_ _c"></span></div><div class="t m0 x5 h9 y470 ff1 fs3 fc0 sc0 ls0">会有这样的顾虑。</div><div class="t m0 x0 h9 y471 ff1 fs3 fc0 sc0 ls0">为了说明清楚，下面是使用普通元组的代码：</div><div class="t m0 x5 hf y472 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">compute_cost<span class="fc0">(records):</span></span></div><div class="t m0 x5 hf y473 ff8 fs5 fc0 sc0 ls0 ws15f">total <span class="fc6 ls33">=</span><span class="fc7">0.0</span></div><div class="t m0 x5 hf y474 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws158">rec </span><span class="ws157">in <span class="ff8 fc0">records:</span></span></div><div class="t m0 x15 hf y475 ff8 fs5 fc0 sc0 ls0 ws15f">total <span class="fc6 ws23d">+= </span><span class="ws13a">rec[<span class="fc7 ls34">1</span><span class="ls33">]<span class="fc6 ls32">*</span></span>rec[<span class="fc7 ls34">2</span>]</span></div><div class="t m0 x5 hf y476 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">total</span></div><div class="t m0 x0 h9 y477 ff1 fs3 fc0 sc0 ls3a ws153">下标操作通常会让代码表意不清晰，并且非常依赖记录的结构。下面是使用命名元</div><div class="t m0 x5 h9 y478 ff1 fs3 fc0 sc0 ls0">组的版本：</div><div class="t m0 x5 hf y479 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws168">collections </span><span class="ws146">import <span class="ff8 fc0">namedtuple</span></span></div><div class="t m0 x5 hf y47a ff8 fs5 fc0 sc0 ls0 ws15f">Stock <span class="fc6 ls33">=</span><span class="ws13a">namedtuple(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Stock<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, [<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">name<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">shares<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">price<span class="ff9 ws13b">&apos;</span></span>])</span></div><div class="t m0 x5 hf y47b ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">compute_cost<span class="fc0">(records):</span></span></div><div class="t m0 x15 hf y47c ff8 fs5 fc0 sc0 ls0 ws15f">total <span class="fc6 ls33">=</span><span class="fc7">0.0</span></div><div class="t m0 x15 hf y47d ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws158">rec </span><span class="ws157">in <span class="ff8 fc0">records:</span></span></div><div class="t m0 x16 hf y47e ff8 fs5 fc0 sc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0 ws13a">Stock(<span class="fc6 ls34">*</span>rec)</span></div><div class="t m0 x15 hf y47f ff8 fs5 fc0 sc0 ls0 ws15f">total <span class="fc6 ws23d">+= </span><span class="ls34">s<span class="fc6">.</span></span><span class="ws145">shares <span class="fc6 ls32">*</span><span class="ls34">s<span class="fc6">.</span></span>price</span></div><div class="t m0 x15 hf y480 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">total</span></div><div class="t m0 x5 he y481 ff2 fs2 fc4 sc0 ls0 ws212">3.18.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y482 ff1 fs3 fc0 sc0 ls3a ws153">命名元组另一个用途就是作为字典的替代，因为字典存储需要更多的内存空间。如</div><div class="t m0 x5 h9 y483 ff1 fs3 fc0 sc0 ls13 wse5">果你需要构建一个非常大的包含字典的数据结构<span class="_ _1"></span>，那么使用命名元组会更加高效。但<span class="_ _c"></span></div><div class="t m0 x5 h9 y484 ff1 fs3 fc0 sc0 ls0">是需要注意的是，不像字典那样，一个命名元组是不可更改的。比如：</div><div class="t m0 x5 hf y485 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; s = Stock(<span class="ff9 ls34">&apos;</span><span class="ws13a">ACME<span class="ff9 ls34">&apos;</span><span class="ws13b">, 100, 123.45)</span></span></div><div class="t m0 x5 hf y486 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; s</div><div class="t m0 x5 hf y487 ff8 fs5 fc0 sc0 ls0 ws13a">Stock(name=<span class="ff9 ls34">&apos;</span>ACME<span class="ff9 ws13b">&apos;</span><span class="ws4">, shares=100, price=123.45)</span></div><div class="t m0 x5 hf y488 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; s.shares = 75</div><div class="t m0 x5 hf y489 ff8 fs5 fc0 sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x5 hf y48a ff8 fs5 fc0 sc0 ls0 ws4">File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</div><div class="t m0 x5 hf y48b ff8 fs5 fc0 sc0 ls0 ws4">AttributeError: can<span class="ff9 ls34">&apos;</span><span class="ws13b">t set attribute</span></div><div class="t m0 x5 hf y48c ff8 fs5 fc0 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">3.18.<span class="_ _5"> </span>1.18 <span class="ff1 ws2ad">映射名称到序列元素 </span>34</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
