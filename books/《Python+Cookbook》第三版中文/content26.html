<div id="pf1a" class="pf w0 h0" data-page-no="1a"><div class="pc pc1a w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg1a.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff8 fs5 fc0 sc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0">{}</span></div><div class="t m0 x5 hf y1ac ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13b">key, value </span><span class="ws157">in <span class="ff8 fc0">pairs:</span></span></div><div class="t m0 x15 hf y1ad ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws158">key </span>not in <span class="ff8 fc0">d:</span></div><div class="t m0 x16 hf y1ae ff8 fs5 fc0 sc0 ls0 ws145">d[key] <span class="fc6 ls32">=</span>[]</div><div class="t m0 x15 hf y1af ff8 fs5 fc0 sc0 ls0 ws13a">d[key]<span class="fc6 ls34">.</span>append(value)</div><div class="t m0 x0 h9 y25b ff1 fs3 fc0 sc0 ls0 wsc">如果使用 <span class="ff6 ws133">defaultdict </span>的话代码就更加简洁了：</div><div class="t m0 x5 hf y25c ff8 fs5 fc0 sc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0 ws13a">defaultdict(<span class="fca">list</span>)</span></div><div class="t m0 x5 hf y25d ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13b">key, value </span><span class="ws157">in <span class="ff8 fc0">pairs:</span></span></div><div class="t m0 x15 hf y25e ff8 fs5 fc0 sc0 ls0 ws13a">d[key]<span class="fc6 ls34">.</span>append(value)</div><div class="t m0 x0 h7 y25f ff1 fs3 fc0 sc0 ls36 ws1df">这一小节所讨论的问题跟数据处理中的记录归类问题有大的关联<span class="_ _c"></span>。可以参考 <span class="ff4 ls0">1.15</span></div><div class="t m0 x5 h9 y260 ff1 fs3 fc0 sc0 ls0">小节的例子。</div><div class="t m0 x5 hd y261 ff2 fs4 fc4 sc0 ls0 ws134">3.7<span class="_ _e"> </span>1.7 <span class="ff1">字典排序</span></div><div class="t m0 x5 he y262 ff2 fs2 fc4 sc0 ls0 ws135">3.7.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y263 ff1 fs3 fc0 sc0 ls0">你想创建一个字典，并且在迭代或序列化这个字典的时候能够控制元素的顺序。</div><div class="t m0 x5 he y264 ff2 fs2 fc4 sc0 ls0 ws135">3.7.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y265 ff1 fs3 fc0 sc0 ls0 ws1e0">为 了 能 控 制 一 个 字 典 中 元 素 的 顺 序， 你 可 以 使 用<span class="_ _13"> </span><span class="ff6 ws1e1">collections </span>模 块 中 的</div><div class="t m0 x5 h9 y266 ff6 fs3 fc0 sc0 ls0 ws1e2">OrderedDict <span class="ff1">类。在迭代操作的时候它会保持元素被插入时的顺序，示例如下：</span></div><div class="t m0 x5 hf y267 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws168">collections </span><span class="ws146">import <span class="ff8 fc0">OrderedDict</span></span></div><div class="t m0 x5 hf y268 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">ordered_dict<span class="fc0">():</span></span></div><div class="t m0 x15 hf y269 ff8 fs5 fc0 sc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0">OrderedDict()</span></div><div class="t m0 x15 hf y26a ff8 fs5 fc0 sc0 ls0 ws13a">d[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">foo<span class="ff9 ls34">&apos;</span></span><span class="ls32">]<span class="fc6 ls33">=</span></span><span class="fc7">1</span></div><div class="t m0 x15 hf y26b ff8 fs5 fc0 sc0 ls0 ws13a">d[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">bar<span class="ff9 ls34">&apos;</span></span><span class="ls32">]<span class="fc6 ls33">=</span></span><span class="fc7">2</span></div><div class="t m0 x15 hf y26c ff8 fs5 fc0 sc0 ls0 ws13a">d[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">spam<span class="ff9 ls34">&apos;</span></span><span class="ls32">]<span class="fc6 ls33">=</span></span><span class="fc7">3</span></div><div class="t m0 x15 hf y26d ff8 fs5 fc0 sc0 ls0 ws13a">d[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">grok<span class="ff9 ls34">&apos;</span></span><span class="ls32">]<span class="fc6 ls33">=</span></span><span class="fc7">4</span></div><div class="t m0 x15 h11 y26e ffa fs5 fcd sc0 ls0 ws4"># Outputs &quot;foo 1&quot;, &quot;bar 2&quot;, &quot;spam 3&quot;, &quot;grok 4&quot;</div><div class="t m0 x15 hf y26f ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws158">key </span><span class="ws157">in <span class="ff8 fc0">d:</span></span></div><div class="t m0 x16 hf y270 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws4">(key, d[key])</span></div><div class="t m0 x0 h9 y271 ff1 fs3 fc0 sc0 ls35 ws1e3">当你想要构建一个将来需要序列化或编码成其他格式的映射的时候， <span class="ff6 ls0">OrderedDict</span></div><div class="t m0 x5 h7 y272 ff1 fs3 fc0 sc0 ls54 ws1e4">是非常有用的<span class="_ _8"></span>。比如<span class="_ _d"></span>，你想精确控制以 <span class="ff4 ls0 ws1e5">JSON </span><span class="ws1e6">编码后字段的顺序<span class="_ _8"></span>，你可以先使用<span class="_ _8"></span></span></div><div class="t m0 x5 h9 y273 ff6 fs3 fc0 sc0 ls0 ws1e2">OrderedDict <span class="ff1">来构建这样的数据：</span></div><div class="t m0 x5 h10 y274 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">json</span></span></div><div class="t m0 x5 hf y275 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">json<span class="fc6 ls34">.</span>dumps(d)</span></div><div class="t m0 x5 hf y276 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws4">{&quot;foo&quot;: 1, &quot;bar&quot;: 2, &quot;spam&quot;: 3, &quot;grok&quot;: 4}<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y277 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">3.7.<span class="_ _5"> </span>1.7 <span class="ff1 ws1e7">字典排序 </span>17</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
