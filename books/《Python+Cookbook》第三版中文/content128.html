<div id="pf80" class="pf w0 h0" data-page-no="80"><div class="pc pc80 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg80.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">somefile.txt<span class="ff9 ls34">&apos;</span></span>)</span></span></span></span></div><div class="t m0 x5 hf y1ac ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">lines <span class="fc6 ls33">=</span>linehistory(f)</span></div><div class="t m0 x5 hf y1ad ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">next<span class="fc0">(lines)</span></span></div><div class="t m0 x5 hf y1ae ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y1af ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x5 hf y1b0 ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ls32">:<span class="ff9 ls34">&apos;</span><span class="ls0">linehistory</span><span class="ff9">&apos;</span><span class="ls0 ws4">object is not an iterator</span></span></div><div class="t m0 x5 h11 y410 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Call iter() first, then start iterating</span></div><div class="t m0 x5 hf y411 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">it <span class="fc6 ls33">=</span><span class="fca ws13a">iter</span>(lines)</span></div><div class="t m0 x5 hf yba ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">next<span class="fc0">(it)</span></span></div><div class="t m0 x5 hf y8c6 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">hello world\n<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf ybed ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">next<span class="fc0">(it)</span></span></div><div class="t m0 x5 hf ybee ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws4">this is a test\n<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf ybef ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 hd ye20 ff2 fs4 fc4 sc0 ls0 ws134">6.7<span class="_ _e"> </span>4.7 <span class="ff1">迭代器切片</span></div><div class="t m0 x5 he ye21 ff2 fs2 fc4 sc0 ls0 ws135">6.7.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 ye22 ff1 fs3 fc0 sc0 ls0">你想得到一个由迭代器生成的切片对象，但是标准切片操作并不能做到。</div><div class="t m0 x5 he yc8f ff2 fs2 fc4 sc0 ls0 ws135">6.7.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 ye23 ff1 fs3 fc0 sc0 ls0 wsc">函数 <span class="ff6 ws59a">itertools.islice() </span>正好适用于在迭代器和生成器上做切片操作。比如：</div><div class="t m0 x5 hf ye24 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">def <span class="ff8 fcb ws13a">count<span class="fc0">(n):</span></span></span></div><div class="t m0 x5 hf ye25 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws16a">while <span class="ff8 ws13a">True<span class="fc0">:</span></span></span></div><div class="t m0 x5 hf ye26 ff7 fs5 fc5 sc0 ls0 ws1a3">... <span class="fca ws16a">yield <span class="ff8 fc0">n</span></span></div><div class="t m0 x5 hf ye27 ff7 fs5 fc5 sc0 ls0 ws1a3">... <span class="ff8 fc0 ls32">n<span class="fc6 ls0 ws23d">+= <span class="fc7">1</span></span></span></div><div class="t m0 x5 h10 ye28 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf ye29 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">c<span class="fc6 ls33">=</span><span class="ls0 ws13a">count(<span class="fc7 ls34">0</span>)</span></span></div><div class="t m0 x5 hf ye2a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">c[<span class="fc7">10</span><span class="ls34">:</span><span class="fc7">20</span>]</span></div><div class="t m0 x5 hf ye2b ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf ye2c ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x5 hf ye2d ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ls32">:<span class="ff9 ls34">&apos;</span><span class="ls0">generator<span class="ff9 ls33">&apos;</span><span class="ws4">object is not subscriptable</span></span></span></div><div class="t m0 x5 h11 ye2e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Now using islice()</span></div><div class="t m0 x5 h10 ye2f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">itertools</span></span></div><div class="t m0 x5 hf ye30 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">x</span><span class="ws157">in <span class="ff8 fc0 ws13a">itertools<span class="fc6 ls34">.</span><span class="ws16e">islice(c, </span><span class="fc7">10</span><span class="ls33">,</span><span class="fc7">20</span>):</span></span></span></div><div class="t m0 x5 hf ye31 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(x)</span></span></div><div class="t m0 x5 h10 ye32 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf ye33 ff8 fs5 fc8 sc0 ls0">10</div><div class="t m0 x5 hf ye34 ff8 fs5 fc8 sc0 ls0">11</div><div class="t m0 x5 hf ye35 ff8 fs5 fc8 sc0 ls0">12</div><div class="t m0 x5 hf ye36 ff8 fs5 fc8 sc0 ls0">13</div><div class="t m0 x5 hf ye37 ff8 fs5 fc8 sc0 ls0">14</div><div class="t m0 x5 hf y98d ff8 fs5 fc8 sc0 ls0">15</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">6.7.<span class="_ _5"> </span>4.7 <span class="ff1 ws59b">迭代器切片 </span>119</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
