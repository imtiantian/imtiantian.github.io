<div id="pf10a" class="pf w0 h0" data-page-no="10a"><div class="pc pc10a w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg10a.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 wsadf">10.11.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y236 ff1 fs3 fc0 sc0 ls0 ws9d6">可以在一个基类中写一个公用的 <span class="ff6 ws308">init<span class="_ _e"> </span>() </span>函数：</div><div class="t m0 x5 h10 y1cca ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">math</span></div><div class="t m0 x5 hf y1ccb ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Structure1<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 h11 y1ccc ffa fs5 fcd sc0 ls0 ws4"># Class variable that specifies expected fields</div><div class="t m0 x15 hf y1ccd ff8 fs5 fc0 sc0 ls0 ws155">_fields <span class="fc6 ls32">=</span>[]</div><div class="t m0 x15 hf y1cce ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ls33">,</span><span class="fc6">*</span>args):</span></span></div><div class="t m0 x16 hf y1ccf ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 ws13a">len<span class="fc0 ws145">(args) <span class="fc6 ws159">!= </span></span>len<span class="fc0">(</span>self<span class="fc6 ls34">.</span><span class="fc0">_fields):</span></span></div><div class="t m0 x17 hf y1cd0 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Expected {} arguments<span class="ff9 ls34">&apos;<span class="ff8 fc6">.</span></span></span>format(</span>len<span class="fc0 ls34">(</span>self<span class="fc6">.<span class="fc0">_fields)))</span></span></span></div><div class="t m0 x16 h11 y1cd1 ffa fs5 fcd sc0 ls0 ws4"># Set the arguments</div><div class="t m0 x16 hf y1cd2 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13b">name, value </span><span class="ws160">in <span class="ff8 ws13a">zip<span class="fc0 ls34">(</span>self<span class="fc6 ls34">.</span><span class="fc0 ws4">_fields, args):</span></span></span></div><div class="t m0 x17 hf y1cd3 ff8 fs5 fca sc0 ls0 ws13a">setattr<span class="fc0 ls34">(</span>self<span class="fc0 ws4">, name, value)</span></div><div class="t m0 x0 h7 y1cd4 ff1 fs3 fc0 sc0 ls0 wsa0">然后使你的类继承自这个基类<span class="ff4">:</span></div><div class="t m0 x5 h11 y1448 ffa fs5 fcd sc0 ls0 ws4"># Example class definitions</div><div class="t m0 x5 hf y1c39 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Stock<span class="ff8 fc0">(Structure1):</span></span></div><div class="t m0 x15 hf y1449 ff8 fs5 fc0 sc0 ls0 ws155">_fields <span class="fc6 ls32">=</span><span class="ls34">[<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13a">name<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">shares</span><span class="ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">price<span class="ff9 ls34">&apos;</span></span>]</div><div class="t m0 x5 hf y144b ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Point<span class="ff8 fc0">(Structure1):</span></span></div><div class="t m0 x15 hf y144c ff8 fs5 fc0 sc0 ls0 ws155">_fields <span class="fc6 ls32">=</span><span class="ls34">[<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13a">x<span class="ff9 ls34">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">y<span class="ff9">&apos;</span></span></span>]</div><div class="t m0 x5 hf y718 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Circle<span class="ff8 fc0">(Structure1):</span></span></div><div class="t m0 x15 hf y144e ff8 fs5 fc0 sc0 ls0 ws155">_fields <span class="fc6 ls32">=</span><span class="ls34">[<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13a">radius<span class="ff9 ls34">&apos;</span></span>]</div><div class="t m0 x15 hf y1450 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">area<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y1451 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">math<span class="fc6 ls34">.</span><span class="ws159">pi <span class="fc6 ls32">*</span></span><span class="fca">self<span class="fc6 ls34">.</span></span><span class="ws145">radius <span class="fc6 ws23d">** <span class="fc7">2</span></span></span></span></div><div class="t m0 x0 h9 y1cd5 ff1 fs3 fc0 sc0 ls0">使用这些类的示例：</div><div class="t m0 x5 hf y1cd6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0 ws13a">Stock(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">ACME<span class="ff9 ls34">&apos;</span></span></span>,<span class="fc7 ls0 ws13a">50</span><span class="ls33">,<span class="fc7 ls0 ws13a">91.1<span class="fc0">)</span></span></span></span></div><div class="t m0 x5 hf y19c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">p<span class="fc6 ls33">=</span><span class="ls0 ws13a">Point(<span class="fc7 ls34">2</span></span>,<span class="fc7 ls34">3</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y1cd7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">c<span class="fc6 ls33">=</span><span class="ls0 ws13a">Circle(<span class="fc7">4.5</span>)</span></span></div><div class="t m0 x5 hf y1cd8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">s2 <span class="fc6 ls33">=</span><span class="ws13a">Stock(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">ACME<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="fc7">50</span>)</span></span></div><div class="t m0 x5 hf y185d ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y185e ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x15 hf y185f ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;structure.py&quot;</span><span class="ws13b">, line <span class="fc7 ls34">6</span><span class="ls32">,</span><span class="ff7 fca ws157">in </span>__init__</span></div><div class="t m0 x16 hf y1860 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Expected {} arguments<span class="ff9 ls34">&apos;<span class="ff8 fc6">.</span></span></span>format(</span>len<span class="fc0 ls34">(</span>self<span class="fc6 ls34">.</span><span class="fc0">_fields)))</span></span></div><div class="t m0 x5 hf y1861 ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ws4">: Expected 3 arguments</span></div><div class="t m0 x0 h9 y1cd9 ff1 fs3 fc0 sc0 ls0">如果还想支持关键字参数，可以将关键字参数设置为实例属性：</div><div class="t m0 x5 hf y1cda ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Structure2<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf y1cdb ff8 fs5 fc0 sc0 ls0 ws155">_fields <span class="fc6 ls32">=</span>[]</div><div class="t m0 x15 hf y1cdc ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ls33">,</span><span class="fc6">*</span><span class="ws458">args, </span><span class="fc6">**</span>kwargs):</span></span></div><div class="t m0 x16 hf y1cdd ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 ws13a">len<span class="fc0 ws145">(args) <span class="fc6 ls33">&gt;</span></span>len<span class="fc0 ls34">(</span>self<span class="fc6">.<span class="fc0">_fields):</span></span></span></div><div class="t m0 x17 hf y1cde ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Expected {} arguments<span class="ff9 ls34">&apos;<span class="ff8 fc6">.</span></span></span>format(</span>len<span class="fc0 ls34">(</span>self<span class="fc6">.<span class="fc0">_fields)))</span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">10.11.<span class="_ _5"> </span>8.11 <span class="ff1 wsaf4">简化数据结构的初始化 </span>257</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
