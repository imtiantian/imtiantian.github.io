<div id="pf42" class="pf w0 h0" data-page-no="42"><div class="pc pc42 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg42.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">remap <span class="fc6 ls33">=</span>{</span></div><div class="t m0 x5 hf y1ac ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fca ws13a">ord<span class="fc0 ls34">(</span><span class="ff9 fc9 ws13b">&apos;<span class="ff7 ws156">\t</span><span class="ls34">&apos;</span><span class="ff8 fc0">) : </span><span class="ws38a">&apos; &apos;</span></span><span class="fc0">,</span></span></div><div class="t m0 x5 hf y1ad ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fca ws13a">ord<span class="fc0 ls34">(</span><span class="ff9 fc9 ws13b">&apos;<span class="ff7 ws156">\f</span><span class="ls34">&apos;</span><span class="ff8 fc0">) : </span><span class="ws38a">&apos; &apos;</span></span><span class="fc0">,</span></span></div><div class="t m0 x5 hf y1ae ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fca ws13a">ord<span class="fc0 ls34">(</span><span class="ff9 fc9 ws13b">&apos;<span class="ff7 ws156">\r</span><span class="ls34">&apos;</span><span class="ff8 fc0">) : </span></span><span class="ws161">None <span class="ffa fcd ws4"># Deleted</span></span></span></div><div class="t m0 x5 hf y1af ff7 fs5 fc5 sc0 ls0 ws139">... <span class="ff8 fc0">}</span></div><div class="t m0 x5 hf y1b0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">translate(remap)</span></span></span></span></div><div class="t m0 x5 hf y355 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">a</span></div><div class="t m0 x5 hf y410 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">pýtĥöñ is awesome\n<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y411 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y728 ff1 fs3 fc0 sc0 ls0 ws38b">正如<span class="_ _6"></span>你<span class="_ _6"></span>看<span class="_ _6"></span>的那<span class="_ _6"></span>样，<span class="_ _6"></span>空<span class="_ _6"></span>白字<span class="_ _6"></span>符 <span class="ffd ws305">\<span class="ff6 ls95">t</span></span><span class="ls96">和<span class="ffd ls84">\<span class="ff6 ls97">f</span></span><span class="ls10 ws38c">已经被重新映射到一个空格。回车字符 <span class="ff4 ls76">r</span></span></span>直</div><div class="t m0 x5 h9 y729 ff1 fs3 fc0 sc0 ls0">接被删除。</div><div class="t m0 x0 h9 y72a ff1 fs3 fc0 sc0 ls56 ws1fa">你可以以这个表格为基础进一步构建更大的表格<span class="_ _c"></span>。比如<span class="_ _1"></span>，让我们删除所有的和音<span class="_ _1"></span></div><div class="t m0 x5 h9 y72b ff1 fs3 fc0 sc0 ls0">符：</div><div class="t m0 x5 h10 y72c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">unicodedata</span></span></div><div class="t m0 x5 h10 y72d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">sys</span></span></div><div class="t m0 x5 hf y72e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws1f5">cmb_chrs <span class="fc6 ls33">=</span><span class="fca ws13a">dict<span class="fc6 ls34">.</span></span><span class="ws2a3">fromkeys(c </span></span><span class="fca ws38d">for <span class="ff8 fc0 ls33">c</span><span class="ws157">in <span class="ff8 ws13a">range<span class="fc0">(sys<span class="fc6">.</span>maxunicode)</span></span></span></span></div><div class="t m0 x5 hf y72f ff7 fs5 fc5 sc0 ls0 ws38e">... <span class="fca ws160">if <span class="ff8 fc0 ws13a">unicodedata<span class="fc6">.</span>combining(<span class="fca">chr</span>(c)))</span></span></div><div class="t m0 x5 h10 y730 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y731 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=</span><span class="ls0 ws13a">unicodedata<span class="fc6 ls34">.</span>normalize(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">NFD<span class="ff9 ws13b">&apos;</span></span><span class="ws4">, a)</span></span></span></div><div class="t m0 x5 hf y732 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">b</span></div><div class="t m0 x5 hf y733 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">pýtĥöñ is awesome\n<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y734 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">b<span class="fc6 ls0 ws13a">.<span class="fc0">translate(cmb_chrs)</span></span></span></div><div class="t m0 x5 hf y735 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">python is awesome\n<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y736 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y737 ff1 fs3 fc0 sc0 ls1e ws38f">上面例子中<span class="_ _1"></span>，通过使用 <span class="ff6 ls0 ws390">dict.fromkeys() </span><span class="ws391">方法构造一个字典，每个 <span class="ff4 ls0 ws392">Unicode <span class="ff1 wsa0">和<span class="_ _6"></span>音</span></span></span></div><div class="t m0 x5 h9 y738 ff1 fs3 fc0 sc0 ls0 ws14">符作为键，对于的值全部为 <span class="ff6 ws17a">None </span>。</div><div class="t m0 x0 h9 y739 ff1 fs3 fc0 sc0 ls0 ws393">然<span class="_ _6"></span>后<span class="_ _6"></span>使用 <span class="ff6 ws394">unicodedata.normalize() </span><span class="ls48 ws242">将原始输入标准化为分解形式字符。然后再<span class="_ _c"></span></span></div><div class="t m0 x5 h9 y73a ff1 fs3 fc0 sc0 ls0 ws395">调用 <span class="ff6 ws396">translate </span><span class="ls17 wsf6">函数删除所有重音符。同样的技术也可以被用来删除其他类型的字符</span></div><div class="t m0 x5 h7 y73b ff4 fs3 fc0 sc0 ls0 wsa5">(<span class="ff1 wsa0">比如控制字符等</span><span class="ls1b">)</span><span class="ff1">。</span></div><div class="t m0 x0 h7 y73c ff1 fs3 fc0 sc0 ls30 ws397">作为另一个例子<span class="_ _1"></span>，这里构造一个将所有 <span class="ff4 ls0 ws398">Unico<span class="_ _6"></span>de </span><span class="ws399">数字字符映射到对应的 <span class="ff4 ls0 ws39a">ASCI<span class="_ _6"></span>I <span class="ff1">字</span></span></span></div><div class="t m0 x5 h9 y73d ff1 fs3 fc0 sc0 ls0">符上的表格：</div><div class="t m0 x5 hf y73e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws1f5">digitmap <span class="fc6 ls33">=</span><span class="ws13b">{ c: <span class="fca ws13a">ord<span class="fc0">(<span class="ff9 fc9 ls34">&apos;<span class="ff8">0</span>&apos;</span><span class="ls32">)<span class="fc6 ls33">+</span></span>unicodedata<span class="fc6">.</span>digit(</span>chr</span>(c))</span></span></div><div class="t m0 x5 hf y73f ff7 fs5 fc5 sc0 ls0 ws1a3">... <span class="fca ws139">for <span class="ff8 fc0 ls32">c</span><span class="ws157">in <span class="ff8 ws13a">range<span class="fc0">(sys<span class="fc6 ls34">.</span>maxunicode)</span></span></span></span></div><div class="t m0 x5 hf y740 ff7 fs5 fc5 sc0 ls0 ws1a3">... <span class="fca ws157">if <span class="ff8 fc0 ws13a">unicodedata<span class="fc6 ls34">.</span>category(<span class="fca">chr</span><span class="ws13c">(c)) <span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span></span></span><span class="fc9">Nd<span class="ff9 ls33">&apos;</span></span>}</span></span></div><div class="t m0 x5 h10 y741 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y742 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">len<span class="fc0">(digitmap)</span></span></div><div class="t m0 x5 hf y743 ff8 fs5 fc8 sc0 ls0">460</div><div class="t m0 x5 h11 y744 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws13b"># Arabic digits</span></div><div class="t m0 x5 hf y745 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">x<span class="fc6 ls33">=<span class="ff9 fc9 ls34">&apos;</span></span></span><span class="fc9 ws156">\u0661\u0662\u0663<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y746 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">x<span class="fc6 ls0 ws13a">.<span class="fc0">translate(digitmap)</span></span></span></div><div class="t m0 x5 hf y747 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">123<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y748 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y749 ff1 fs3 fc0 sc0 ls40 ws22f">另一种清理文本的技术涉及到 <span class="ff4 ls0 ws39b">I/O </span><span class="ws180">解码与编码函数。这里的思路是先对文本做一<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y74a ff1 fs3 fc0 sc0 ls0 ws14">些初步的清理，然后再结合 <span class="ff6 ws1f3">encode() </span>或者 <span class="ff6 ws1f3">decode() </span>操作来清除或修改它。比如：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.12.<span class="_ _5"> </span>2.12 <span class="ff1 ws2ad">审查清理文本字符串 </span>57</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
