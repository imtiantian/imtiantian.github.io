<div id="pf1ff" class="pf w0 h0" data-page-no="1ff"><div class="pc pc1ff w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg1ff.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hd y112 ff2 fs4 fc4 sc0 ls0 ws211">15.8<span class="_ _e"> </span>13.8 <span class="ff1">创建和解压归档文件</span></div><div class="t m0 x5 he y113 ff2 fs2 fc4 sc0 ls0 ws212">15.8.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y3213 ff1 fs3 fc0 sc0 ls0 wsa0">你需要创建或解压常见格式的归档文件（比如<span class="ff4 wsd0">.tar, .tgz </span><span class="lsb">或</span><span class="ff4 wsa5">.zip</span>）</div><div class="t m0 x5 he y3214 ff2 fs2 fc4 sc0 ls0 ws212">15.8.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 yae2 ff6 fs3 fc0 sc0 ls0 ws1228">shutil <span class="ff1 ws1229">模块拥有两个函数—<span class="_ _8"></span>— <span class="ff6 ws122a">make<span class="_ _7"> </span>archive() </span><span class="ls21b">和</span><span class="ff6 ws122a">unpack<span class="_ _7"> </span>archive() </span>可派上用场。</span></div><div class="t m0 x5 h9 y3215 ff1 fs3 fc0 sc0 ls0">例如：</div><div class="t m0 x5 h10 y3216 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">shutil</span></span></div><div class="t m0 x5 hf y3217 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">shutil<span class="fc6 ls34">.</span>unpack_archive(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Python-3.3.0.tgz<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y3218 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">shutil<span class="fc6 ls34">.</span>make_archive(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">py33<span class="ff9 ls34">&apos;</span></span><span class="ls34">,</span><span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">zip<span class="ff9 ls34">&apos;</span></span><span class="ls34">,<span class="ff9 fc9">&apos;</span></span><span class="fc9">Python-3.3.0<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y3219 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">/Users/beazley/Downloads/py33.zip<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y321a ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y321b ff6 fs3 fc0 sc0 ls0 ws3e1">make archive()<span class="_ _37"> </span><span class="ff1 ls21c ws122b">的第二个参数是期望的输出格式<span class="_ _3"></span>。可以使用<span class="_ _3"></span></span></div><div class="t m0 x5 h9 y321c ff6 fs3 fc0 sc0 ls0 ws1d1">get<span class="_ _7"> </span>archive<span class="_ _16"> </span>formats() <span class="ff1">获取所有支持的归档格式列表。例如：</span></div><div class="t m0 x5 hf y321d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">shutil<span class="fc6 ls34">.</span>get_archive_formats()</span></div><div class="t m0 x5 hf y321e ff8 fs5 fc8 sc0 ls0 ws13a">[(<span class="ff9 ls34">&apos;</span>bztar<span class="ff9 ls34">&apos;</span><span class="ws13b">, &quot;bzip2<span class="ff9 ls34">&apos;</span><span class="ws4">ed tar-file&quot;), (</span><span class="ff9">&apos;</span></span>gztar<span class="ff9 ls34">&apos;</span><span class="ws13b">, &quot;gzip<span class="ff9 ls34">&apos;</span>ed tar-file&quot;),</span></div><div class="t m0 x4b hf y321f ff8 fs5 fc8 sc0 ls0 ws13a">(<span class="ff9 ls34">&apos;</span>tar<span class="ff9 ls34">&apos;</span><span class="ls33">,</span><span class="ff9 ws13b">&apos;</span><span class="ws4">uncompressed tar file<span class="ff9 ws13b">&apos;</span>), (<span class="ff9 ls34">&apos;</span></span>zip<span class="ff9 ls34">&apos;</span><span class="ls32">,<span class="ff9 ls34">&apos;</span></span><span class="ws4">ZIP file<span class="ff9 ls34">&apos;</span>)]</span></div><div class="t m0 x5 hf y3220 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he yd4e ff2 fs2 fc4 sc0 ls0 ws212">15.8.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 y3221 ff4 fs3 fc0 sc0 ls0 ws759">Python <span class="ff1 ls22 ws122c">还有其他的模块可用来处理多种归档格式（<span class="_ _1"></span>比如 <span class="ff4 ls0 wsf17">tarﬁle, zipﬁle, gzip, bz2<span class="ff1">）</span></span></span></div><div class="t m0 x5 h9 y3222 ff1 fs3 fc0 sc0 ls1e ws111">的底层细节<span class="_ _1"></span>。不过，如果你仅仅只是<span class="_ _1"></span>要创建或提取某个归档，就没有必要使用底<span class="_ _1"></span>层库</div><div class="t m0 x5 h9 y3223 ff1 fs3 fc0 sc0 ls0 ws14">了。可以直接使用 <span class="ff6 ws25d">shutil </span>中的这些高层函数。</div><div class="t m0 x0 h7 y3224 ff1 fs3 fc0 sc0 ls3a ws122d">这些函数还有很多其他选项，用于日志打印、预检、文件权限等等。参考 <span class="ff4 fc3 ls0 ws122e">sh<span class="_ _c"></span>util <span class="ff1">文</span></span></div><div class="t m0 x5 h9 y12b4 ff1 fs3 fc3 sc0 ls0">档</div><div class="t m0 x5 hd y3225 ff2 fs4 fc4 sc0 ls0 ws211">15.9<span class="_ _e"> </span>13.9 <span class="ff1">通过文件名查找文件</span></div><div class="t m0 x5 he y3226 ff2 fs2 fc4 sc0 ls0 ws212">15.9.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y3227 ff1 fs3 fc0 sc0 ls3a ws153">你需要写一个涉及到文件查找操作的脚本，比如对日志归档文件的重命名工具，你</div><div class="t m0 x5 h7 y3228 ff1 fs3 fc0 sc0 ls0 ws38">不想在 <span class="ff4 ws5c">Python </span><span class="ws63">脚本中调用 <span class="ff4 wsa5">shell</span></span>，或者你要实现一些 <span class="ff4 wsd7b">shell </span>不能做的功能。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">15.8.<span class="_ _36"> </span>13.8 <span class="ff1 ws544">创建和解压归档文件 </span>502</div><a class="l" href="https://docs.python.org/3/library/shutil.html"><div class="d m1" style="border-style:none;position:absolute;left:718.542000px;bottom:412.348500px;width:44.248000px;height:16.821000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://docs.python.org/3/library/shutil.html"><div class="d m1" style="border-style:none;position:absolute;left:108.000000px;bottom:391.471500px;width:11.955000px;height:14.016000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
