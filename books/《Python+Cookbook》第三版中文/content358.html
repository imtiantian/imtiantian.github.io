<div id="pf166" class="pf w0 h0" data-page-no="166"><div class="pc pc166 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg166.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1e8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">bar(s</span><span class="ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">hello<span class="ff9 ls34">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x5 hf y1e9 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y1ea ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x5 hf y903 ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ws4">: __call__() got an unexpected keyword argument <span class="ff9 ls34">&apos;<span class="ff8">s</span><span class="ls0">&apos;</span></span></span></div><div class="t m0 x5 hf y1eb ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 yd18 ff1 fs3 fc0 sc0 ls3a ws153">也许有其他的方法能添加这种支持，但是它需要一个完全不同的方法映射方式。问</div><div class="t m0 x5 h9 y253d ff1 fs3 fc0 sc0 ls13 wse5">题在于关键字参数的出现是没有顺序的<span class="_ _1"></span>。当它跟位置参数混合使用时，那你的参数就<span class="_ _c"></span></div><div class="t m0 x5 h9 y253e ff1 fs3 fc0 sc0 ls0 ws911">会变得比较混乱了，这时候你不得不在 <span class="ff6 ws308">call<span class="_ _e"> </span>() </span>方法中先去做个排序。</div><div class="t m0 x0 h9 y253f ff1 fs3 fc0 sc0 ls0">同样对于继承也是有限制的，例如，类似下面这种代码就不能正常工作：</div><div class="t m0 x5 hf y2540 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ls34">A</span><span class="ff8 fc0">:</span></div><div class="t m0 x15 h10 y2541 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hf y2542 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ls34">B</span><span class="ff8 fc0">(A):</span></div><div class="t m0 x15 h10 y155a ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hf y155c ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ls34">C</span><span class="ff8 fc0">:</span></div><div class="t m0 x15 h10 y155d ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hf y155f ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Spam<span class="ff8 fc0 ws13a">(metaclass<span class="fc6">=</span>MultipleMeta):</span></span></div><div class="t m0 x15 hf y2543 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">foo<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, x:A):</span></span></span></div><div class="t m0 x16 hf y2544 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Foo 1:</span>&apos;</span><span class="ls0 ws13b">, x)</span></span></div><div class="t m0 x15 hf y2545 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">foo<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, x:C):</span></span></span></div><div class="t m0 x16 hf y2546 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Foo 2:</span>&apos;</span><span class="ls0 ws13b">, x)</span></span></div><div class="t m0 x0 h7 y2547 ff1 fs3 fc0 sc0 ls0 ws38">原因是因为 <span class="ff6 ws15e">x:A </span>注解不能成功匹配子类实例（比如 <span class="ff4 ls167">B</span><span class="wsa0">的实例）<span class="_ _f"></span>，如下：</span></div><div class="t m0 x5 hf y24ef ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0">Spam()</span></span></div><div class="t m0 x5 hf y2548 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls0">A()</span></span></div><div class="t m0 x5 hf y2549 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">foo(a)</span></span></span></div><div class="t m0 x5 hf y254a ff8 fs5 fc8 sc0 ls0 ws4">Foo 1: &lt;__main__.A object at 0x1006a5310&gt;</div><div class="t m0 x5 hf y254b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">c<span class="fc6 ls33">=</span><span class="ls0">C()</span></span></div><div class="t m0 x5 hf y254c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">foo(c)</span></span></span></div><div class="t m0 x5 hf y254d ff8 fs5 fc8 sc0 ls0 ws4">Foo 2: &lt;__main__.C object at 0x1007a1910&gt;</div><div class="t m0 x5 hf y254e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=</span><span class="ls0">B()</span></span></div><div class="t m0 x5 hf y210c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">foo(b)</span></span></span></div><div class="t m0 x5 hf y254f ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y2550 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x15 hf y2481 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;multiple.py&quot;</span><span class="ws13b">, line <span class="fc7 ws13a">44</span><span class="ls32">,</span><span class="ff7 fca ws157">in </span>__call__</span></div><div class="t m0 x16 hf y2551 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">No matching method for types {}<span class="ff9 ws13b">&apos;</span><span class="fc6 ls34">.</span></span>format(types))</span></span></div><div class="t m0 x5 hf y2552 ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ws4">: No matching method for types (&lt;class <span class="ff9 ls34">&apos;</span><span class="ws13a">__main__.B<span class="ff9 ls34">&apos;</span>&gt;,)</span></span></div><div class="t m0 x5 hf y2553 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y2554 ff1 fs3 fc0 sc0 ls0">作为使用元类和注解的一种替代方案，可以通过描述器来实现类似的效果。例如：</div><div class="t m0 x5 h10 y2555 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">types</span></div><div class="t m0 x5 hf y2556 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">multimethod<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf y2557 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, func):</span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">11.20.<span class="_ _5"> </span>9.20 <span class="ff1 wsc0a">利用函数注解实现方法重载 </span>349</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
