<div id="pf7b" class="pf w0 h0" data-page-no="7b"><div class="pc pc7b w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg7b.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y15f ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 h11 y956 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Run to next yield</span></div><div class="t m0 x5 hf y957 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">next<span class="fc0">(c)</span></span></div><div class="t m0 x5 hf y958 ff8 fs5 fc8 sc0 ls0">1</div><div class="t m0 x5 h11 y95a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Run to next yield (iteration stops)</span></div><div class="t m0 x5 hf y95b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">next<span class="fc0">(c)</span></span></div><div class="t m0 x5 hf y95c ff8 fs5 fc8 sc0 ls0">Done!</div><div class="t m0 x5 hf y9f3 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y9f4 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x5 hf y95d ff8 fs5 fc2 sc0 ls0">StopIteration</div><div class="t m0 x5 hf y95e ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 ydb0 ff1 fs3 fc0 sc0 ls10 ws57b">一个生成器函数主要特征是它只会回应在迭代中使用到的 <span class="ff13 ls0 ws57c">next <span class="ff1 wsa0">操作。<span class="_ _6"></span>一<span class="_ _6"></span>旦生<span class="_ _6"></span>成<span class="_ _6"></span>器</span></span></div><div class="t m0 x5 h7 ydb1 ff1 fs3 fc0 sc0 ls0 ws57d">函数返回退出，迭代终止。<span class="_ _1"></span>我们在迭代中通常使用的 <span class="ff4 ws57e">for </span><span class="wsa0">语句会自动处理这些细节，所</span></div><div class="t m0 x5 h9 ydb2 ff1 fs3 fc0 sc0 ls0">以你无需担心。</div><div class="t m0 x5 hd ydb3 ff2 fs4 fc4 sc0 ls0 ws134">6.4<span class="_ _e"> </span>4.4 <span class="ff1">实现迭代器协议</span></div><div class="t m0 x5 he ydb4 ff2 fs2 fc4 sc0 ls0 ws135">6.4.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 ydb5 ff1 fs3 fc0 sc0 ls3a ws153">你想构建一个能支持迭代操作的自定义对象，并希望找到一个能实现迭代协议的简</div><div class="t m0 x5 h9 ydb6 ff1 fs3 fc0 sc0 ls0">单方法。</div><div class="t m0 x5 he ydb7 ff2 fs2 fc4 sc0 ls0 ws135">6.4.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 ydb8 ff1 fs3 fc0 sc0 ls68 ws57f">目前为止，在一个对象上实现迭代最简单的方式是使用一个生成器函数。在 <span class="ff4 ls0 ws2a9">4.2 <span class="ff1">小</span></span></div><div class="t m0 x5 h7 y7fe ff1 fs3 fc0 sc0 ls0 ws580">节<span class="_ _6"></span>中，<span class="_ _6"></span>使<span class="_ _6"></span>用 <span class="ff4 ws581">No<span class="_ _6"></span>de </span><span class="ls14 ws174">类来表示树形数据结构<span class="_ _1"></span>。你可能想实现一个以深度优先方式遍历树<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y893 ff1 fs3 fc0 sc0 ls0">形节点的生成器。下面是代码示例：</div><div class="t m0 x5 hf ydb9 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Node<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf ydba ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, value):</span></span></span></div><div class="t m0 x16 hf ydbb ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws19f">_value </span><span class="ls32">=</span><span class="fc0">value</span></span></div><div class="t m0 x16 hf ydbc ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws51e">_children </span><span class="ls32">=</span><span class="fc0">[]</span></span></div><div class="t m0 x15 hf ydbd ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__repr__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf ydbe ff7 fs5 fca sc0 ls0 ws146">return <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">Node({!r})</span>&apos;</span><span class="ff8 fc6 ws13a">.<span class="fc0">format(<span class="fca">self</span></span><span class="ls34">.</span><span class="fc0">_value)</span></span></div><div class="t m0 x15 hf ydbf ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">add_child<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, node):</span></span></span></div><div class="t m0 x16 hf ydc0 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">_children</span><span class="ls34">.</span><span class="fc0">append(node)</span></span></div><div class="t m0 x15 hf ydc1 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__iter__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf ydc2 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">iter<span class="fc0 ls34">(</span>self<span class="fc6 ls34">.</span><span class="fc0">_children)</span></span></div><div class="t m0 x15 hf ydc3 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">depth_first<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf ydc4 ff7 fs5 fca sc0 ls0 ws16a">yield <span class="ff8">self</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">6.4.<span class="_ _5"> </span>4.4 <span class="ff1 ws582">实现迭代器协议 </span>114</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
