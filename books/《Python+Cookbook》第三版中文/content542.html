<div id="pf21e" class="pf w0 h0" data-page-no="21e"><div class="pc pc21e w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg21e.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 wsadf">16.10.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y675 ff1 fs3 fc0 sc0 ls49 ws1a6">这个问题通常是当你需要在捕获异常后执行某个操作（<span class="_ _c"></span>比如记录日志、清理等<span class="_ _c"></span>）<span class="_ _f"></span>，<span class="_ _c"></span></div><div class="t m0 x5 h9 y676 ff1 fs3 fc0 sc0 ls0">但是之后想将异常传播下去。一个很常见的用法是在捕获所有异常的处理器中：</div><div class="t m0 x5 hf y34a1 ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x3c hf y34a2 ff8 fs5 fc6 sc0 ls34 ws76a">...</div><div class="t m0 x5 hf y14e9 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 ws16e">Exception </span><span class="ws160">as <span class="ff8 fc0">e:</span></span></div><div class="t m0 x3c h11 y14ea ffa fs5 fcd sc0 ls0 ws4"># Process exception information in some way</div><div class="t m0 x3c hf y14eb ff8 fs5 fc6 sc0 ls34 ws76a">...</div><div class="t m0 x3c h11 y14ed ffa fs5 fcd sc0 ls0 ws4"># Propagate the exception</div><div class="t m0 x3c h10 y14ee ff7 fs5 fca sc0 ls0">raise</div><div class="t m0 x5 hd y34a3 ff2 fs4 fc4 sc0 ls0 wsd91">16.11<span class="_ _e"> </span>14.11 <span class="ff1">输出警告信息</span></div><div class="t m0 x5 he y34a4 ff2 fs2 fc4 sc0 ls0 wsadf">16.11.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y2376 ff1 fs3 fc0 sc0 ls0 wsa0">你希望自己的程序能生成警告信息（比如废弃特性或使用问题）<span class="_ _f"></span>。</div><div class="t m0 x5 he y34a5 ff2 fs2 fc4 sc0 ls0 wsadf">16.11.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y34a6 ff1 fs3 fc0 sc0 ls0 ws38">要输出一个警告消息，可使用 <span class="ff6 ws2dc">warning.warn() </span>函数。例如：</div><div class="t m0 x5 h10 y1887 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">warnings</span></div><div class="t m0 x5 hf y34a7 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">func<span class="fc0 ws13b">(x, y, logfile<span class="fc6 ls34">=</span></span><span class="fca">None<span class="fc0 ws13b">, debug</span><span class="fc6">=</span>False<span class="fc0">):</span></span></span></div><div class="t m0 x15 hf y34a8 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws155">logfile </span>is not <span class="ff8 ws13a">None<span class="fc0">:</span></span></div><div class="t m0 x2b hf y303 ff8 fs5 fc0 sc0 ls0 ws13a">warnings<span class="fc6 ls34">.</span>warn(<span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">logfile argument deprecated</span><span class="ls34">&apos;</span></span><span class="ls32">,</span><span class="fca">DeprecationWarning</span>)</div><div class="t m0 x15 hf y34a9 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h7 y34aa ff6 fs3 fc0 sc0 ls0 ws12e9">warn() <span class="ff1 wsa0">的<span class="_ _6"></span>参<span class="_ _6"></span>数<span class="_ _6"></span>是<span class="_ _6"></span>一<span class="_ _0"></span>个警<span class="_ _0"></span>告消<span class="_ _6"></span>息<span class="_ _0"></span>和一<span class="_ _0"></span>个警<span class="_ _0"></span>告类，<span class="_ _0"></span>警告<span class="_ _0"></span>类有<span class="_ _0"></span>如下<span class="_ _0"></span>几种：<span class="_ _0"></span><span class="ff4 wsa5">UserW<span class="_ _8"></span>arning,</span></span></div><div class="t m0 x5 h7 y34ab ff4 fs3 fc0 sc0 ls0 ws12ea">Deprecation<span class="_ _8"></span>W<span class="_ _d"></span>arning, Syn<span class="_ _1"></span>taxW<span class="_ _8"></span>arning, Run<span class="_ _c"></span>timeW<span class="_ _d"></span>arning, ResourceW<span class="_ _d"></span>arning, <span class="ff1 ls22f">或</span><span class="wsa5">F<span class="_ _8"></span>uture-</span></div><div class="t m0 x5 h7 y34ac ff4 fs3 fc0 sc0 ls0 wsa5">W<span class="_ _8"></span>arning.</div><div class="t m0 x0 h9 y34ad ff1 fs3 fc0 sc0 ls0 ws12eb">对<span class="_ _6"></span>警告<span class="_ _6"></span>的<span class="_ _6"></span>处<span class="_ _6"></span>理取<span class="_ _6"></span>决<span class="_ _6"></span>于<span class="_ _6"></span>你<span class="_ _6"></span>如何<span class="_ _6"></span>运<span class="_ _6"></span>行<span class="_ _6"></span>解<span class="_ _6"></span>释器<span class="_ _6"></span>以<span class="_ _6"></span>及<span class="_ _6"></span>一<span class="_ _6"></span>些其<span class="_ _6"></span>他<span class="_ _6"></span>配<span class="_ _6"></span>置。<span class="_ _6"></span>例如，<span class="_ _6"></span>如<span class="_ _6"></span>果<span class="_ _6"></span>你<span class="_ _6"></span>使<span class="_ _6"></span>用 <span class="ff6 ws303">-W</span></div><div class="t m0 x5 h7 y34ae ff6 fs3 fc0 sc0 ls0 ws15e">all <span class="ff1 ws38">选项去运行 <span class="ff4 wsa5">Python</span>，你会得到如下的输出：</span></div><div class="t m0 x5 hf y34af ff8 fs5 fc0 sc0 ls0 ws4">bash % python3 -W all example.py</div><div class="t m0 x5 hf y34b0 ff8 fs5 fc0 sc0 ls0 ws4">example.py:5: DeprecationWarning: logfile argument is deprecated</div><div class="t m0 x19 hf y34b1 ff8 fs5 fc0 sc0 ls0 ws13a">warnings.warn(<span class="ff9 ws13b">&apos;</span><span class="ws4">logfile argument is deprecated<span class="ff9 ls34">&apos;</span><span class="ws13b">, DeprecationWarning)</span></span></div><div class="t m0 x0 h9 y34b2 ff1 fs3 fc0 sc0 ls13 ws12ec">通常来讲<span class="_ _1"></span>，警告会输出到标准错误上。如果你想讲警告转换为异常<span class="_ _1"></span>，可以使用 <span class="ff6 ls0 ws303">-W</span></div><div class="t m0 x5 h9 y34b3 ff6 fs3 fc0 sc0 ls0 ws17d">error <span class="ff1">选项：</span></div><div class="t m0 x5 hf y34b4 ff8 fs5 fc0 sc0 ls0 ws4">bash % python3 -W error example.py</div><div class="t m0 x5 hf y34b5 ff8 fs5 fc0 sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x19 hf y34b6 ff8 fs5 fc0 sc0 ls0 ws4">File &quot;example.py&quot;, line 10, in &lt;module&gt;</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsd97">16.11.<span class="_ _36"> </span>14.11 <span class="ff1 wse4d">输出警告信息 </span>533</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
