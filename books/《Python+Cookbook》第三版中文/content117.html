<div id="pf75" class="pf w0 h0" data-page-no="75"><div class="pc pc75 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg75.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h9 y2a ff6 fs3 fc0 sc0 ls0 ws545">pytz <span class="ff1 ws4f4">模块一个主要用途是将 </span><span class="ws546">datetime <span class="ff1 wsa0">库创建的简单日期对象本地化。比如，<span class="_ _1"></span>下面</span></span></div><div class="t m0 x5 h9 y2b ff1 fs3 fc0 sc0 ls0">如何表示一个芝加哥时间的示例：</div><div class="t m0 x5 hf yd14 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws248">datetime </span><span class="ws146">import <span class="ff8 fc0">datetime</span></span></span></div><div class="t m0 x5 hf yd15 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws218">pytz </span><span class="ws146">import <span class="ff8 fc0">timezone</span></span></span></div><div class="t m0 x5 hf yd16 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0 ws13a">datetime(<span class="fc7">2012</span><span class="ls33">,</span><span class="fc7">12</span><span class="ls33">,</span><span class="fc7">21</span><span class="ls33">,</span><span class="fc7">9</span><span class="ls33">,</span><span class="fc7">30</span><span class="ls33">,</span><span class="fc7">0</span>)</span></span></div><div class="t m0 x5 hf yd17 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(d)</span></span></div><div class="t m0 x5 hf yd18 ff8 fs5 fc8 sc0 ls0 ws4">2012-12-21 09:30:00</div><div class="t m0 x5 hf yd19 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h11 yd1a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Localize the date for Chicago</span></div><div class="t m0 x5 hf yd1b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws155">central <span class="fc6 ls32">=</span><span class="ws13a">timezone(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">US/Central<span class="ff9 ws13b">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf yd1c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">loc_d <span class="fc6 ls33">=</span><span class="ws13a">central<span class="fc6 ls34">.</span>localize(d)</span></span></div><div class="t m0 x5 hf yd1d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(loc_d)</span></span></div><div class="t m0 x5 hf yd1e ff8 fs5 fc8 sc0 ls0 ws4">2012-12-21 09:30:00-06:00</div><div class="t m0 x5 hf yd1f ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 yd20 ff1 fs3 fc0 sc0 ls3a ws153">一旦日期被本地化了，它就可以转换为其他时区的时间了。为了得到班加罗尔对应</div><div class="t m0 x5 h9 yd21 ff1 fs3 fc0 sc0 ls0">的时间，你可以这样做：</div><div class="t m0 x5 h11 yd22 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Convert to Bangalore time</span></div><div class="t m0 x5 hf yd23 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">bang_d <span class="fc6 ls32">=</span><span class="ws13a">loc_d<span class="fc6 ls34">.</span>astimezone(timezone(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Asia/Kolkata<span class="ff9 ls34">&apos;</span></span>))</span></span></div><div class="t m0 x5 hf yd24 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(bang_d)</span></span></div><div class="t m0 x5 hf yd25 ff8 fs5 fc8 sc0 ls0 ws4">2012-12-21 21:00:00+05:30</div><div class="t m0 x5 hf yd26 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 yd27 ff1 fs3 fc0 sc0 ls3a ws153">如果你打算在本地化日期上执行计算，你需要特别注意夏令时转换和其他细节。比</div><div class="t m0 x5 h7 yd28 ff1 fs3 fc0 sc0 ls0 ws547">如，在 <span class="ff4 ws548">2013 </span><span class="ws549">年，美国标准夏令时时间开始于本地时间 <span class="ff4 lse5">3</span><span class="lse6">月</span><span class="ff4 ws54a">13 </span><span class="ws54b">日凌晨 <span class="ff4 wsa5">2:00(</span><span class="wsa0">在那时，<span class="_ _1"></span>时</span></span></span></div><div class="t m0 x5 h7 yd29 ff1 fs3 fc0 sc0 ls0 wsa0">间向前跳过一小时<span class="ff4 ls1b">)</span>。如果你正在执行本地计算，你会得到一个错误。比如：</div><div class="t m0 x5 hf yd2a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0 ws13a">datetime(<span class="fc7">2013</span><span class="ls33">,</span><span class="fc7">3</span><span class="ls33">,</span><span class="fc7">10</span><span class="ls33">,<span class="fc7 ls34">1</span></span></span>,<span class="fc7 ls0 ws13a">45<span class="fc0">)</span></span></span></div><div class="t m0 x5 hf yd2b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">loc_d <span class="fc6 ls33">=</span><span class="ws13a">central<span class="fc6 ls34">.</span>localize(d)</span></span></div><div class="t m0 x5 hf yd2c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(loc_d)</span></span></div><div class="t m0 x5 hf yd2d ff8 fs5 fc8 sc0 ls0 ws4">2013-03-10 01:45:00-06:00</div><div class="t m0 x5 hf yd2e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">later <span class="fc6 ls33">=</span>loc_d <span class="fc6 ls33">+</span><span class="ws13a">timedelta(minutes<span class="fc6 ls34">=</span><span class="fc7">30</span>)</span></span></div><div class="t m0 x5 hf yd2f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(later)</span></span></div><div class="t m0 x5 hf yd30 ff8 fs5 fc8 sc0 ls0 ws4">2013-03-10 02:15:00-06:00 # WRONG! WRONG!</div><div class="t m0 x5 hf yd31 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 yd32 ff1 fs3 fc0 sc0 ls22 ws119">结果错误是因为它并没有考虑在本地时间中有一小时的跳跃。为了修正这个错误<span class="_ _1"></span>，</div><div class="t m0 x5 h9 yd33 ff1 fs3 fc0 sc0 ls0 ws14">可以使用时区对象 <span class="ff6 ws1e2">normalize() </span>方法。比如：</div><div class="t m0 x5 hf yd34 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws248">datetime </span><span class="ws146">import <span class="ff8 fc0">timedelta</span></span></span></div><div class="t m0 x5 hf yd35 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">later <span class="fc6 ls33">=</span><span class="ws13a">central<span class="fc6 ls34">.</span><span class="ws511">normalize(loc_d <span class="fc6 ls33">+</span></span>timedelta(minutes<span class="fc6 ls34">=</span><span class="fc7">30</span>))</span></span></div><div class="t m0 x5 hf yd36 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(later)</span></span></div><div class="t m0 x5 hf yd37 ff8 fs5 fc8 sc0 ls0 ws4">2013-03-10 03:15:00-05:00</div><div class="t m0 x5 hf yd38 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">5.16.<span class="_ _5"> </span>3.16 <span class="ff1 ws544">结合时区的日期操作 </span>108</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
