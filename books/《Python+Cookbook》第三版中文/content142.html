<div id="pf8e" class="pf w0 h0" data-page-no="8e"><div class="pc pc8e w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg8e.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws212">6.14.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y236 ff1 fs3 fc0 sc0 ls0 ws601">语<span class="_ _6"></span>句 <span class="ff6 ws602">yield<span class="_ _1c"> </span>from </span><span class="ls48 ws242">在你想在生成器中调用其他生成器作为子例程的时候非常有用<span class="_ _1"></span>。</span></div><div class="t m0 x5 h9 y237 ff1 fs3 fc0 sc0 ls0 ws63">如果你不使用它的话，那么就必须写额外的 <span class="ff6 ws603">for </span>循环了。比如：</div><div class="t m0 x5 hf y374 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">flatten<span class="fc0 ws4">(items, ignore_types</span><span class="fc6">=<span class="fc0 ls34">(</span><span class="fca">str<span class="fc0 ls33">,</span>bytes<span class="fc0">)):</span></span></span></span></div><div class="t m0 x15 hf y375 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ls32">x</span><span class="ws157">in <span class="ff8 fc0">items:</span></span></div><div class="t m0 x16 hf y376 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 ws13a">isinstance<span class="fc0 ws147">(x, Iterable) </span></span><span class="ws139">and not <span class="ff8 ws13a">isinstance<span class="fc0 ws13b">(x, ignore_types):</span></span></span></div><div class="t m0 x17 hf y377 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ls32">i</span><span class="ws157">in <span class="ff8 fc0">flatten(x):</span></span></div><div class="t m0 x18 hf y378 ff7 fs5 fca sc0 ls0 ws16a">yield <span class="ff8 fc0">i</span></div><div class="t m0 x16 hf y379 ff7 fs5 fca sc0 ls0 ws156">else<span class="ff8 fc0">:</span></div><div class="t m0 x17 hf yaff ff7 fs5 fca sc0 ls0 ws16a">yield <span class="ff8 fc0">x</span></div><div class="t m0 x0 h9 yfae ff1 fs3 fc0 sc0 ls18 ws604">尽管只改了一点点，但是 <span class="ff6 ls0 ws605">yield<span class="_ _11"> </span>from </span><span class="ws110">语句看上去感觉更好，并且也使得代码更简<span class="_ _1"></span></span></div><div class="t m0 x5 h9 yfaf ff1 fs3 fc0 sc0 ls0">洁清爽。</div><div class="t m0 x0 h9 yfb0 ff1 fs3 fc0 sc0 ls3a ws153">之前提到的对于字符串和字节的额外检查是为了防止将它们再展开成单个字符。如</div><div class="t m0 x5 h9 yfb1 ff1 fs3 fc0 sc0 ls0 ws14">果还有其他你不想展开的类型，修改参数 <span class="ff6 ws17d">ignore<span class="_ _7"> </span>types </span>即可。</div><div class="t m0 x0 h9 yfb2 ff1 fs3 fc0 sc0 ls0 ws606">最后要<span class="_ _6"></span>注意的<span class="_ _6"></span>一点是， <span class="ff6 ws607">yield<span class="_ _23"> </span>from </span><span class="ls2c ws12f">在涉及到基于协程和生成器的并发编程中扮演</span></div><div class="t m0 x5 h7 yfb3 ff1 fs3 fc0 sc0 ls0 ws38">着更加重要的角色。可以参考 <span class="ff4 ws608">12.12 </span>小节查看另外一个例子。</div><div class="t m0 x5 hd yfb4 ff2 fs4 fc4 sc0 ls0 ws211">6.15<span class="_ _e"> </span>4.15 <span class="ff1">顺序迭代合并后的排序迭代对象</span></div><div class="t m0 x5 he yfb5 ff2 fs2 fc4 sc0 ls0 ws212">6.15.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y320 ff1 fs3 fc0 sc0 ls0">你有一系列排序序列，想将它们合并后得到一个排序序列并在上面迭代遍历。</div><div class="t m0 x5 he yfb6 ff2 fs2 fc4 sc0 ls0 ws212">6.15.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 yad2 ff6 fs3 fc0 sc0 ls0 ws309">heapq.merge() <span class="ff1">函数可以帮你解决这个问题。比如：</span></div><div class="t m0 x5 h10 yb5d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">heapq</span></span></div><div class="t m0 x5 hf yfb7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls34">[<span class="fc7 ls0 ws13a">1</span><span class="ls33">,<span class="fc7 ls0 ws13a">4</span>,</span><span class="fc7">7</span></span>,<span class="fc7 ls0 ws13a">10<span class="fc0">]</span></span></span></div><div class="t m0 x5 hf yfb8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=</span><span class="ls34">[<span class="fc7 ls0 ws13a">2</span><span class="ls33">,<span class="fc7 ls0 ws13a">5</span>,</span><span class="fc7">6</span></span>,<span class="fc7 ls0 ws13a">11<span class="fc0">]</span></span></span></div><div class="t m0 x5 hf yfb9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">c</span><span class="ws157">in <span class="ff8 fc0 ws13a">heapq<span class="fc6 ls34">.</span><span class="ws13b">merge(a, b):</span></span></span></span></div><div class="t m0 x5 hf yfba ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(c)</span></span></div><div class="t m0 x5 h10 yfbb ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf yfbc ff8 fs5 fc8 sc0 ls0">1</div><div class="t m0 x5 hf yfbd ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 hf yfbe ff8 fs5 fc8 sc0 ls0">4</div><div class="t m0 x5 hf yfbf ff8 fs5 fc8 sc0 ls0">5</div><div class="t m0 x5 hf yfc0 ff8 fs5 fc8 sc0 ls0">6</div><div class="t m0 x5 hf yfc1 ff8 fs5 fc8 sc0 ls0">7</div><div class="t m0 x5 hf yfc2 ff8 fs5 fc8 sc0 ls0">10</div><div class="t m0 x5 hf yfc3 ff8 fs5 fc8 sc0 ls0">11</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">6.15.<span class="_ _5"> </span>4.15 <span class="ff1 ws609">顺序迭代合并后的排序迭代对象 </span>133</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
