<div id="pf103" class="pf w0 h0" data-page-no="103"><div class="pc pc103 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg103.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h7 y2a ff1 fs3 fc0 sc0 ls42 wsabf">值的注意的是上面演示的第一种技术还可以被用来扩展一个描述器 <span class="ff4 ls0 wsa5">(</span><span class="ls57">在<span class="ff4 ls0 wsac0">8.9 </span></span><span class="ws186">小节我</span></div><div class="t m0 x5 h7 y2b ff1 fs3 fc0 sc0 ls0 wsa0">们有专门的介绍<span class="ff4 wsa5">)</span>。比如：</div><div class="t m0 x5 h11 y1c17 ffa fs5 fcd sc0 ls0 ws4"># A descriptor</div><div class="t m0 x5 hf y1c18 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">String<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf y1c19 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, name):</span></span></span></div><div class="t m0 x16 hf y1c1a ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws13c">name </span><span class="ls33">=</span><span class="fc0">name</span></span></div><div class="t m0 x15 hf y1c1b ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__get__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, instance, cls):</span></span></span></div><div class="t m0 x16 hf y1c1c ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws16d">instance </span>is <span class="ff8 ws13a">None<span class="fc0">:</span></span></div><div class="t m0 x17 hf y1c1d ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8">self</span></div><div class="t m0 x16 hf y1c1e ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">instance<span class="fc6">.</span>__dict__[<span class="fca">self<span class="fc6 ls34">.</span></span>name]</span></div><div class="t m0 x15 hf y1c1f ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__set__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, instance, value):</span></span></span></div><div class="t m0 x16 hf y1c20 ff7 fs5 fca sc0 ls0 ws157">if not <span class="ff8 ws13a">isinstance<span class="fc0 ws155">(value, </span>str<span class="fc0">):</span></span></div><div class="t m0 x17 hf y1c21 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Expected a string<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x16 hf y1c22 ff8 fs5 fc0 sc0 ls0 ws13a">instance<span class="fc6">.</span>__dict__[<span class="fca">self<span class="fc6 ls34">.</span></span><span class="ws15f">name] <span class="fc6 ls32">=</span>value</span></div><div class="t m0 x5 h11 y1c23 ffa fs5 fcd sc0 ls0 ws4"># A class with a descriptor</div><div class="t m0 x5 hf y1c24 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Person<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf y1c25 ff8 fs5 fc0 sc0 ls0 ws13c">name <span class="fc6 ls32">=</span><span class="ws13a">String(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">name<span class="ff9 ws13b">&apos;</span></span>)</span></div><div class="t m0 x15 hf y1c26 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, name):</span></span></span></div><div class="t m0 x16 hf y1c27 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws13c">name </span><span class="ls33">=</span><span class="fc0">name</span></span></div><div class="t m0 x5 h11 y1c28 ffa fs5 fcd sc0 ls0 ws4"># Extending a descriptor with a property</div><div class="t m0 x5 hf y1c29 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">SubPerson<span class="ff8 fc0">(Person):</span></span></div><div class="t m0 x15 h10 y1c2a ff7 fs5 fc12 sc0 ls0">@property</div><div class="t m0 x15 hf y1c2b ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">name<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y1c2c ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Getting name<span class="ff9">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x16 hf y8ce ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">super<span class="fc0">()<span class="fc6 ls34">.</span>name</span></span></div><div class="t m0 x15 h10 y1c2d ff7 fs5 fc12 sc0 ls0">@name.setter</div><div class="t m0 x15 hf y1c2e ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">name<span class="fc0">(<span class="fca">self</span><span class="ws4">, value):</span></span></span></div><div class="t m0 x16 hf y1c2f ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Setting name to</span>&apos;</span><span class="ls0 ws13b">, value)</span></span></div><div class="t m0 x16 hf y1c30 ff8 fs5 fca sc0 ls0 ws13a">super<span class="fc0 ws4">(SubPerson, SubPerson)<span class="fc6 ls34">.</span><span class="ws13a">name<span class="fc6 ls34">.</span>__set__(</span></span>self<span class="fc0 ws13b">, value)</span></div><div class="t m0 x15 h10 y1c31 ff7 fs5 fc12 sc0 ls0">@name.deleter</div><div class="t m0 x15 hf y1c32 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">name<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y1c33 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Deleting name</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x16 hf y1c34 ff8 fs5 fca sc0 ls0 ws13a">super<span class="fc0 ws4">(SubPerson, SubPerson)<span class="fc6 ls34">.</span><span class="ws13a">name<span class="fc6 ls34">.</span>__delete__(</span></span>self<span class="fc0">)</span></div><div class="t m0 x0 h9 y1c35 ff1 fs3 fc0 sc0 ls35 wsac1">最后值的注意的是，读到这里时，你应该会发现子类化 <span class="ff6 ls0 wsac2">setter </span><span class="lsad">和<span class="ff6 ls0 ws207">deleter <span class="ff1 wsa0">方法其</span></span></span></div><div class="t m0 x5 h7 y1c36 ff1 fs3 fc0 sc0 ls0 wsac3">实是很简单的。这里演示的解决方案同样适用，但是在 <span class="ff4 fc3 wsac4">Python <span class="ff1 ls174">的</span><span class="wsac5">issue <span class="ff1 ws2c8">页面 </span></span></span>报告的一</div><div class="t m0 x5 h7 y1c37 ff1 fs3 fc0 sc0 ls4">个<span class="ff4 ls0 wsa5">bug</span><span class="ls0 ws38">，或许会使得将来的 <span class="ff4 ws5c">Python </span>版本中出现一个更加简洁的方法。</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws9da">10.8.<span class="_ _5"> </span>8.8 <span class="ff1 ws7da">子类中扩展 </span><span class="wsaa1">p<span class="_ _c"></span>rop<span class="_ _0"></span>ert<span class="_ _c"></span>y 250</span></div><a class="l" href="http://bugs.python.org/issue14965"><div class="d m1" style="border-style:none;position:absolute;left:543.877500px;bottom:262.885500px;width:109.056000px;height:16.821000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
