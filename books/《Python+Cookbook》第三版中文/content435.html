<div id="pf1b3" class="pf w0 h0" data-page-no="1b3"><div class="pc pc1b3 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg1b3.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x16 hf y1ab ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws208">_data[name] </span><span class="ls33">=</span><span class="fc0">value</span></span></div><div class="t m0 x15 hf y1ad ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">delete<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, name):</span></span></span></div><div class="t m0 x16 hf y1ae ff7 fs5 fca sc0 ls0 ws139">del <span class="ff8 ws13a">self<span class="fc6">.<span class="fc0">_data[name]</span></span></span></div><div class="t m0 x15 hf y1b0 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">exists<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, name):</span></span></span></div><div class="t m0 x16 hf y355 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13c">name </span><span class="ws157">in <span class="ff8 ws13a">self<span class="fc6">.<span class="fc0">_data</span></span></span></span></div><div class="t m0 x15 hf y411 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">keys<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf yba ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">list<span class="fc0 ls34">(</span>self<span class="fc6 ls34">.</span><span class="fc0">_data)</span></span></div><div class="t m0 x15 hf ybed ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">serve_forever<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf ybee ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">_serv</span><span class="ls34">.</span><span class="fc0">serve_forever()</span></span></div><div class="t m0 x5 hf ybf0 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws16d">__name__ <span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">__main__<span class="ff9 ls34">&apos;</span></span></span>:</span></div><div class="t m0 x15 hf yd7d ff8 fs5 fc0 sc0 ls0 ws13a">KEYFILE<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">server_key.pem<span class="ff9 ls1ee">&apos;</span><span class="ffa fcd ws4"># Private key of the server</span></span></div><div class="t m0 x15 hf ybf1 ff8 fs5 fc0 sc0 ls0 ws13a">CERTFILE<span class="fc6">=<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">server_cert.pem<span class="ff9 lscf">&apos;</span><span class="ffa fcd ws4"># Server certificate</span></span></span></div><div class="t m0 x15 hf ybf2 ff8 fs5 fc0 sc0 ls0 ws145">kvserv <span class="fc6 ls32">=</span><span class="ws13a">KeyValueServer((<span class="ff9 fc9 ls34">&apos;&apos;</span><span class="ls32">,</span><span class="fc7">15000</span>),</span></div><div class="t m0 x23 hf ybf3 ff8 fs5 fc0 sc0 ls0 ws13a">keyfile<span class="fc6 ls34">=</span>KEYFILE,</div><div class="t m0 x23 hf ybf4 ff8 fs5 fc0 sc0 ls0 ws13a">certfile<span class="fc6 ls34">=</span>CERTFILE),</div><div class="t m0 x15 hf ybf5 ff8 fs5 fc0 sc0 ls0 ws13a">kvserv<span class="fc6 ls34">.</span>serve_forever()</div><div class="t m0 x0 h9 y21f8 ff1 fs3 fc0 sc0 ls49 wsfd2">使用这个服务器时<span class="_ _1"></span>，你可以使用普通的 <span class="ff6 ls0 ws2f6">xmlrpc.client <span class="ff1 wsa0">模<span class="_ _6"></span>块<span class="_ _6"></span>来<span class="_ _6"></span>连<span class="_ _6"></span>接<span class="_ _6"></span>它。<span class="_ _6"></span>只<span class="_ _6"></span>需<span class="_ _6"></span>要<span class="_ _6"></span>在</span></span></div><div class="t m0 x5 h7 y2c18 ff4 fs3 fc0 sc0 ls0 ws30">URL <span class="ff1 ws38">中指定 <span class="ff6 wsfd3">https: </span>即可，例如：</span></div><div class="t m0 x5 hf y2c30 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc wsb44">xmlrpc.client </span><span class="ws146">import <span class="ff8 fc0">ServerProxy</span></span></span></div><div class="t m0 x5 hf y2c3d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0 ws13a">ServerProxy(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">https://localhost:15000<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, allow_none<span class="fc6 ls34">=</span></span><span class="fca">True</span>)</span></span></div><div class="t m0 x5 hf y2c31 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">set(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">foo</span>&apos;</span>,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">bar</span>&apos;<span class="ff8 fc0">)</span></span></div><div class="t m0 x5 hf y2c32 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">set(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">spam</span>&apos;</span><span class="ls0 ws13b">, [</span><span class="fc7">1</span><span class="ls32">,</span><span class="fc7">2</span><span class="ls32">,</span><span class="fc7">3</span><span class="ls0">])</span></span></div><div class="t m0 x5 hf y2c3e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">keys()</span></span></span></div><div class="t m0 x5 hf y2c33 ff8 fs5 fc8 sc0 ls34">[<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">spam</span><span class="ff9">&apos;</span><span class="ls33">,<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">foo</span></span><span class="ff9">&apos;</span><span class="ls0">]</span></div><div class="t m0 x5 hf y2c3f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">get(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">foo</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y2c34 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">bar<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y2c35 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">get(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">spam</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y2c36 ff8 fs5 fc8 sc0 ls0 ws4">[1, 2, 3]</div><div class="t m0 x5 hf y2c40 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">delete(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">spam</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y2c37 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">exists(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">spam</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y2c38 ff8 fs5 fc8 sc0 ls0">False</div><div class="t m0 x5 hf y2c41 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y2c42 ff1 fs3 fc0 sc0 ls0 wsfd4">对于 <span class="ff4 wsfd5">SSL </span><span class="ls2d ws132">客户端来讲<span class="_ _6"></span>一个比较复杂的问题是如何确认服务器证书或为服务器提供<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y2c43 ff1 fs3 fc0 sc0 ls0 wsa0">客<span class="_ _6"></span>户<span class="_ _6"></span>端<span class="_ _6"></span>认<span class="_ _6"></span>证<span class="_ _6"></span>（比<span class="_ _0"></span>如客<span class="_ _6"></span>户<span class="_ _0"></span>端证<span class="_ _6"></span>书）<span class="_ _f"></span>。<span class="_ _0"></span>不幸<span class="_ _6"></span>的<span class="_ _0"></span>是，暂<span class="_ _0"></span>时还<span class="_ _6"></span>没<span class="_ _0"></span>有一<span class="_ _6"></span>个<span class="_ _0"></span>标准<span class="_ _6"></span>方<span class="_ _0"></span>法来<span class="_ _6"></span>解<span class="_ _0"></span>决这<span class="_ _6"></span>个<span class="_ _0"></span>问</div><div class="t m0 x5 h7 y2c44 ff1 fs3 fc0 sc0 lsa8 ws730">题，需要自己去研究<span class="_ _c"></span>。不过，下面给出一个例子，用来建立一个安全的 <span class="ff4 ls0 wsfd6">XML-RPC <span class="ff1">连</span></span></div><div class="t m0 x5 h9 y2c45 ff1 fs3 fc0 sc0 ls0">接来确认服务器证书：</div><div class="t m0 x5 hf y2c46 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc wsb44">xmlrpc.client </span><span class="ws146">import <span class="ff8 fc0 ws13b">SafeTransport, ServerProxy</span></span></div><div class="t m0 x5 h10 y2c47 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">ssl</span></div><div class="t m0 x5 hf y2c48 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">VerifyCertSafeTransport<span class="ff8 fc0">(SafeTransport):</span></span></div><div class="t m0 x15 hf y2c49 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, cafile, certfile<span class="fc6 ls34">=</span></span><span class="fca">None</span><span class="ws13b">, keyfile</span><span class="fc6">=<span class="fca">None</span></span>):</span></span></div><div class="t m0 x16 hf y2c4a ff8 fs5 fc0 sc0 ls0 ws13a">SafeTransport<span class="fc6 ls34">.</span>__init__(<span class="fca">self</span>)</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsd97">13.10.<span class="_ _36"> </span>11.10 <span class="ff1 ws16b">在网络服务中加入 </span><span class="wsfc8">SSL 426</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
