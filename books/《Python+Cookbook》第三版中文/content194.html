<div id="pfc2" class="pf w0 h0" data-page-no="c2"><div class="pc pcc2 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgc2.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws135">8.6.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y236 ff1 fs3 fc0 sc0 ls0 ws601">使<span class="_ _6"></span>用 <span class="ff6 ws83a">xml.etree.ElementTree </span><span class="ls48 ws242">模块可以很容易的处理这些任务<span class="_ _1"></span>。第一步是以通常</span></div><div class="t m0 x5 h9 y237 ff1 fs3 fc0 sc0 ls0 ws14">的方式来解析这个文档。例如，假设你有一个名为 <span class="ff6 ws1f3">pred.xml </span>的文档，类似下面这样：</div><div class="t m0 x5 h11 y151d ffa fs5 fca sc0 ls0 ws4">&lt;?xml version=&quot;1.0&quot;?&gt;</div><div class="t m0 x5 h10 y151e ff7 fs5 fc10 sc0 ls0 ws156">&lt;stop&gt;</div><div class="t m0 x15 hf y151f ff7 fs5 fc10 sc0 ls0 ws156">&lt;id&gt;<span class="ff8 fc0 ws13a">14791</span>&lt;/id&gt;</div><div class="t m0 x15 hf y1520 ff7 fs5 fc10 sc0 ls0 ws156">&lt;nm&gt;<span class="ff8 fc0 ws15f">Clark </span><span class="fc11 ws83b">&amp;amp; <span class="ff8 fc0 ws13a">Balmoral</span></span>&lt;/nm&gt;</div><div class="t m0 x15 h10 y1521 ff7 fs5 fc10 sc0 ls0 ws156">&lt;sri&gt;</div><div class="t m0 x16 hf y1522 ff7 fs5 fc10 sc0 ls0 ws156">&lt;rt&gt;<span class="ff8 fc0 ws13a">22</span>&lt;/rt&gt;</div><div class="t m0 x16 hf y1523 ff7 fs5 fc10 sc0 ls0 ws156">&lt;d&gt;<span class="ff8 fc0 ws4">North Bound</span>&lt;/d&gt;</div><div class="t m0 x16 hf y1524 ff7 fs5 fc10 sc0 ls0 ws156">&lt;dd&gt;<span class="ff8 fc0 ws13b">North Bound</span>&lt;/dd&gt;</div><div class="t m0 x15 h10 y1525 ff7 fs5 fc10 sc0 ls0">&lt;/sri&gt;</div><div class="t m0 x15 hf y1526 ff7 fs5 fc10 sc0 ls0 ws156">&lt;cr&gt;<span class="ff8 fc0 ws13a">22</span>&lt;/cr&gt;</div><div class="t m0 x15 h10 y2d5 ff7 fs5 fc10 sc0 ls0 ws156">&lt;pre&gt;</div><div class="t m0 x16 hf y1527 ff7 fs5 fc10 sc0 ls0 ws156">&lt;pt&gt;<span class="ff8 fc0 ws13b">5 MIN</span>&lt;/pt&gt;</div><div class="t m0 x16 hf y1b5 ff7 fs5 fc10 sc0 ls0 ws156">&lt;fd&gt;<span class="ff8 fc0 ws13a">Howard</span>&lt;/fd&gt;</div><div class="t m0 x16 hf y1528 ff7 fs5 fc10 sc0 ls0 ws156">&lt;v&gt;<span class="ff8 fc0 ws13a">1378</span>&lt;/v&gt;</div><div class="t m0 x16 hf y1529 ff7 fs5 fc10 sc0 ls0 ws156">&lt;rn&gt;<span class="ff8 fc0 ws13a">22</span>&lt;/rn&gt;</div><div class="t m0 x15 h10 y152a ff7 fs5 fc10 sc0 ls0">&lt;/pre&gt;</div><div class="t m0 x15 h10 y152b ff7 fs5 fc10 sc0 ls0 ws156">&lt;pre&gt;</div><div class="t m0 x16 hf y152c ff7 fs5 fc10 sc0 ls0 ws156">&lt;pt&gt;<span class="ff8 fc0 ws13b">15 MIN</span>&lt;/pt&gt;</div><div class="t m0 x16 hf y152d ff7 fs5 fc10 sc0 ls0 ws156">&lt;fd&gt;<span class="ff8 fc0 ws13a">Howard</span>&lt;/fd&gt;</div><div class="t m0 x16 hf y152e ff7 fs5 fc10 sc0 ls0 ws156">&lt;v&gt;<span class="ff8 fc0 ws13a">1867</span>&lt;/v&gt;</div><div class="t m0 x16 hf y152f ff7 fs5 fc10 sc0 ls0 ws156">&lt;rn&gt;<span class="ff8 fc0 ws13a">22</span>&lt;/rn&gt;</div><div class="t m0 x15 h10 y1530 ff7 fs5 fc10 sc0 ls0">&lt;/pre&gt;</div><div class="t m0 x5 h10 y88 ff7 fs5 fc10 sc0 ls0">&lt;/stop&gt;</div><div class="t m0 x0 h9 y1531 ff1 fs3 fc0 sc0 ls0 ws38">下面是一个利用 <span class="ff6 ws1e2">ElementTree </span>来读取这个文档并对它做一些修改的例子：</div><div class="t m0 x5 hf y1532 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws7d9">xml.etree.ElementTree </span><span class="ws146">import <span class="ff8 fc0 ws13b">parse, Element</span></span></span></div><div class="t m0 x5 hf y1533 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws158">doc <span class="fc6 ls32">=</span><span class="ws13a">parse(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">pred.xml<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y1534 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">root <span class="fc6 ls32">=</span><span class="ws13a">doc<span class="fc6 ls34">.</span>getroot()</span></span></div><div class="t m0 x5 hf y1535 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">root</span></div><div class="t m0 x5 hf y1536 ff8 fs5 fc8 sc0 ls0 ws16d">&lt;Element <span class="ff9 ws13b">&apos;</span><span class="ws13a">stop<span class="ff9 ls33">&apos;</span><span class="ws13b">at 0x100770cb0&gt;</span></span></div><div class="t m0 x5 h11 y1537 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Remove a few elements</span></div><div class="t m0 x5 hf y1538 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">root<span class="fc6 ls34">.</span>remove(root<span class="fc6">.</span>find(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">sri<span class="ff9 ls34">&apos;</span></span>))</span></div><div class="t m0 x5 hf y1539 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">root<span class="fc6 ls34">.</span>remove(root<span class="fc6">.</span>find(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">cr<span class="ff9 ls34">&apos;</span></span>))</span></div><div class="t m0 x5 h11 y153a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Insert a new element after &lt;nm&gt;...&lt;/nm&gt;</span></div><div class="t m0 x5 hf y153b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">root<span class="fc6 ls34">.</span>getchildren()<span class="fc6 ls34">.</span>index(root<span class="fc6 ls34">.</span>find(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">nm<span class="ff9 ws13b">&apos;</span></span>))</span></div><div class="t m0 x5 hf y153c ff8 fs5 fc8 sc0 ls0">1</div><div class="t m0 x5 hf y153d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">e<span class="fc6 ls33">=</span><span class="ls0 ws13a">Element(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">spam<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y153e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">e<span class="fc6 ls0 ws13a">.<span class="fc0 ws13c">text </span><span class="ls32">=</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws4">This is a test<span class="ff9">&apos;</span></span></span></span></div><div class="t m0 x5 hf y153f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">root<span class="fc6 ls34">.</span>insert(<span class="fc7">2</span><span class="ws4">, e)</span></span></div><div class="t m0 x5 h11 y1540 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Write back to a file</span></div><div class="t m0 x5 hf y1541 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">doc<span class="fc6 ls34">.</span>write(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">newpred.xml<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, xml_declaration<span class="fc6 ls34">=</span></span><span class="fca">True</span>)</span></div><div class="t m0 x5 hf y1542 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y1543 ff1 fs3 fc0 sc0 ls0 ws14">处理结果是一个像下面这样新的 <span class="ff4 ws64">XML </span>文件：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">8.6.<span class="_ _5"> </span>6.6 <span class="ff1 ws7da">解析和修改 </span><span class="ws839">XML 185</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
