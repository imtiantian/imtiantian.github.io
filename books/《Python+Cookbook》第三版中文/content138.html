<div id="pf8a" class="pf w0 h0" data-page-no="8a"><div class="pc pc8a w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg8a.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws212">6.12.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y138 ff6 fs3 fc0 sc0 ls0 ws5d8">itertools.chain() <span class="ff1">接受一个或多个可迭代对象最为输入参数。然后创建一个迭代</span></div><div class="t m0 x5 h9 y139 ff1 fs3 fc0 sc0 ls13 wse5">器<span class="_ _1"></span>，依次连续的返回每个可迭代对象中的元素。这种方式要比先将序列合并再迭代要<span class="_ _c"></span></div><div class="t m0 x5 h9 y13a ff1 fs3 fc0 sc0 ls0">高效的多。比如：</div><div class="t m0 x5 h11 yf30 ffa fs5 fcd sc0 ls0 ws4"># Inefficent</div><div class="t m0 x5 hf yf31 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ls32">x</span><span class="ws160">in <span class="ff8 fc0 ls32">a<span class="fc6">+</span><span class="ls0">b:</span></span></span></div><div class="t m0 x15 hf yf32 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x5 h11 yf33 ffa fs5 fcd sc0 ls0 ws4"># Better</div><div class="t m0 x5 hf yf34 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ls32">x</span><span class="ws160">in <span class="ff8 fc0 ws13b">chain(a, b):</span></span></div><div class="t m0 x15 hf yf35 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h7 yf36 ff1 fs3 fc0 sc0 ls0 ws5da">第<span class="_ _0"></span>一<span class="_ _6"></span>种<span class="_ _0"></span>方<span class="_ _0"></span>案<span class="_ _6"></span>中， <span class="ff6 lsf4 ws5db">a+b<span class="_ _f"></span><span class="ff1 lsf5 ws5dc">操作会创建一个全新的序列并要求 <span class="ff4 lsf6">a</span><span class="lsf7">和<span class="ff4 lsf8">b</span><span class="ls0 wsa0">的<span class="_ _0"></span>类<span class="_ _0"></span>型<span class="_ _6"></span>一<span class="_ _0"></span>致。</span></span></span></span></div><div class="t m0 x5 h9 yf37 ff6 fs3 fc0 sc0 ls0 ws575">chian() <span class="ff1 ls14 ws174">不会有这一步<span class="_ _1"></span>，所以如果输入序列非常大的时候会很省内存<span class="_ _1"></span>。并且当可迭代<span class="_ _1"></span></span></div><div class="t m0 x5 h9 yf38 ff1 fs3 fc0 sc0 ls0 ws14">对象类型不一样的时候 <span class="ff6 ws472">chain() </span>同样可以很好的工作。</div><div class="t m0 x5 hd yf39 ff2 fs4 fc4 sc0 ls0 ws211">6.13<span class="_ _e"> </span>4.13 <span class="ff1">创建数据处理管道</span></div><div class="t m0 x5 he yf3a ff2 fs2 fc4 sc0 ls0 ws212">6.13.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 yf3b ff1 fs3 fc0 sc0 ls0 ws5dd">你想以数据管道 <span class="ff4 ls1b">(</span><span class="ws5de">类似 <span class="ff4 ws5df">Unix </span><span class="wsa0">管道<span class="ff4 lsf9">)</span>的方式迭代处理数据。比如，你有个大量的数据</span></span></div><div class="t m0 x5 h9 yf3c ff1 fs3 fc0 sc0 ls0">需要处理，但是不能将它们一次性放入内存中。</div><div class="t m0 x5 he yf3d ff2 fs2 fc4 sc0 ls0 ws212">6.13.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 yf3e ff1 fs3 fc0 sc0 ls3a ws153">生成器函数是一个实现管道机制的好办法。为了演示，假定你要处理一个非常大的</div><div class="t m0 x5 h9 yf3f ff1 fs3 fc0 sc0 ls0">日志文件目录：</div><div class="t m0 x5 hf yf40 ff8 fs5 fc0 sc0 ls0 ws13a">foo<span class="fc6">/</span></div><div class="t m0 x15 hf yf41 ff8 fs5 fc0 sc0 ls0 ws13a">access<span class="fc6 ls34">-</span>log<span class="fc6 ls34">-</span><span class="fc7">012007.</span>gz</div><div class="t m0 x15 hf yf42 ff8 fs5 fc0 sc0 ls0 ws13a">access<span class="fc6 ls34">-</span>log<span class="fc6 ls34">-</span><span class="fc7">022007.</span>gz</div><div class="t m0 x15 hf y1c ff8 fs5 fc0 sc0 ls0 ws13a">access<span class="fc6 ls34">-</span>log<span class="fc6 ls34">-</span><span class="fc7">032007.</span>gz</div><div class="t m0 x15 hf yc41 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x15 hf yf43 ff8 fs5 fc0 sc0 ls0 ws13a">access<span class="fc6 ls34">-</span>log<span class="fc6 ls34">-</span><span class="fc7">012008</span></div><div class="t m0 x5 hf yf44 ff8 fs5 fc0 sc0 ls0 ws13a">bar<span class="fc6">/</span></div><div class="t m0 x15 hf yf45 ff8 fs5 fc0 sc0 ls0 ws13a">access<span class="fc6 ls34">-</span>log<span class="fc6 ls34">-</span><span class="fc7">092007.</span>bz2</div><div class="t m0 x15 hf yf46 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x15 hf yf47 ff8 fs5 fc0 sc0 ls0 ws13a">access<span class="fc6 ls34">-</span>log<span class="fc6 ls34">-</span><span class="fc7">022008</span></div><div class="t m0 x0 h9 yf48 ff1 fs3 fc0 sc0 ls0">假设每个日志文件包含这样的数据：</div><div class="t m0 x5 hf y32f ff8 fs5 fc7 sc0 ls0 ws13a">124.115<span class="fc6 ls34">.</span><span class="ws161">6.12 <span class="fc6 ws23d">- - <span class="fc0 ls34">[</span></span></span>10<span class="fc6">/<span class="fc0">Jul</span><span class="ls34">/</span></span>2012<span class="fc0 ls34">:</span>00<span class="fc0 ls34">:</span>18<span class="fc0 ls34">:</span><span class="ws159">50 <span class="fc6 ls34">-</span></span>0500<span class="fc0 ls32">]</span><span class="fc9 ws4">&quot;GET /robots.txt ...&quot; </span><span class="ws158">200 71</span></div><div class="t m0 x5 hf y330 ff8 fs5 fc7 sc0 ls0 ws13a">210.212<span class="fc6 ls34">.</span><span class="ws145">209.67 <span class="fc6 ws23d">- - <span class="fc0 ls34">[</span></span></span>10<span class="fc6 ls34">/</span><span class="fc0">Jul<span class="fc6 ls34">/</span></span>2012<span class="fc0">:</span>00<span class="fc0">:</span>18<span class="fc0 ls34">:</span><span class="ws159">51 <span class="fc6 ls34">-</span></span>0500<span class="fc0 ls33">]</span><span class="fc9 ws13b">&quot;GET /ply/ ...&quot; </span><span class="ws15b">200 11875</span></div><div class="t m0 x5 hf y331 ff8 fs5 fc7 sc0 ls0 ws13a">210.212<span class="fc6 ls34">.</span><span class="ws145">209.67 <span class="fc6 ws23d">- - <span class="fc0 ls34">[</span></span></span>10<span class="fc6 ls34">/</span><span class="fc0">Jul<span class="fc6 ls34">/</span></span>2012<span class="fc0">:</span>00<span class="fc0">:</span>18<span class="fc0 ls34">:</span><span class="ws159">51 <span class="fc6 ls34">-</span></span>0500<span class="fc0 ls33">]</span><span class="fc9 ws13b">&quot;GET /favicon.ico ...&quot; </span><span class="ws158">404 369</span></div><div class="t m0 x5 hf y332 ff8 fs5 fc7 sc0 ls0 ws13a">61.135<span class="fc6 ls34">.</span><span class="ws155">216.105 <span class="fc6 ws23d">- - <span class="fc0 ls34">[</span></span></span>10<span class="fc6 ls34">/</span><span class="fc0">Jul<span class="fc6 ls34">/</span></span>2012<span class="fc0">:</span>00<span class="fc0">:</span>20<span class="fc0 ls34">:</span><span class="ws159">04 <span class="fc6 ls34">-</span></span>0500<span class="fc0 ls33">]</span><span class="fc9 ws13b">&quot;GET /blog/atom.xml ...&quot; </span><span class="ws158">304 <span class="fc6">-</span></span></div><div class="t m0 x5 hf y333 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">6.13.<span class="_ _5"> </span>4.13 <span class="ff1 ws533">创建数据处理管道 </span>129</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
