<div id="pf14b" class="pf w0 h0" data-page-no="14b"><div class="pc pc14b w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg14b.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h7 y2a ff1 fs3 fc0 sc0 ls0 wsc0d">而<span class="_ _6"></span>是创<span class="_ _6"></span>建<span class="_ _6"></span>特<span class="_ _6"></span>殊<span class="_ _6"></span>的描<span class="_ _6"></span>述<span class="_ _6"></span>器<span class="_ _6"></span>对象 <span class="ff4 ls1b">(</span><span class="wsc0e">参<span class="_ _6"></span>考 <span class="ff4 ws664">8.9 </span><span class="wsa0">小<span class="_ _6"></span>节<span class="ff4 ls1b">)</span>。<span class="_ _6"></span>因<span class="_ _6"></span>此当<span class="_ _6"></span>你<span class="_ _6"></span>试<span class="_ _6"></span>着<span class="_ _6"></span>在其<span class="_ _6"></span>他<span class="_ _6"></span>装<span class="_ _6"></span>饰<span class="_ _6"></span>器中<span class="_ _6"></span>将<span class="_ _6"></span>它<span class="_ _6"></span>们<span class="_ _6"></span>当</span></span></div><div class="t m0 x5 h9 y2b ff1 fs3 fc0 sc0 ls2d ws132">做函数来使用时就会出错。确保这种装饰器出现在装饰器链中的第一个位置可以修复<span class="_ _1"></span></div><div class="t m0 x5 h9 y2c ff1 fs3 fc0 sc0 ls0">这个问题。</div><div class="t m0 x0 h7 y99 ff1 fs3 fc0 sc0 ls2c wsc0f">当我们在抽象基类中定义类方法和静态方法 <span class="ff4 ls1b">(</span><span class="ls0 ws3c3">参考 <span class="ff4 wsc10">8.12 </span><span class="wsa0">小节<span class="ff4 lsa6">)</span></span></span><span class="ws12f">时，这里讲到的知识</span></div><div class="t m0 x5 h9 y9a ff1 fs3 fc0 sc0 ls0">就很有用了。例如，如果你想定义一个抽象类方法，可以使用类似下面的代码：</div><div class="t m0 x5 hf y22a5 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws139">abc </span><span class="ws146">import <span class="ff8 fc0 ws13b">ABCMeta, abstractmethod</span></span></div><div class="t m0 x5 hf y22a6 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ls34">A</span><span class="ff8 fc0 ws13a">(metaclass<span class="fc6 ls34">=</span>ABCMeta):</span></div><div class="t m0 x15 h10 y17ef ff7 fs5 fc12 sc0 ls0">@classmethod</div><div class="t m0 x15 h10 y22a7 ff7 fs5 fc12 sc0 ls0">@abstractmethod</div><div class="t m0 x15 hf y22a8 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">method<span class="fc0">(cls):</span></span></div><div class="t m0 x16 h10 y22a9 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x0 h9 y22aa ff1 fs3 fc0 sc0 ls18 ws110">在这段代码中，<span class="ff6 ls0 ws69a">@classmethod </span><span class="lsc9">跟<span class="ff6 ls0 wsc11">@abstractmethod </span></span>两者的顺序是有讲究的，如果<span class="_ _1"></span></div><div class="t m0 x5 h9 y22ab ff1 fs3 fc0 sc0 ls0">你调换它们的顺序就会出错。</div><div class="t m0 x5 hd y22ac ff2 fs4 fc4 sc0 ls0 ws211">11.11<span class="_ _e"> </span>9.11 <span class="ff1">装饰器为被包装函数增加参数</span></div><div class="t m0 x5 he y22ad ff2 fs2 fc4 sc0 ls0 wsadf">11.11.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y22ae ff1 fs3 fc0 sc0 ls3a ws153">你想在装饰器中给被包装函数增加额外的参数，但是不能影响这个函数现有的调用</div><div class="t m0 x5 h9 y22af ff1 fs3 fc0 sc0 ls0">规则。</div><div class="t m0 x5 he y22b0 ff2 fs2 fc4 sc0 ls0 wsadf">11.11.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y22b1 ff1 fs3 fc0 sc0 ls0">可以使用关键字参数来给被包装函数增加额外参数。考虑下面的装饰器：</div><div class="t m0 x5 hf y22b2 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws285">functools </span><span class="ws146">import <span class="ff8 fc0">wraps</span></span></div><div class="t m0 x5 hf y22b3 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">optional_debug<span class="fc0">(func):</span></span></div><div class="t m0 x15 hf y22b4 ff7 fs5 fc12 sc0 ls0 ws156">@wraps<span class="ff8 fc0">(func)</span></div><div class="t m0 x15 hf y22b5 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">wrapper<span class="fc0 ls34">(</span><span class="fc6">*<span class="fc0 ws4">args, debug</span><span class="ls34">=</span><span class="fca">False<span class="fc0 ls32">,</span></span><span class="ls34">**</span><span class="fc0">kwargs):</span></span></span></div><div class="t m0 x16 hf y22b6 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0">debug:</span></div><div class="t m0 x17 hf y22b7 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Calling</span>&apos;</span><span class="ls0 ws13b">, func</span><span class="fc6">.</span><span class="ls0">__name__)</span></span></div><div class="t m0 x16 hf y22b8 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">func(<span class="fc6">*</span><span class="ws458">args, </span><span class="fc6">**</span>kwargs)</span></div><div class="t m0 x15 hf y22b9 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">wrapper</span></div><div class="t m0 x5 h10 y22ba ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fc12">@optional_debug</span></div><div class="t m0 x5 hf y22bb ff7 fs5 fc5 sc0 ls0 ws139">... <span class="fca">def <span class="ff8 fcb ws13a">spam<span class="fc0">(a,b,c):</span></span></span></div><div class="t m0 x5 hf y22bc ff7 fs5 fc5 sc0 ls0 ws139">... <span class="fca ws156">print<span class="ff8 fc0">(a,b,c)</span></span></div><div class="t m0 x5 h10 y22bd ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y22be ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam(<span class="fc7">1</span><span class="ls34">,<span class="fc7">2</span></span>,<span class="fc7 ls34">3</span>)</span></div><div class="t m0 x5 hf y22bf ff8 fs5 fc8 sc0 ls5e ws209">123<span class="_ _15"></span></div><div class="t m0 x5 hf y22c0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam(<span class="fc7">1</span><span class="ls34">,<span class="fc7">2</span></span>,<span class="fc7 ls34">3</span><span class="ws4">, debug<span class="fc6 ls34">=</span></span><span class="fca">True</span>)</span></div><div class="t m0 x5 hf y22c1 ff8 fs5 fc8 sc0 ls0 ws4">Calling spam</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">11.11.<span class="_ _5"> </span>9.11 <span class="ff1 wsb70">装饰器为被包装函数增加参数 </span>322</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
