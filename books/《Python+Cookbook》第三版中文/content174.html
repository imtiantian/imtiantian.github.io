<div id="pfae" class="pf w0 h0" data-page-no="ae"><div class="pc pcae w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgae.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h9 y2a ff6 fs3 fc0 sc0 ls0 ws73a">Serial() <span class="ff1 ws22b">传递一个 </span><span class="ws5c5">rtscts=True <span class="ff1 wsa0">的参数即可。其官方文档非常完善，因此我在这里极</span></span></div><div class="t m0 x5 h9 y2b ff1 fs3 fc0 sc0 ls0">力推荐这个包。</div><div class="t m0 x0 h7 y8dd ff1 fs3 fc0 sc0 ls48 ws73b">时刻记住所有涉及到串口的 <span class="ff4 ls0 ws73c">I/O </span><span class="ws242">都是二进制模式的。因此<span class="_ _c"></span>，确保你的代码使用的</span></div><div class="t m0 x5 h7 y99 ff1 fs3 fc0 sc0 ls68 ws73d">是字节而不是文本 <span class="ff4 ls1b">(</span><span class="ws23f">或有时候执行文本的编码<span class="ff4 ls6">/</span>解码操作<span class="ff4 ls1b">)</span>。另外当你需要创建二进制编</span></div><div class="t m0 x5 h9 y9a ff1 fs3 fc0 sc0 ls0 wsa0">码的指令或数据包的时候，<span class="ff6 ws25d">struct </span>模块也是非常有用的。</div><div class="t m0 x5 hd y12f3 ff2 fs4 fc4 sc0 ls0 ws211">7.21<span class="_ _e"> </span>5.21 <span class="ff1 ws357">序列化 </span><span class="ws73e">Python <span class="ff1">对象</span></span></div><div class="t m0 x5 he y12f4 ff2 fs2 fc4 sc0 ls0 ws212">7.21.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y12f5 ff1 fs3 fc0 sc0 ls0 ws73f">你需要<span class="_ _6"></span>将一个 <span class="ff4 wsf8">Python </span><span class="ls18 ws110">对象序列化为一个字节流，以便将它保存到一个文件、存储</span></div><div class="t m0 x5 h9 y12f6 ff1 fs3 fc0 sc0 ls0">到数据库或者通过网络传输它。</div><div class="t m0 x5 he y12f7 ff2 fs2 fc4 sc0 ls0 ws212">7.21.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y12f8 ff1 fs3 fc0 sc0 ls3d ws740">对于序列化最普遍的做法就是使用 <span class="ff6 ls0 ws20b">pickle <span class="ff1 wsa0">模块。<span class="_ _6"></span>为了将<span class="_ _6"></span>一个<span class="_ _6"></span>对象保<span class="_ _6"></span>存到<span class="_ _6"></span>一个文<span class="_ _6"></span>件</span></span></div><div class="t m0 x5 h9 y12f9 ff1 fs3 fc0 sc0 ls0">中，可以这样做：</div><div class="t m0 x5 h10 y478 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">pickle</span></div><div class="t m0 x5 hf y12fa ff8 fs5 fc0 sc0 ls0 ws13c">data <span class="fc6 ws23d">= ... <span class="ffa fcd ws4"># Some Python object</span></span></div><div class="t m0 x5 hf y12fb ff8 fs5 fc0 sc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open</span></span><span class="ls34">(<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">somefile</span><span class="ls34">&apos;</span></span></span>,<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">wb</span>&apos;</span><span class="ls0">)</span></div><div class="t m0 x5 hf y12fc ff8 fs5 fc0 sc0 ls0 ws13a">pickle<span class="fc6 ls34">.</span><span class="ws4">dump(data, f)</span></div><div class="t m0 x0 h9 y12fd ff1 fs3 fc0 sc0 ls0 ws14">为了将一个对象转储为一个字符串，可以使用 <span class="ff6 ws2dc">pickle.dumps() </span>：</div><div class="t m0 x5 hf y12fe ff8 fs5 fc0 sc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0 ws13a">pickle<span class="fc6 ls34">.</span>dumps(data)</span></div><div class="t m0 x0 h9 y12ff ff1 fs3 fc0 sc0 ls6b ws741">为了从字节流中恢复一个对象，使用 <span class="ff6 ls0 ws6c1">picle.load() </span><span class="ls124">或<span class="ff6 ls0 ws742">pickle.loads() <span class="ff1 wsa0">函数。比</span></span></span></div><div class="t m0 x5 h9 y1300 ff1 fs3 fc0 sc0 ls0">如：</div><div class="t m0 x5 h11 y1301 ffa fs5 fcd sc0 ls0 ws4"># Restore from a file</div><div class="t m0 x5 hf y1302 ff8 fs5 fc0 sc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open</span></span><span class="ls34">(<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">somefile</span><span class="ls34">&apos;</span></span></span>,<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">rb</span>&apos;</span><span class="ls0">)</span></div><div class="t m0 x5 hf y1303 ff8 fs5 fc0 sc0 ls0 ws13c">data <span class="fc6 ls32">=</span><span class="ws13a">pickle<span class="fc6 ls34">.</span>load(f)</span></div><div class="t m0 x5 h11 y1304 ffa fs5 fcd sc0 ls0 ws4"># Restore from a string</div><div class="t m0 x5 hf y1305 ff8 fs5 fc0 sc0 ls0 ws13c">data <span class="fc6 ls32">=</span><span class="ws13a">pickle<span class="fc6 ls34">.</span>loads(s)</span></div><div class="t m0 x5 he y1306 ff2 fs2 fc4 sc0 ls0 ws212">7.21.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y1307 ff1 fs3 fc0 sc0 ls0 wsa0">对于<span class="_ _6"></span>大<span class="_ _6"></span>多数<span class="_ _6"></span>应<span class="_ _6"></span>用程<span class="_ _6"></span>序<span class="_ _6"></span>来讲，<span class="_ _6"></span><span class="ff6 ws743">dump() </span><span class="ls125">和</span><span class="ff6 ws743">load() </span><span class="ls22 ws38f">函数的使用就是你有效使用 </span><span class="ff6">pickle</span></div><div class="t m0 x5 h7 y1308 ff1 fs3 fc0 sc0 ls0 ws744">模<span class="_ _6"></span>块<span class="_ _6"></span>所<span class="_ _6"></span>需<span class="_ _6"></span>的<span class="_ _6"></span>全<span class="_ _6"></span>部<span class="_ _6"></span>了。<span class="_ _6"></span>它<span class="_ _6"></span>可<span class="_ _6"></span>适<span class="_ _6"></span>用<span class="_ _6"></span>于<span class="_ _6"></span>绝<span class="_ _0"></span>大部<span class="_ _6"></span>分 <span class="ff4 ws745">Python </span><span class="wsa0">数<span class="_ _6"></span>据<span class="_ _6"></span>类<span class="_ _6"></span>型<span class="_ _0"></span>和用<span class="_ _6"></span>户<span class="_ _6"></span>自<span class="_ _6"></span>定<span class="_ _6"></span>义<span class="_ _6"></span>类<span class="_ _0"></span>的对<span class="_ _6"></span>象<span class="_ _6"></span>实</span></div><div class="t m0 x5 h7 y1309 ff1 fs3 fc0 sc0 ls17 wsf6">例。如果你碰到某个库可以让你在数据库中保存<span class="_ _1"></span><span class="ff4 ls6">/<span class="ff1 ls0 ws746">恢<span class="_ _6"></span>复 <span class="ff4 ws587">Python </span><span class="wsa0">对象<span class="_ _6"></span>或者<span class="_ _6"></span>是通<span class="_ _6"></span>过网<span class="_ _6"></span>络传</span></span></span></div><div class="t m0 x5 h9 y130a ff1 fs3 fc0 sc0 ls0 ws14">输对象的话，那么很有可能这个库的底层就使用了 <span class="ff6 ws25d">pickle </span>模块。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">7.21.<span class="_ _5"> </span>5.21 <span class="ff1 ws36c">序列化 </span><span class="ws747">Python <span class="ff1 ws748">对象 </span>165</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
