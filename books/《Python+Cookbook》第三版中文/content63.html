<div id="pf3f" class="pf w0 h0" data-page-no="3f"><div class="pc pc3f w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg3f.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hd y112 ff2 fs4 fc4 sc0 ls0 ws211">4.10<span class="_ _e"> </span>2.10 <span class="ff1 ws357">在正则式中使用 </span><span class="wsd3">Unico<span class="_ _6"></span>de</span></div><div class="t m0 x5 he y113 ff2 fs2 fc4 sc0 ls0 ws212">4.10.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y2b2 ff1 fs3 fc0 sc0 ls0 ws38">你正在使用正则表达式处理文本，但是关注的是 <span class="ff4 ws356">Unico<span class="_ _6"></span>de </span>字符处理。</div><div class="t m0 x5 he y2b3 ff2 fs2 fc4 sc0 ls0 ws212">4.10.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y2b4 ff1 fs3 fc0 sc0 ls35 ws358">默认情况下 <span class="ff6 ls0 ws359">re </span><span class="ws35a">模块已经对一些 <span class="ff4 ls0 ws35b">Unico<span class="_ _6"></span>de </span><span class="ws35c">字符类有了基本的支持。比如， <span class="ffd ls0 ws305">\\<span class="ff6 ls91">d</span><span class="ff1 wsa0">已经</span></span></span></span></div><div class="t m0 x5 h7 y6d2 ff1 fs3 fc0 sc0 ls0 ws38">匹配任意的 <span class="ff4 ws35d">unico<span class="_ _6"></span>de </span>数字字符了：</div><div class="t m0 x5 h10 y6d3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">re</span></span></div><div class="t m0 x5 hf y6d4 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws158">num <span class="fc6 ls32">=</span><span class="ws13a">re<span class="fc6">.</span>compile(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">\d+<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 h11 y6d5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws13b"># ASCII digits</span></div><div class="t m0 x5 hf y6d6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">num<span class="fc6 ls34">.</span>match(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">123<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y6d7 ff8 fs5 fc8 sc0 ls0 ws4">&lt;_sre.SRE_Match object at 0x1007d9ed0&gt;</div><div class="t m0 x5 h11 y6d8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws13b"># Arabic digits</span></div><div class="t m0 x5 hf y6d9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">num<span class="fc6 ls34">.</span>match(<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws156">\u0661\u0662\u0663<span class="ff9 ls34">&apos;</span><span class="ff8 fc0">)</span></span></div><div class="t m0 x5 hf y6da ff8 fs5 fc8 sc0 ls0 ws4">&lt;_sre.SRE_Match object at 0x101234030&gt;</div><div class="t m0 x5 hf y6db ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y6dc ff1 fs3 fc0 sc0 ls49 ws35e">如果你想在模式中包含指定的 <span class="ff4 ls0 ws35f">Unico<span class="_ _6"></span>de <span class="ff1 ws360">字<span class="_ _6"></span>符，<span class="_ _6"></span>你<span class="_ _6"></span>可<span class="_ _6"></span>以<span class="_ _6"></span>使<span class="_ _6"></span>用 </span><span class="ws361">Unico<span class="_ _6"></span>de </span></span><span class="ws1a6">字符对应的转<span class="_ _1"></span></span></div><div class="t m0 x5 h7 y6dd ff1 fs3 fc0 sc0 ls0 ws362">义序列 <span class="ff4 wsa5">(</span><span class="ws363">比如 <span class="ffd ls84">\</span><span class="ff6 ws364">uFFF </span>或者 <span class="ffd ls84">\</span><span class="ff6 ws365">UFFFFFFF <span class="ff4 ls1b">)</span></span><span class="wsa0">。<span class="_ _6"></span>比如，下面<span class="_ _6"></span>是一个匹配<span class="_ _6"></span>几个不同阿<span class="_ _6"></span>拉伯编码页</span></span></div><div class="t m0 x5 h9 y6de ff1 fs3 fc0 sc0 ls0">面中所有字符的正则表达式：</div><div class="t m0 x5 hf y6df ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">arabic <span class="fc6 ls32">=</span><span class="ws13a">re<span class="fc6 ls34">.</span>compile(<span class="ff9 fc9 ls34">&apos;<span class="ff8">[</span></span></span></span><span class="fc9 ws156">\u0600<span class="ff8 ls34">-</span>\u06ff\u0750<span class="ff8 ws13a">-</span>\u077f\u08a0<span class="ff8 ls34">-</span>\u08ff<span class="ff8 ws13a">]+<span class="ff9 ws13b">&apos;</span><span class="fc0">)</span></span></span></div><div class="t m0 x5 hf y6e0 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y6e1 ff1 fs3 fc0 sc0 ls63 ws21f">当执行匹配和搜索操作的时候<span class="_ _c"></span>，最好是先标准化并且清理所有文本为标准化格式<span class="_ _1"></span></div><div class="t m0 x5 h7 y6e2 ff4 fs3 fc0 sc0 ls0 wsa5">(<span class="ff1 ws366">参考 </span><span class="ws367">2.9 <span class="ff1 wsa0">小节</span></span>)<span class="ff1 ls3a ws153">。但是同样也应该注意一些特殊情况，比如在忽略大小写匹配和大小写</span></div><div class="t m0 x5 h9 y6e3 ff1 fs3 fc0 sc0 ls0">转换时的行为。</div><div class="t m0 x5 hf y6e4 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws158">pat <span class="fc6 ls32">=</span><span class="ws13a">re<span class="fc6">.</span>compile(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">stra<span class="ff7 ws156">\u00df</span><span class="ls34">e<span class="ff9">&apos;</span></span></span><span class="ws13b">, re</span><span class="fc6">.</span>IGNORECASE)</span></span></div><div class="t m0 x5 hf y6e5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">straße<span class="ff9">&apos;</span></span></span></span></span></div><div class="t m0 x5 hf y6e6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">pat<span class="fc6 ls34">.</span><span class="ws1f5">match(s) <span class="ffa fcd ws4"># Matches</span></span></span></div><div class="t m0 x5 hf y6e7 ff8 fs5 fc8 sc0 ls0 ws4">&lt;_sre.SRE_Match object at 0x10069d370&gt;</div><div class="t m0 x5 hf y6e8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">pat<span class="fc6 ls34">.</span>match(s<span class="fc6 ls34">.</span><span class="ws1f5">upper()) <span class="ffa fcd ws4"># Doesn<span class="ffb ls34">&apos;</span><span class="ws13b">t match</span></span></span></span></div><div class="t m0 x5 hf y6e9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0 ws155">upper() <span class="ffa fcd ws4"># Case folds</span></span></span></span></div><div class="t m0 x5 hf y12e ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">STRASSE<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y12f ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y6ea ff2 fs2 fc4 sc0 ls0 ws212">4.10.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 y6eb ff1 fs3 fc0 sc0 ls0 ws368">混合使用 <span class="ff4 ws369">Unico<span class="_ _6"></span>de </span><span class="wsa0">和正则表达式通常会让你抓狂。如果你真的打算这样做的话，<span class="_ _1"></span>最</span></div><div class="t m0 x5 h7 y6ec ff1 fs3 fc0 sc0 ls22 ws36a">好考虑下安装第三方正则式库，它们会为 <span class="ff4 ls0 ws36b">Unicode </span><span class="ws119">的大小写转换和其他大量有趣特性</span></div><div class="t m0 x5 h9 y6ed ff1 fs3 fc0 sc0 ls0">提供全面的支持，包括模糊匹配。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.10.<span class="_ _5"> </span>2.10 <span class="ff1 ws36c">在正则式中使用 </span><span class="ws36d">Unico<span class="_ _6"></span>de 54</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
