<div id="pf3a" class="pf w0 h0" data-page-no="3a"><div class="pc pc3a w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg3a.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13b">newtext, n <span class="fc6 ls32">=</span><span class="ws13a">datepat<span class="fc6 ls34">.</span>subn(<span class="fc9 ls34">r</span></span><span class="ff9 fc9">&apos;<span class="ff8 ws13a">\3-\1-\2</span><span class="ls34">&apos;</span></span>, text)</span></div><div class="t m0 x5 hf y1ac ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">newtext</span></div><div class="t m0 x5 hf y1ad ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws4">Today is 2012-11-27. PyCon starts 2013-3-13.<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y1ae ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">n</span></div><div class="t m0 x5 hf y1af ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 hf y1b0 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y638 ff2 fs2 fc4 sc0 ls0 ws135">4.5.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y639 ff1 fs3 fc0 sc0 ls49 ws313">关于正则表达式搜索和替换<span class="_ _1"></span>，上面演示的 <span class="ff6 ls0 ws1a5">sub() </span><span class="ws1a6">方法基本已经涵盖了所有<span class="_ _1"></span>。其实</span></div><div class="t m0 x5 h9 y63a ff1 fs3 fc0 sc0 ls0">最难的部分就是编写正则表达式模式，这个最好是留给作者自己去练习了。</div><div class="t m0 x5 hd y63b ff2 fs4 fc4 sc0 ls0 ws134">4.6<span class="_ _e"> </span>2.6 <span class="ff1">字符串忽略大小写的搜索替换</span></div><div class="t m0 x5 he y63c ff2 fs2 fc4 sc0 ls0 ws135">4.6.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y63d ff1 fs3 fc0 sc0 ls0">你需要以忽略大小写的方式搜索与替换文本字符串</div><div class="t m0 x5 he y63e ff2 fs2 fc4 sc0 ls0 ws135">4.6.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y63f ff1 fs3 fc0 sc0 ls87 ws314">为了在文本操作时忽略大小写<span class="_ _8"></span>，<span class="_ _6"></span>你需要在使用 <span class="ff6 ls0 ws315">re </span><span class="ws316">模块的时候给这些操作提供<span class="_ _8"></span></span></div><div class="t m0 x5 h9 y640 ff6 fs3 fc0 sc0 ls0 ws317">re.IGNORECASE <span class="ff1">标志参数。比如：</span></div><div class="t m0 x5 hf y641 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">text <span class="fc6 ls32">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws4">UPPER PYTHON, lower python, Mixed Python<span class="ff9">&apos;</span></span></span></div><div class="t m0 x5 hf y642 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">re<span class="fc6 ls34">.</span>findall(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">python<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, text, flags<span class="fc6 ls34">=</span></span>re<span class="fc6 ls34">.</span>IGNORECASE)</span></div><div class="t m0 x5 hf y643 ff8 fs5 fc8 sc0 ls34">[<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">PYTHON</span><span class="ff9">&apos;</span><span class="ls32">,</span><span class="ff9">&apos;</span><span class="ls0 ws13a">python</span><span class="ff9">&apos;</span><span class="ls32">,</span><span class="ff9">&apos;</span><span class="ls0 ws13a">Python</span><span class="ff9">&apos;</span><span class="ls0">]</span></div><div class="t m0 x5 hf y644 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">re<span class="fc6 ls34">.</span>sub(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">python<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">snake<span class="ff9 ws13b">&apos;</span></span><span class="ws4">, text, flags<span class="fc6 ls34">=</span></span>re<span class="fc6 ls34">.</span>IGNORECASE)</span></div><div class="t m0 x5 hf y645 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws4">UPPER snake, lower snake, Mixed snake<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y646 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y647 ff1 fs3 fc0 sc0 ls3a ws153">最后的那个例子揭示了一个小缺陷，替换字符串并不会自动跟被匹配字符串的大小</div><div class="t m0 x5 h9 y648 ff1 fs3 fc0 sc0 ls0">写保持一致。为了修复这个，你可能需要一个辅助函数，就像下面的这样：</div><div class="t m0 x5 hf y649 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">matchcase<span class="fc0">(word):</span></span></div><div class="t m0 x15 hf y64a ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">replace<span class="fc0">(m):</span></span></div><div class="t m0 x16 hf y64b ff8 fs5 fc0 sc0 ls0 ws161">text <span class="fc6 ls33">=</span><span class="ls34">m</span><span class="fc6 ws13a">.</span>group()</div><div class="t m0 x16 hf y64c ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws13a">text<span class="fc6 ls34">.</span>isupper():</span></div><div class="t m0 x17 hf y64d ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">word<span class="fc6">.</span>upper()</span></div><div class="t m0 x16 hf y64e ff7 fs5 fca sc0 ls0 ws218">elif <span class="ff8 fc0 ws13a">text<span class="fc6 ls34">.</span>islower():</span></div><div class="t m0 x17 hf y64f ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">word<span class="fc6">.</span>lower()</span></div><div class="t m0 x16 hf y650 ff7 fs5 fca sc0 ls0 ws218">elif <span class="ff8 fc0 ws13a">text[<span class="fc7 ls34">0<span class="fc0">]</span></span><span class="fc6">.</span>isupper():</span></div><div class="t m0 x17 hf y651 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws13a">word<span class="fc6">.</span>capitalize()</span></div><div class="t m0 x16 hf y652 ff7 fs5 fca sc0 ls0 ws156">else<span class="ff8 fc0">:</span></div><div class="t m0 x17 hf y653 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">word</span></div><div class="t m0 x15 hf y654 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">replace</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">4.6.<span class="_ _5"> </span>2.6 <span class="ff1 ws318">字符串忽略大小写的搜索替换 </span>49</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
