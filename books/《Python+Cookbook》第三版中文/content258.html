<div id="pf102" class="pf w0 h0" data-page-no="102"><div class="pc pc102 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg102.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h9 y2a ff1 fs3 fc0 sc0 ls2d ws132">获取这个方法的唯一途径是使用类变量而不是实例变量来访问它。这也是为什么我们<span class="_ _1"></span></div><div class="t m0 x5 h9 y2b ff1 fs3 fc0 sc0 ls0 ws38">要使用 <span class="ff6 wsab5">super(SubPerson,<span class="_ _11"> </span>SubPerson) </span>的原因。</div><div class="t m0 x0 h7 y8dd ff1 fs3 fc0 sc0 ls0 wsab6">如果你只想重定义其中一个方法，那只使用 <span class="ff4 wsab7">@prop<span class="_ _6"></span>ert<span class="_ _1"></span>y <span class="ff1 wsa0">本身是不够的。比如，下面</span></span></div><div class="t m0 x5 h9 y99 ff1 fs3 fc0 sc0 ls0">的代码就无法工作：</div><div class="t m0 x5 hf y1bf4 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">SubPerson<span class="ff8 fc0">(Person):</span></span></div><div class="t m0 x15 h11 y1bf5 ff7 fs5 fc12 sc0 ls0 wsab8">@property <span class="ffa fcd ws13b"># Doesn<span class="ffb ls34">&apos;</span>t work</span></div><div class="t m0 x15 hf y1bf6 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">name<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y1bf7 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Getting name<span class="ff9">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x16 hf y1bf8 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">super<span class="fc0">()<span class="fc6 ls34">.</span>name</span></span></div><div class="t m0 x0 h7 y1bf9 ff1 fs3 fc0 sc0 ls0 wsc">如果你试着运行会发现 <span class="ff4 ws963">setter </span>函数整个消失了：</div><div class="t m0 x5 hf yef6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0 ws13a">SubPerson(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Guido<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y1bfa ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y19e7 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x15 hf y1bfb ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;example.py&quot;</span><span class="ws145">, line <span class="fc7 ls34">5</span><span class="ls33">,</span><span class="ff7 fca ws157">in </span>__init__</span></div><div class="t m0 x16 hf y1bfc ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws13c">name </span><span class="ls33">=</span><span class="fc0">name</span></span></div><div class="t m0 x5 hf y1bfd ff8 fs5 fc2 sc0 ls0 ws13a">AttributeError<span class="fc0 ws4">: can<span class="ff9 ls34">&apos;</span><span class="ws13b">t set attribute</span></span></div><div class="t m0 x5 hf y1bfe ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1bff ff1 fs3 fc0 sc0 ls0">你应该像之前说过的那样修改代码：</div><div class="t m0 x5 hf y1c00 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">SubPerson<span class="ff8 fc0">(Person):</span></span></div><div class="t m0 x15 h10 y1c01 ff7 fs5 fc12 sc0 ls0">@Person.getter</div><div class="t m0 x15 hf y1c02 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">name<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y1c03 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Getting name<span class="ff9">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x16 hf y1c04 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">super<span class="fc0">()<span class="fc6 ls34">.</span>name</span></span></div><div class="t m0 x0 h7 y1c05 ff1 fs3 fc0 sc0 ls0 wsa0">这么<span class="_ _6"></span>写<span class="_ _6"></span>后，<span class="ff4 wsab9">prop<span class="_ _6"></span>erty </span><span class="ls12 wsaba">之前已经定义过的方法会被复制过来<span class="_ _1"></span>，而 <span class="ff4 ls0 wsabb">getter <span class="ff1 wsa0">函<span class="_ _6"></span>数被<span class="_ _6"></span>替换。</span></span></span></div><div class="t m0 x5 h9 yc1a ff1 fs3 fc0 sc0 ls0">然后它就能按照期望的工作了：</div><div class="t m0 x5 hf y1c06 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0 ws13a">SubPerson(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Guido<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y1c07 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">name</span></span></span></div><div class="t m0 x5 hf y1c08 ff8 fs5 fc8 sc0 ls0 ws4">Getting name</div><div class="t m0 x5 hf y1c09 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">Guido<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y13d1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0 ws13c">name </span><span class="ls32">=</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Larry<span class="ff9">&apos;</span></span></span></span></div><div class="t m0 x5 hf y1c0a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">name</span></span></span></div><div class="t m0 x5 hf y1c0b ff8 fs5 fc8 sc0 ls0 ws4">Getting name</div><div class="t m0 x5 hf y1c0c ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">Larry<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y1c0d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0 ws13c">name </span><span class="ls32">=</span><span class="fc7">42</span></span></span></div><div class="t m0 x5 hf y1c0e ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y1c0f ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x15 hf y1c10 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;example.py&quot;</span><span class="ws145">, line <span class="fc7 ws13a">16</span><span class="ls32">,</span><span class="ff7 fca ws157">in </span>name</span></div><div class="t m0 x16 hf y1c11 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Expected a string<span class="ff9 ws13b">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y1c12 ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ws4">: Expected a string</span></div><div class="t m0 x5 hf y1c13 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1c14 ff1 fs3 fc0 sc0 ls6d ws2a0">在这个特别的解决方案中<span class="_ _19"></span>，<span class="_ _6"></span>我们没办法使用更加通用的方式去替换硬编码的<span class="_ _19"></span></div><div class="t m0 x5 h7 y1c15 ff6 fs3 fc0 sc0 ls0 wsabc">Person <span class="ff1 ls7b wsabd">类名<span class="_ _8"></span>。如果你不知道到底是哪个基类定义了 <span class="ff4 ls0 wsa5">prop<span class="_ _6"></span>erty</span><span class="wsabe">，那你只能通过重新<span class="_ _8"></span></span></span></div><div class="t m0 x5 h7 y1c16 ff1 fs3 fc0 sc0 ls0 ws14">定义所有 <span class="ff4 wsaa2">prop<span class="_ _6"></span>ert<span class="_ _1"></span>y <span class="ff1 ws38">并使用 <span class="ff6 ws23a">super() </span>来将控制权传递给前面的实现。</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws9da">10.8.<span class="_ _5"> </span>8.8 <span class="ff1 ws7da">子类中扩展 </span><span class="wsaa1">p<span class="_ _c"></span>rop<span class="_ _0"></span>ert<span class="_ _c"></span>y 249</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
