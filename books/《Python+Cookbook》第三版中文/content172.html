<div id="pfac" class="pf w0 h0" data-page-no="ac"><div class="pc pcac w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgac.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 fc0 ws13a">NamedTemporaryFile(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">w+t<span class="ff9 ls34">&apos;</span></span><span class="ls33">)</span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y1ac ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">filename is:<span class="ff9 ws13b">&apos;</span><span class="fc0">, f</span></span><span class="fc6">.</span>name)</span></div><div class="t m0 x15 hf y1ad ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x5 h11 y1af ffa fs5 fcd sc0 ls0 ws4"># File automatically destroyed</div><div class="t m0 x0 h9 y25b ff1 fs3 fc0 sc0 ls0 ws719">这<span class="_ _6"></span>里，<span class="_ _0"></span>被<span class="_ _6"></span>打<span class="_ _0"></span>开<span class="_ _6"></span>文<span class="_ _0"></span>件<span class="_ _6"></span>的 <span class="ff6 ws71a">f.name </span><span class="ls60 ws3eb">属性包含了该临时文件的文件名<span class="_ _c"></span>。当你需要将文件<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y12be ff1 fs3 fc0 sc0 ls42 ws71b">名传递给其他代码来打开这个文件的时候，这个就很有用了<span class="_ _1"></span>。和 <span class="ff6 ls0 ws185">TemporaryFile() <span class="ff1">一</span></span></div><div class="t m0 x5 h9 y12bf ff1 fs3 fc0 sc0 ls1e ws111">样<span class="_ _1"></span>，结果文件关闭时会被自动删除掉<span class="_ _1"></span>。如果你不想这么做，可以传递一个关键字<span class="_ _1"></span>参数</div><div class="t m0 x5 h9 y12c0 ff6 fs3 fc0 sc0 ls0 ws1e2">delte=False <span class="ff1">即可。比如：</span></div><div class="t m0 x5 hf y12c1 ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 fc0 ws13a">NamedTemporaryFile(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">w+t<span class="ff9 ls34">&apos;</span></span><span class="ws4">, delete<span class="fc6 ls34">=</span></span><span class="fca">False</span><span class="ls33">)</span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y12c2 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">filename is:<span class="ff9 ws13b">&apos;</span><span class="fc0">, f</span></span><span class="fc6">.</span>name)</span></div><div class="t m0 x15 hf y12c3 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h9 y12c4 ff1 fs3 fc0 sc0 ls0 ws38">为了创建一个临时目录，可以使用 <span class="ff6 ws71c">tempfile.TemporaryDirectory() </span>。比如：</div><div class="t m0 x5 hf y12c5 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws248">tempfile </span><span class="ws146">import <span class="ff8 fc0">TemporaryDirectory</span></span></div><div class="t m0 x5 hf y12c6 ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 fc0 ws71d">TemporaryDirectory() </span><span class="ws157">as <span class="ff8 fc0">dirname:</span></span></div><div class="t m0 x15 hf y12c7 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">dirname is:<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, dirname)</span></span></div><div class="t m0 x15 h11 y12c8 ffa fs5 fcd sc0 ls0 ws4"># Use the directory</div><div class="t m0 x15 hf y12c9 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x5 h11 y12ca ffa fs5 fcd sc0 ls0 ws4"># Directory and all contents destroyed</div><div class="t m0 x5 he y12cb ff2 fs2 fc4 sc0 ls0 ws212">7.19.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y12cc ff6 fs3 fc0 sc0 ls0 ws71e">TemporaryFile() <span class="ff1 ls120">、</span><span class="ws71f">NamedTemporaryFile() <span class="ff1 ls121">和</span>TemporaryDirectory() <span class="ff1 wsa0">函<span class="_ _6"></span>数<span class="_ _0"></span>应<span class="_ _6"></span>该</span></span></div><div class="t m0 x5 h9 y12cd ff1 fs3 fc0 sc0 ls0 wsa0">是处理<span class="_ _6"></span>临时文<span class="_ _6"></span>件目录<span class="_ _6"></span>的最简单<span class="_ _6"></span>的方式<span class="_ _6"></span>了，因为<span class="_ _6"></span>它们会<span class="_ _6"></span>自动处<span class="_ _6"></span>理所有<span class="_ _6"></span>的创建和<span class="_ _6"></span>清理步<span class="_ _6"></span>骤。</div><div class="t m0 x5 h9 y12ce ff1 fs3 fc0 sc0 ls51 ws720">在一个更低的级别，你可以使用 <span class="ff6 ls0 ws721">mkstemp() </span><span class="ls122">和<span class="ff6 ls0 ws721">mkdtemp() </span></span><span class="ws1c8">来创建临时文件和目录。比</span></div><div class="t m0 x5 h9 y12cf ff1 fs3 fc0 sc0 ls0">如：</div><div class="t m0 x5 h10 y10dc ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">tempfile</span></span></div><div class="t m0 x5 hf y12d0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">tempfile<span class="fc6">.</span>mkstemp()</span></div><div class="t m0 x5 hf y12d1 ff8 fs5 fc8 sc0 ls0 ws158">(3, <span class="ff9 ls34">&apos;</span><span class="ws13a">/var/folders/7W/7WZl5sfZEF0pljrEB1UMWE+++TI/-Tmp-/tmp7fefhv<span class="ff9 ws13b">&apos;</span>)</span></div><div class="t m0 x5 hf y12d2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">tempfile<span class="fc6">.</span>mkdtemp()</span></div><div class="t m0 x5 hf y12d3 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">/var/folders/7W/7WZl5sfZEF0pljrEB1UMWE+++TI/-Tmp-/tmp5wvcv6<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y12d4 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y12d5 ff1 fs3 fc0 sc0 ls6f ws722">但是<span class="_ _1"></span>，这些函数并不会做进一步的管理了<span class="_ _1"></span>。例如<span class="_ _1"></span>，函数 <span class="ff6 ls0 ws418">mkstemp() </span><span class="ws2a7">仅仅就返回一<span class="_ _1"></span></span></div><div class="t m0 x5 h7 y12d6 ff1 fs3 fc0 sc0 ls0 ws723">个<span class="_ _6"></span>原始<span class="_ _6"></span>的 <span class="ff4 ws724">OS </span><span class="ls1e ws111">文件描述符，你需要自己将它转换为一个真正的文件对象<span class="_ _c"></span>。同样你还需</span></div><div class="t m0 x5 h9 y12d7 ff1 fs3 fc0 sc0 ls0">要自己清理这些文件。</div><div class="t m0 x0 h9 y12d8 ff1 fs3 fc0 sc0 ls3d ws725">通常来讲，临时文件在系统默认的位置被创建<span class="_ _1"></span>，比如 <span class="ff6 ls0 ws726">/var/<span class="_ _6"></span>tmp </span><span class="ws164">或类似的地方。为<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y12d9 ff1 fs3 fc0 sc0 ls0 ws38">了获取真实的位置，可以使用 <span class="ff6 ws727">tempfile.gettempdir() </span>函数。比如：</div><div class="t m0 x5 hf y12da ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">tempfile<span class="fc6">.</span>gettempdir()</span></div><div class="t m0 x5 hf y12db ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">/var/folders/7W/7WZl5sfZEF0pljrEB1UMWE+++TI/-Tmp-<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y12dc ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">7.19.<span class="_ _5"> </span>5.19 <span class="ff1 ws509">创建临时文件和文件夹 </span>163</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
