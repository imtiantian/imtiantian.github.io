<div id="pf11d" class="pf w0 h0" data-page-no="11d"><div class="pc pc11d w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg11d.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x16 hf y181 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws13c">year </span><span class="ls33">=</span><span class="fc0">year</span></span></div><div class="t m0 x16 hf y182 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws458">month </span><span class="ls32">=</span><span class="fc0">month</span></span></div><div class="t m0 x16 hf y183 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws158">day </span><span class="ls33">=</span><span class="fc0">day</span></span></div><div class="t m0 x0 h7 y1e53 ff1 fs3 fc0 sc0 ls0 ws911">下面演示如何不调用 <span class="ff6 ws308">init<span class="_ _e"> </span>() </span><span class="ws63">方法来创建这个 <span class="ff4 wsb30">Date </span>实例：</span></div><div class="t m0 x5 hf y1e54 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0 ws13a">Date<span class="fc6">.</span>__new__(Date)</span></span></div><div class="t m0 x5 hf y1e55 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">d</span></div><div class="t m0 x5 hf y1e56 ff8 fs5 fc8 sc0 ls0 ws4">&lt;__main__.Date object at 0x1006716d0&gt;</div><div class="t m0 x5 hf y1e57 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">d<span class="fc6 ls0 ws13a">.<span class="fc0">year</span></span></span></div><div class="t m0 x5 hf y1e58 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y1e59 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x5 hf y1e5a ff8 fs5 fc2 sc0 ls0 ws13a">AttributeError<span class="fc0 ls33">:<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0">Date</span><span class="ff9">&apos;</span><span class="ls0 ws4">object has no attribute <span class="ff9 ls34">&apos;</span><span class="ws13a">year<span class="ff9">&apos;</span></span></span></span></div><div class="t m0 x5 hf y1835 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y1e5b ff1 fs3 fc0 sc0 ls0 ws38">结果可以看到，这个 <span class="ff4 wsb30">Date </span><span class="ws63">实例的属性 <span class="ff4 wsb31">y<span class="_ _1"></span>ear <span class="ff1">还不存在，所以你需要手动初始化：</span></span></span></div><div class="t m0 x5 hf y1e5c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">data <span class="fc6 ls32">=</span><span class="ls34">{</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">year</span><span class="ls34">&apos;</span></span><span class="ls34">:</span><span class="fc7 ws13a">2012</span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">month<span class="ff9 ws13b">&apos;</span></span><span class="ls34">:<span class="fc7">8</span><span class="ls32">,</span><span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13a">day<span class="ff9 ls34">&apos;</span></span><span class="ls34">:</span><span class="fc7 ws13a">29</span>}</span></div><div class="t m0 x5 hf y1e5d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ws13b">key, value </span><span class="ws157">in <span class="ff8 fc0 ws13a">data<span class="fc6 ls34">.</span>items():</span></span></span></div><div class="t m0 x5 hf y1e5e ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fca ws13a">setattr<span class="fc0 ws13b">(d, key, value)</span></span></div><div class="t m0 x5 h10 y1e5f ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y1e60 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">d<span class="fc6 ls0 ws13a">.<span class="fc0">year</span></span></span></div><div class="t m0 x5 hf y1e61 ff8 fs5 fc8 sc0 ls0">2012</div><div class="t m0 x5 hf y1e62 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">d<span class="fc6 ls0 ws13a">.<span class="fc0">month</span></span></span></div><div class="t m0 x5 hf y1e63 ff8 fs5 fc8 sc0 ls0">8</div><div class="t m0 x5 hf y1e64 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y1e65 ff2 fs2 fc4 sc0 ls0 wsadf">10.17.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y1e66 ff1 fs3 fc0 sc0 lsa5 wsb32">当我们在反序列对象或者实现某个类方法构造函数时需要绕过 <span class="ff6 ls0 ws590">init<span class="_ _e"> </span>() </span><span class="ls6f ws2a7">方法来<span class="_ _c"></span></span></div><div class="t m0 x5 h7 y1e67 ff1 fs3 fc0 sc0 ls1f ws932">创建对象。例如，对于上面的 <span class="ff4 ls0 wsb33">Date </span><span class="ws113">来来讲，有时候你可能会像下面这样定义一个新的</span></div><div class="t m0 x5 h9 y1e68 ff1 fs3 fc0 sc0 ls0 ws14">构造函数 <span class="ff6 ws472">today() </span>：</div><div class="t m0 x5 hf y1e69 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws218">time </span><span class="ws146">import <span class="ff8 fc0">localtime</span></span></div><div class="t m0 x5 hf y1e6a ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Date<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf y1e6b ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, year, month, day):</span></span></span></div><div class="t m0 x16 hf y1e6c ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws13c">year </span><span class="ls33">=</span><span class="fc0">year</span></span></div><div class="t m0 x16 hf y1e6d ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws458">month </span><span class="ls32">=</span><span class="fc0">month</span></span></div><div class="t m0 x16 hf y1e6e ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws158">day </span><span class="ls33">=</span><span class="fc0">day</span></span></div><div class="t m0 x15 h10 y1e6f ff7 fs5 fc12 sc0 ls0">@classmethod</div><div class="t m0 x15 hf y1e70 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">today<span class="fc0">(cls):</span></span></div><div class="t m0 x16 hf y1e71 ff8 fs5 fc0 sc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0 ws13a">cls<span class="fc6 ls34">.</span>__new__(cls)</span></div><div class="t m0 x16 hf y1e72 ff8 fs5 fc0 sc0 ls32">t<span class="fc6 ls33">=</span><span class="ls0">localtime()</span></div><div class="t m0 x16 hf y1307 ff8 fs5 fc0 sc0 ls34">d<span class="fc6 ls0 ws13a">.</span><span class="ls0 ws13c">year <span class="fc6 ls32">=</span></span>t<span class="fc6">.</span><span class="ls0">tm_year</span></div><div class="t m0 x16 hf y1e73 ff8 fs5 fc0 sc0 ls34">d<span class="fc6 ls0 ws13a">.</span><span class="ls0 ws458">month <span class="fc6 ls32">=</span></span>t<span class="fc6">.</span><span class="ls0">tm_mon</span></div><div class="t m0 x16 hf y1e74 ff8 fs5 fc0 sc0 ls34">d<span class="fc6 ls0 ws13a">.</span><span class="ls0 ws158">day <span class="fc6 ls33">=</span><span class="ws13a">t</span></span><span class="fc6">.</span><span class="ls0">tm_mday</span></div><div class="t m0 x16 hf y1e75 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">d</span></div><div class="t m0 x0 h7 y674 ff1 fs3 fc0 sc0 ls0 ws38">同样，在你反序列化 <span class="ff4 ws5f">JSON </span>数据时产生一个如下的字典对象：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">10.17.<span class="_ _5"> </span>8.17 <span class="ff1 ws7da">创建不调用 </span><span class="wsb2e">init <span class="ff1 wsb2f">方法的实例 </span>276</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
