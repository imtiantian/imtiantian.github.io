<div id="pf96" class="pf w0 h0" data-page-no="96"><div class="pc pc96 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg96.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h7 y2a ff1 fs3 fc0 sc0 ls0 ws14">对象 <span class="ff4 wsa5">(</span><span class="wsa0">比如字节字符串，字节数组对象等<span class="ff4 ls1b">)</span>。</span></div><div class="t m0 x5 he y1064 ff2 fs2 fc4 sc0 ls0 ws135">7.4.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y1065 ff1 fs3 fc0 sc0 ls3a ws153">在读取二进制数据的时候，字节字符串和文本字符串的语义差异可能会导致一个潜</div><div class="t m0 x5 h9 y1066 ff1 fs3 fc0 sc0 ls18 ws110">在的陷阱。特别需要注意的是<span class="_ _1"></span>，索引和迭代动作返回的是字节的值而不是字节字符串。</div><div class="t m0 x5 h9 y1067 ff1 fs3 fc0 sc0 ls0">比如：</div><div class="t m0 x5 h11 y1068 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws13b"># Text string</span></div><div class="t m0 x5 hf y1069 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">t<span class="fc6 ls33">=<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13b">Hello World<span class="ff9">&apos;</span></span></span></span></span></div><div class="t m0 x5 hf y106a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">t[<span class="fc7 ls34">0</span>]</span></div><div class="t m0 x5 hf y106b ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">H<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y106c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">c</span><span class="ws157">in <span class="ff8 fc0">t:</span></span></span></div><div class="t m0 x5 hf y106d ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(c)</span></span></div><div class="t m0 x5 h10 y106e ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y106f ff8 fs5 fc8 sc0 ls0">H</div><div class="t m0 x5 hf y1070 ff8 fs5 fc8 sc0 ls0">e</div><div class="t m0 x5 hf y1071 ff8 fs5 fc8 sc0 ls0">l</div><div class="t m0 x5 hf y1072 ff8 fs5 fc8 sc0 ls0">l</div><div class="t m0 x5 hf y1073 ff8 fs5 fc8 sc0 ls0">o</div><div class="t m0 x5 h10 y1074 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 h11 y1075 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws13b"># Byte string</span></div><div class="t m0 x5 hf y1076 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=</span><span class="ls34">b</span></span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Hello World</span>&apos;</span></div><div class="t m0 x5 hf y1077 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">b[<span class="fc7 ls34">0</span>]</span></div><div class="t m0 x5 hf y1078 ff8 fs5 fc8 sc0 ls0">72</div><div class="t m0 x5 hf y1079 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">c</span><span class="ws157">in <span class="ff8 fc0">b:</span></span></span></div><div class="t m0 x5 hf y107a ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(c)</span></span></div><div class="t m0 x5 h10 y107b ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y107c ff8 fs5 fc8 sc0 ls0">72</div><div class="t m0 x5 hf y107d ff8 fs5 fc8 sc0 ls0">101</div><div class="t m0 x5 hf y107e ff8 fs5 fc8 sc0 ls0">108</div><div class="t m0 x5 hf y107f ff8 fs5 fc8 sc0 ls0">108</div><div class="t m0 x5 hf y1080 ff8 fs5 fc8 sc0 ls0">111</div><div class="t m0 x5 h10 y1081 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y1082 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1083 ff1 fs3 fc0 sc0 ls3a ws153">如果你想从二进制模式的文件中读取或写入文本数据，必须确保要进行解码和编码</div><div class="t m0 x5 h9 y1084 ff1 fs3 fc0 sc0 ls0">操作。比如：</div><div class="t m0 x5 hf y1085 ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">somefile.bin<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">rb<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y1086 ff8 fs5 fc0 sc0 ls0 ws13c">data <span class="fc6 ls32">=</span><span class="ls34">f</span><span class="fc6 ws13a">.<span class="fc0">read(<span class="fc7">16</span>)</span></span></div><div class="t m0 x15 hf y1087 ff8 fs5 fc0 sc0 ls0 ws13c">text <span class="fc6 ls32">=</span><span class="ws13a">data<span class="fc6 ls34">.</span>decode(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">utf-8<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y1088 ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">somefile.bin<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">wb<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y1089 ff8 fs5 fc0 sc0 ls0 ws13c">text <span class="fc6 ls32">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13b">Hello World<span class="ff9">&apos;</span></span></div><div class="t m0 x15 hf y108a ff8 fs5 fc0 sc0 ls34">f<span class="fc6 ls0 ws13a">.<span class="fc0">write(text</span>.<span class="fc0">encode(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">utf-8</span>&apos;</span><span class="ls0">))</span></div><div class="t m0 x0 h7 y108b ff1 fs3 fc0 sc0 ls0 ws65e">二进<span class="_ _6"></span>制 <span class="ff4 ws65f">I/O </span><span class="ls42 ws660">还有一个鲜为人知的特性就是数组和 <span class="ff4 ls108">C</span><span class="ws186">结构体类型能直接被写入，而</span></span></div><div class="t m0 x5 h9 y108c ff1 fs3 fc0 sc0 ls0">不需要中间转换为自己对象。比如：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">7.4.<span class="_ _5"> </span>5.4 <span class="ff1 ws64b">读写字节数据 </span>141</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
