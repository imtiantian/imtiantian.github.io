<div id="pf7e" class="pf w0 h0" data-page-no="7e"><div class="pc pc7e w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg7e.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y432 ff8 fs5 fc8 sc0 ls0">4</div><div class="t m0 x5 hf y433 ff8 fs5 fc8 sc0 ls0">3</div><div class="t m0 x5 hf y434 ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 hf yde6 ff8 fs5 fc8 sc0 ls0">1</div><div class="t m0 x0 h9 yde7 ff1 fs3 fc0 sc0 ls0 ws58f">反<span class="_ _6"></span>向<span class="_ _6"></span>迭<span class="_ _6"></span>代<span class="_ _6"></span>仅<span class="_ _6"></span>仅<span class="_ _6"></span>当<span class="_ _6"></span>对<span class="_ _6"></span>象<span class="_ _6"></span>的<span class="_ _6"></span>大<span class="_ _6"></span>小<span class="_ _6"></span>可<span class="_ _6"></span>预<span class="_ _0"></span>先确<span class="_ _6"></span>定<span class="_ _6"></span>或<span class="_ _6"></span>者<span class="_ _6"></span>对<span class="_ _6"></span>象<span class="_ _0"></span>实现<span class="_ _6"></span>了 <span class="ff6 ws590">reversed<span class="_ _e"> </span>() </span><span class="wsa0">的<span class="_ _6"></span>特<span class="_ _6"></span>殊<span class="_ _6"></span>方</span></div><div class="t m0 x5 h9 yde8 ff1 fs3 fc0 sc0 ls0">法时才能生效。如果两者都不符合，那你必须先将对象转换为一个列表才行，比如：</div><div class="t m0 x5 h11 yde9 ffa fs5 fcd sc0 ls0 ws4"># Print a file backwards</div><div class="t m0 x5 hf ydea ff8 fs5 fc0 sc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open</span></span><span class="ls34">(<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">somefile</span><span class="ls34">&apos;</span></span><span class="ls0">)</span></span></div><div class="t m0 x5 hf ydeb ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13c">line </span><span class="ws157">in <span class="ff8 ws13a">reversed<span class="fc0">(</span>list<span class="fc0">(f)):</span></span></span></div><div class="t m0 x15 hf ydec ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13b">(line, end<span class="fc6 ls34">=</span><span class="ff9 fc9">&apos;&apos;</span>)</span></div><div class="t m0 x0 h9 yded ff1 fs3 fc0 sc0 ls3a ws153">要注意的是如果可迭代对象元素很多的话，将其预先转换为一个列表要消耗大量的</div><div class="t m0 x5 h9 ydee ff1 fs3 fc0 sc0 ls0">内存。</div><div class="t m0 x5 he ydef ff2 fs2 fc4 sc0 ls0 ws135">6.5.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 ydf0 ff1 fs3 fc0 sc0 ls0 ws591">很<span class="_ _6"></span>多<span class="_ _6"></span>程<span class="_ _6"></span>序<span class="_ _6"></span>员<span class="_ _6"></span>并<span class="_ _6"></span>不<span class="_ _6"></span>知<span class="_ _6"></span>道<span class="_ _6"></span>可<span class="_ _6"></span>以<span class="_ _6"></span>通<span class="_ _6"></span>过<span class="_ _6"></span>在<span class="_ _0"></span>自定<span class="_ _6"></span>义<span class="_ _6"></span>类<span class="_ _6"></span>上<span class="_ _6"></span>实<span class="_ _6"></span>现 <span class="ff6 ws590">reversed<span class="_ _e"> </span>() </span><span class="wsa0">方<span class="_ _0"></span>法来<span class="_ _6"></span>实<span class="_ _6"></span>现<span class="_ _6"></span>反<span class="_ _6"></span>向</span></div><div class="t m0 x5 h9 ydf1 ff1 fs3 fc0 sc0 ls0">迭代。比如：</div><div class="t m0 x5 hf ydf2 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Countdown<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf ydf3 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, start):</span></span></span></div><div class="t m0 x16 hf ydf4 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws458">start </span><span class="ls32">=</span><span class="fc0">start</span></span></div><div class="t m0 x15 h11 ydf5 ffa fs5 fcd sc0 ls0 ws13b"># Forward iterator</div><div class="t m0 x15 hf ydf6 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__iter__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf ydf7 ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls33">=<span class="fca ls0 ws13a">self<span class="fc6">.<span class="fc0">start</span></span></span></span></div><div class="t m0 x16 hf ydf8 ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 fc0 ls33">n<span class="fc6 ls32">&gt;<span class="fc7 ls34">0</span></span><span class="ls0">:</span></span></div><div class="t m0 x17 hf ydf9 ff7 fs5 fca sc0 ls0 ws16a">yield <span class="ff8 fc0">n</span></div><div class="t m0 x17 hf ydfa ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls0 ws23d">-= <span class="fc7">1</span></span></div><div class="t m0 x15 h11 ydfb ffa fs5 fcd sc0 ls0 ws13b"># Reverse iterator</div><div class="t m0 x15 hf y289 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__reversed__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf ydfc ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls33">=<span class="fc7 ls0">1</span></span></div><div class="t m0 x16 hf ydfd ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 fc0 ls33">n<span class="fc6 ls0 ws1a1">&lt;= <span class="fca ws13a">self<span class="fc6">.<span class="fc0">start:</span></span></span></span></span></div><div class="t m0 x17 hf ydfe ff7 fs5 fca sc0 ls0 ws16a">yield <span class="ff8 fc0">n</span></div><div class="t m0 x17 hf ydff ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls0 ws23d">+= <span class="fc7">1</span></span></div><div class="t m0 x5 hf ye00 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws159">rr </span><span class="ws157">in <span class="ff8 ws13a">reversed<span class="fc0">(Countdown(<span class="fc7">30</span>)):</span></span></span></div><div class="t m0 x15 hf ye01 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(rr)</span></div><div class="t m0 x5 hf ye02 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws159">rr </span><span class="ws157">in <span class="ff8 fc0 ws13a">Countdown(<span class="fc7">30</span>):</span></span></div><div class="t m0 x15 hf ye03 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(rr)</span></div><div class="t m0 x0 h9 ye04 ff1 fs3 fc0 sc0 ls3a ws153">定义一个反向迭代器可以使得代码非常的高效，因为它不再需要将数据填充到一个</div><div class="t m0 x5 h9 ye05 ff1 fs3 fc0 sc0 ls0">列表中然后再去反向迭代这个列表。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">6.5.<span class="_ _5"> </span>4.5 <span class="ff1 ws563">反向迭代 </span>117</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
