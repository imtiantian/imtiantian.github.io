<div id="pf197" class="pf w0 h0" data-page-no="197"><div class="pc pc197 w0 h0"><img class="bi x13 y5 w2 hb" alt="" src="bg197.png"/><div class="t m0 xe h8 y76 ff2 fs3 fc0 sc0 ls0">CHAPTER</div><div class="t m0 x3a hc y77 ff2 fs4 fc0 sc0 ls0">THIRTEEN</div><div class="t m0 x3b hd y78 ff1 fs4 fc0 sc0 ls0 ws165">第十一章：网络与 <span class="ff2 wse74">WEB </span>编程</div><div class="t m0 x0 h7 y79 ff1 fs3 fc0 sc0 ls30 wse75">本章是关于在网络应用和分布式应用中使用的各种主题。主题划分为使用 <span class="ff4 ls0">Python</span></div><div class="t m0 x5 h7 ycf ff1 fs3 fc0 sc0 ls0 ws12a">编写客户端程序来访问已有的服务，以及使用 <span class="ff4 ws12b">Python </span><span class="wsa0">实现网络服务端程序。<span class="_ _1"></span>也给出了</span></div><div class="t m0 x5 h9 yd0 ff1 fs3 fc0 sc0 ls0">一些常见的技术，用于编写涉及协同或通信的的代码。</div><div class="t m0 x0 h7 y9fe ff4 fs3 fc0 sc0 ls0 wsa5">Con<span class="_ _1"></span>ten<span class="_ _1"></span>ts:</div><div class="t m0 x5 hd y9ff ff2 fs4 fc4 sc0 ls0 ws211">13.1<span class="_ _e"> </span>11.1 <span class="ff1 ws165">作为客户端与 </span><span class="wse76">HTTP <span class="ff1">服务交互</span></span></div><div class="t m0 x5 he y297a ff2 fs2 fc4 sc0 ls0 ws212">13.1.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y297b ff1 fs3 fc0 sc0 ls30 wse77">你需要通过 <span class="ff4 ls0 wse78">HTTP </span><span class="ls10 wsdf">协议以客户端的方式访问多种服务<span class="_ _1"></span>。例如，下载数据或者与基<span class="_ _c"></span></span></div><div class="t m0 x5 h7 y297c ff1 fs3 fc0 sc0 ls4">于<span class="ff4 ls0 ws90">REST </span>的<span class="ff4 ls0 wse79">API <span class="ff1">进行交互。</span></span></div><div class="t m0 x5 he y297d ff2 fs2 fc4 sc0 ls0 ws212">13.1.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y1376 ff1 fs3 fc0 sc0 ls0 wse7a">对于简<span class="_ _6"></span>单的事<span class="_ _6"></span>情来说，通<span class="_ _6"></span>常使用 <span class="ff6 wse7b">urllib.request </span><span class="ls2c ws12f">模块就够了。例如，发送一个简</span></div><div class="t m0 x5 h7 y297e ff1 fs3 fc0 sc0 ls0 ws14">单的 <span class="ff4 wsd0">HTTP GET </span>请求到远程的服务上，可以这样做：</div><div class="t m0 x5 hf y22b4 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws146">urllib <span class="fca">import <span class="ff8 fc0 ws13b">request, parse</span></span></span></div><div class="t m0 x5 h11 y22b6 ffa fs5 fcd sc0 ls0 ws4"># Base URL being accessed</div><div class="t m0 x5 hf y22b7 ff8 fs5 fc0 sc0 ls0 ws158">url <span class="fc6 ls32">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">http://httpbin.org/get<span class="ff9">&apos;</span></span></div><div class="t m0 x5 h11 y1beb ffa fs5 fcd sc0 ls0 ws4"># Dictionary of query parameters (if any)</div><div class="t m0 x5 hf y22b9 ff8 fs5 fc0 sc0 ls0 ws15f">parms <span class="fc6 ls33">=</span>{</div><div class="t m0 x3c hf y1bd2 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">name1</span><span class="ls32">&apos;<span class="ff8 fc0">:</span></span>&apos;<span class="ff8 ls0 ws13a">value1</span><span class="ls0 ws13b">&apos;<span class="ff8 fc0">,</span></span></div><div class="t m0 x3c hf y1a2 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">name2</span><span class="ls32">&apos;<span class="ff8 fc0">:</span></span>&apos;<span class="ff8 ls0 ws13a">value2<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y1a3 ff8 fs5 fc0 sc0 ls0">}</div><div class="t m0 x5 h11 y1a5 ffa fs5 fcd sc0 ls0 ws4"># Encode the query string</div><div class="t m0 x5 hf y1a6 ff8 fs5 fc0 sc0 ls0 ws208">querystring <span class="fc6 ls32">=</span><span class="ws13a">parse<span class="fc6 ls34">.</span>urlencode(parms)</span></div><div class="t m0 x5 h11 y1a8 ffa fs5 fcd sc0 ls0 ws4"># Make a GET request and read the response</div><div class="t m0 x5 hf y1a9 ff8 fs5 fc0 sc0 ls32">u<span class="fc6 ls33">=</span><span class="ls0 ws13a">request<span class="fc6 ls34">.</span>urlopen(url<span class="fc6">+<span class="ff9 fc9 ls34">&apos;<span class="ff8">?</span><span class="ls32">&apos;</span></span><span class="ls33">+</span></span>querystring)</span></div><div class="t m0 x5 hf y1aa ff8 fs5 fc0 sc0 ls0 ws13c">resp <span class="fc6 ls32">=</span><span class="ls34">u<span class="fc6">.</span></span>read()</div><div class="t m0 x26 h8 y29 ff2 fs3 fc0 sc0 ls0">398</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
