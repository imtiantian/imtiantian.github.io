<div id="pfa3" class="pf w0 h0" data-page-no="a3"><div class="pc pca3 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bga3.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff8 fs5 fc0 sc0 ls0 ws150">name_sz_date <span class="fc6 ls33">=</span><span class="ws13b">[(name, os<span class="fc6 ls34">.</span><span class="ws13a">path<span class="fc6 ls34">.</span></span>getsize(name), os<span class="fc6 ls34">.</span><span class="ws13a">path<span class="fc6">.</span>getmtime(name))</span></span></div><div class="t m0 x18 hf y1ac ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws161">name </span><span class="ws157">in <span class="ff8 fc0">pyfiles]</span></span></div><div class="t m0 x5 hf y1ad ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13b">name, size, mtime </span><span class="ws157">in <span class="ff8 fc0">name_sz_date:</span></span></div><div class="t m0 x15 hf y1ae ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13b">(name, size, mtime)</span></div><div class="t m0 x5 h11 y1b0 ffa fs5 fcd sc0 ls0 ws4"># Alternative: Get file metadata</div><div class="t m0 x5 hf y355 ff8 fs5 fc0 sc0 ls0 ws147">file_metadata <span class="fc6 ls33">=</span><span class="ws13b">[(name, os<span class="fc6 ls34">.</span><span class="ws6c3">stat(name)) <span class="ff7 fca ws139">for </span><span class="ws13c">name <span class="ff7 fca ws157">in </span>pyfiles]</span></span></span></div><div class="t m0 x5 hf y410 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13b">name, meta </span><span class="ws157">in <span class="ff8 fc0">file_metadata:</span></span></div><div class="t m0 x15 hf y411 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13b">(name, meta<span class="fc6 ws13a">.</span><span class="ws4">st_size, meta<span class="fc6 ws13a">.</span>st_mtime)</span></span></div><div class="t m0 x0 h9 y11c2 ff1 fs3 fc0 sc0 ls3a ws153">最后还有一点要注意的就是，有时候在处理文件名编码问题时候可能会出现一些问</div><div class="t m0 x5 h9 y11c3 ff1 fs3 fc0 sc0 ls0 ws6c4">题。<span class="_ _6"></span>通<span class="_ _6"></span>常<span class="_ _6"></span>来<span class="_ _6"></span>讲，<span class="_ _0"></span>函数 <span class="ff6 ws6c5">os.listdir() </span><span class="ls36 ws14a">返回的实体列表会根据系统默认的文件名编码来</span></div><div class="t m0 x5 h9 y11c4 ff1 fs3 fc0 sc0 ls1e ws111">解码<span class="_ _1"></span>。但是有时候也会碰到一些不能正常解码的文件名<span class="_ _1"></span>。关于文件名的处理问题<span class="_ _1"></span>，在</div><div class="t m0 x5 h7 y11c5 ff4 fs3 fc0 sc0 ls0 ws1d0">5.14 <span class="ff1 ls5">和</span>5.15 <span class="ff1">小节有更详细的讲解。</span></div><div class="t m0 x5 hd y11c6 ff2 fs4 fc4 sc0 ls0 ws211">7.14<span class="_ _e"> </span>5.14 <span class="ff1">忽略文件名编码</span></div><div class="t m0 x5 he y11c7 ff2 fs2 fc4 sc0 ls0 ws212">7.14.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y11c8 ff1 fs3 fc0 sc0 ls40 ws6c6">你想使用原始文件名执行文件的 <span class="ff4 ls0 ws6c7">I/<span class="_ _6"></span>O </span><span class="ws180">操作<span class="_ _1"></span>，也就是说文件名并没有经过系统默认<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y11c9 ff1 fs3 fc0 sc0 ls0">编码去解码或编码过。</div><div class="t m0 x5 he y11ca ff2 fs2 fc4 sc0 ls0 ws212">7.14.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y11cb ff1 fs3 fc0 sc0 ls0 ws6c8">默<span class="_ _6"></span>认<span class="_ _6"></span>情况<span class="_ _6"></span>下，<span class="_ _6"></span>所<span class="_ _6"></span>有<span class="_ _6"></span>的<span class="_ _6"></span>文<span class="_ _6"></span>件<span class="_ _6"></span>名<span class="_ _6"></span>都<span class="_ _6"></span>会<span class="_ _6"></span>根据 <span class="ff6 ws6c9">sys.getfilesystemencoding() </span><span class="ls40 ws180">返回的文本</span></div><div class="t m0 x5 h9 y11cc ff1 fs3 fc0 sc0 ls0">编码来编码或解码。比如：</div><div class="t m0 x5 hf y11cd ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">sys<span class="fc6 ls34">.</span>getfilesystemencoding()</span></div><div class="t m0 x5 hf y11ce ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">utf-8<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y11cf ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y11d0 ff1 fs3 fc0 sc0 ls3a ws153">如果因为某种原因你想忽略这种编码，可以使用一个原始字节字符串来指定一个文</div><div class="t m0 x5 h9 y11d1 ff1 fs3 fc0 sc0 ls0">件名即可。比如：</div><div class="t m0 x5 h11 y11d2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Wrte a file using a unicode filename</span></div><div class="t m0 x5 hf y11d3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">with <span class="ff8 ws13a">open<span class="fc0 ls34">(<span class="ff9 fc9">&apos;</span></span><span class="fc9">jalape<span class="ff7 ws156">\xf1</span>o.txt<span class="ff9 ls34">&apos;</span><span class="fc0 ls32">,</span><span class="ff9 ls34">&apos;</span>w<span class="ff9 ls34">&apos;</span><span class="fc0 ls33">)</span></span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></span></div><div class="t m0 x5 hf y11d4 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fc0 ls34">f<span class="fc6 ls0 ws13a">.<span class="fc0">write(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">Spicy!<span class="ff9 ws13b">&apos;</span></span>)</span></span></span></div><div class="t m0 x5 h10 y11d5 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y11d6 ff8 fs5 fc8 sc0 ls0">6</div><div class="t m0 x5 h11 y11d7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Directory listing (decoded)</span></div><div class="t m0 x5 h10 y11d8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">os</span></span></div><div class="t m0 x5 hf y11d9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">os<span class="fc6 ls34">.</span>listdir(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">.<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y11da ff8 fs5 fc8 sc0 ls34">[<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">jalapeño.txt</span><span class="ff9">&apos;</span><span class="ls0">]</span></div><div class="t m0 x5 h11 y11db ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Directory listing (raw)</span></div><div class="t m0 x5 hf y11dc ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">os<span class="fc6 ls34">.</span>listdir(b<span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">.<span class="ff9">&apos;</span></span></span><span class="ls32">)</span><span class="ffa fcd ws4"># Note: byte string</span></span></div><div class="t m0 x5 hf y11dd ff8 fs5 fc8 sc0 ls0 ws13a">[b<span class="ff9 ls34">&apos;</span>jalapen\xcc\x83o.txt<span class="ff9 ws13b">&apos;</span>]</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">7.14.<span class="_ _5"> </span>5.14 <span class="ff1 ws600">忽略文件名编码 </span>154</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
