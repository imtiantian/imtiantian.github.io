<div id="pff8" class="pf w0 h0" data-page-no="f8"><div class="pc pcf8 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgf8.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hd y112 ff2 fs4 fc4 sc0 ls0 ws9c6">10.6<span class="_ _e"> </span>8.6 <span class="ff1">创建可管理的属性</span></div><div class="t m0 x5 he y113 ff2 fs2 fc4 sc0 ls0 ws212">10.6.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y658 ff1 fs3 fc0 sc0 ls0 wsa2a">你想<span class="_ _6"></span>给<span class="_ _6"></span>某<span class="_ _6"></span>个实<span class="_ _6"></span>例 <span class="ff4 wsa2b">attribute </span><span class="ls10 wsdf">增加除访问与修改之外的其他处理逻辑，比如类型检查<span class="_ _c"></span></span></div><div class="t m0 x5 h9 y659 ff1 fs3 fc0 sc0 ls0">或合法性验证。</div><div class="t m0 x5 he y18fe ff2 fs2 fc4 sc0 ls0 ws212">10.6.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y18bb ff1 fs3 fc0 sc0 ls35 wsa2c">自定义某个属性的一种简单方法是将它定义为一个 <span class="ff4 ls0 wsa5">property<span class="ff1 wsa0">。例如，下面的代码定</span></span></div><div class="t m0 x5 h7 y18bc ff1 fs3 fc0 sc0 ls0 ws14">义了一个 <span class="ff4 wsa5">prop<span class="_ _6"></span>ert<span class="_ _1"></span>y<span class="ff1">，增加对一个属性简单的类型检查：</span></span></div><div class="t m0 x5 hf y1acb ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Person<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf y1acc ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, first_name):</span></span></span></div><div class="t m0 x16 hf y1acd ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws2a3">first_name </span><span class="ls33">=</span><span class="fc0">first_name</span></span></div><div class="t m0 x15 h11 y1ace ffa fs5 fcd sc0 ls0 ws13b"># Getter function</div><div class="t m0 x15 h10 y1acf ff7 fs5 fc12 sc0 ls0">@property</div><div class="t m0 x15 hf yd45 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">first_name<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y1ad0 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">self<span class="fc6 ls34">.</span><span class="fc0">_first_name</span></span></div><div class="t m0 x15 h11 y1ad1 ffa fs5 fcd sc0 ls0 ws13b"># Setter function</div><div class="t m0 x15 h10 y1ad2 ff7 fs5 fc12 sc0 ls0">@first_name.setter</div><div class="t m0 x15 hf y1ad3 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">first_name<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, value):</span></span></span></div><div class="t m0 x16 hf y1ad4 ff7 fs5 fca sc0 ls0 ws157">if not <span class="ff8 ws13a">isinstance<span class="fc0 ws155">(value, </span>str<span class="fc0">):</span></span></div><div class="t m0 x17 hf y1ad5 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Expected a string<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x16 hf y1ad6 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws208">_first_name </span><span class="ls33">=</span><span class="fc0">value</span></span></div><div class="t m0 x15 h11 y1ad7 ffa fs5 fcd sc0 ls0 ws4"># Deleter function (optional)</div><div class="t m0 x15 h10 y1ad8 ff7 fs5 fc12 sc0 ls0">@first_name.deleter</div><div class="t m0 x15 hf y1ad9 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">first_name<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y1ada ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">AttributeError<span class="fc0 ls34">(</span><span class="fc9">&quot;Can<span class="ff9 ls34">&apos;</span><span class="ws13b">t delete attribute&quot;<span class="fc0">)</span></span></span></span></div><div class="t m0 x0 h9 y1adb ff1 fs3 fc0 sc0 ls3a ws153">上述代码中有三个相关联的方法，这三个方法的名字都必须一样。第一个方法是一</div><div class="t m0 x5 h9 y1adc ff1 fs3 fc0 sc0 ls169">个<span class="ff6 ls0 wsa2d">getter </span><span class="ls0 wsa2e">函<span class="_ _6"></span>数，<span class="_ _6"></span>它<span class="_ _6"></span>使<span class="_ _6"></span>得 <span class="ff6 ws149">first name </span></span><span class="ls49 wsa2f">成为一个属性。其他两个方法给 </span><span class="ff6 ls0 ws149">first name <span class="ff1">属</span></span></div><div class="t m0 x5 h9 y1add ff1 fs3 fc0 sc0 ls13 wsa30">性添加了 <span class="ff6 ls0 wsa31">setter </span><span class="ls92">和<span class="ff6 ls0 ws36e">deleter </span></span><span class="wsa32">函数<span class="_ _1"></span>。需要强调的是只有在 <span class="ff6 ls0 ws149">first name <span class="ff1 wsa0">属<span class="_ _6"></span>性<span class="_ _6"></span>被<span class="_ _6"></span>创建<span class="_ _6"></span>后，</span></span></span></div><div class="t m0 x5 h9 y1ade ff1 fs3 fc0 sc0 ls0 ws14">后面的两个装饰器 <span class="ff6 ws133">@first<span class="_ _7"> </span>name.setter </span><span class="ls4">和</span><span class="ff6 ws1dc">@first<span class="_ _16"> </span>name.deleter </span>才能被定义。</div><div class="t m0 x0 h7 y1adf ff4 fs3 fc0 sc0 ls0 wsa33">prop<span class="_ _6"></span>ert<span class="_ _1"></span>y <span class="ff1 ls2d wsa34">的一个关键特征是它看上去跟普通的 </span><span class="wsa35">attribute <span class="ff1 wsa0">没<span class="_ _6"></span>什<span class="_ _6"></span>么两<span class="_ _6"></span>样，<span class="_ _6"></span>但<span class="_ _6"></span>是<span class="_ _6"></span>访问<span class="_ _6"></span>它</span></span></div><div class="t m0 x5 h9 y1ae0 ff1 fs3 fc0 sc0 ls0 ws14">的时候会自动触发 <span class="ff6 ws25d">getter </span><span class="wsa0">、<span class="ff6 ws25d">setter </span><span class="ls4">和</span><span class="ff6 ws23a">deleter </span>方法。例如：</span></div><div class="t m0 x5 hf y1ae1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls0 ws13a">Person(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Guido<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y1ae2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">a<span class="fc6 ls0 ws13a">.<span class="fc0 ws2a3">first_name <span class="ffa fcd ws4"># Calls the getter</span></span></span></span></div><div class="t m0 x5 hf y1ae3 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">Guido<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y1ae4 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">a<span class="fc6 ls0 ws13a">.<span class="fc0 ws2a3">first_name </span><span class="ls33">=</span><span class="fc7 ws159">42 <span class="ffa fcd ws4"># Calls the setter</span></span></span></span></div><div class="t m0 x5 hf y1ae5 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y1ae6 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x15 hf y1ae7 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;prop.py&quot;</span><span class="ws145">, line <span class="fc7 ws13a">14</span><span class="ls32">,</span><span class="ff7 fca ws157">in </span>first_name</span></div><div class="t m0 x16 hf y1ae8 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Expected a string<span class="ff9 ws13b">&apos;</span></span>)</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws9da">10.6.<span class="_ _5"> </span>8.6 <span class="ff1 ws2a4">创建可管理的属性 </span>239</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
