<div id="pfd7" class="pf w0 h0" data-page-no="d7"><div class="pc pcd7 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgd7.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h10 y334 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">pandas</span></span></div><div class="t m0 x5 h11 y336 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Read a CSV file, skipping last line</span></div><div class="t m0 x5 hf y337 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">rats <span class="fc6 ls32">=</span><span class="ws13a">pandas<span class="fc6 ls34">.</span>read_csv(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">rats.csv<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, skip_footer<span class="fc6 ls34">=<span class="fc7">1</span></span>)</span></span></span></div><div class="t m0 x5 hf yadd ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">rats</span></div><div class="t m0 x5 hf yade ff8 fs5 fc8 sc0 ls0 ws145">&lt;class <span class="ff9 ls34">&apos;</span><span class="ws13a">pandas.core.frame.DataFrame<span class="ff9 ls34">&apos;</span>&gt;</span></div><div class="t m0 x5 hf yadf ff8 fs5 fc8 sc0 ls0 ws4">Int64Index: 74055 entries, 0 to 74054</div><div class="t m0 x5 hf yc64 ff8 fs5 fc8 sc0 ls0 ws4">Data columns:</div><div class="t m0 x5 hf y1555 ff8 fs5 fc8 sc0 ls0 ws4">Creation Date 74055 non-null values</div><div class="t m0 x5 hf y177c ff8 fs5 fc8 sc0 ls0 ws4">Status 74055 non-null values</div><div class="t m0 x5 hf y177d ff8 fs5 fc8 sc0 ls0 ws4">Completion Date 72154 non-null values</div><div class="t m0 x5 hf y177e ff8 fs5 fc8 sc0 ls0 ws4">Service Request Number 74055 non-null values</div><div class="t m0 x5 hf y177f ff8 fs5 fc8 sc0 ls0 ws4">Type of Service Request 74055 non-null values</div><div class="t m0 x5 hf y1780 ff8 fs5 fc8 sc0 ls0 ws4">Number of Premises Baited 65804 non-null values</div><div class="t m0 x5 hf y1781 ff8 fs5 fc8 sc0 ls0 ws4">Number of Premises with Garbage 65600 non-null values</div><div class="t m0 x5 hf y1782 ff8 fs5 fc8 sc0 ls0 ws4">Number of Premises with Rats 65752 non-null values</div><div class="t m0 x5 hf y1783 ff8 fs5 fc8 sc0 ls0 ws4">Current Activity 66041 non-null values</div><div class="t m0 x5 hf y1784 ff8 fs5 fc8 sc0 ls0 ws4">Most Recent Action 66023 non-null values</div><div class="t m0 x5 hf y1785 ff8 fs5 fc8 sc0 ls0 ws4">Street Address 74055 non-null values</div><div class="t m0 x5 hf y1786 ff8 fs5 fc8 sc0 ls0 ws4">ZIP Code 73584 non-null values</div><div class="t m0 x5 hf y1787 ff8 fs5 fc8 sc0 ls0 ws4">X Coordinate 74043 non-null values</div><div class="t m0 x5 hf y1788 ff8 fs5 fc8 sc0 ls0 ws4">Y Coordinate 74043 non-null values</div><div class="t m0 x5 hf y1789 ff8 fs5 fc8 sc0 ls0 ws4">Ward 74044 non-null values</div><div class="t m0 x5 hf y178a ff8 fs5 fc8 sc0 ls0 ws4">Police District 74044 non-null values</div><div class="t m0 x5 hf y178b ff8 fs5 fc8 sc0 ls0 ws4">Community Area 74044 non-null values</div><div class="t m0 x5 hf y178c ff8 fs5 fc8 sc0 ls0 ws4">Latitude 74043 non-null values</div><div class="t m0 x5 hf y178d ff8 fs5 fc8 sc0 ls0 ws4">Longitude 74043 non-null values</div><div class="t m0 x5 hf y178e ff8 fs5 fc8 sc0 ls0 ws4">Location 74043 non-null values</div><div class="t m0 x5 hf y178f ff8 fs5 fc8 sc0 ls0 ws4">dtypes: float64(11), object(9)</div><div class="t m0 x5 h11 y1790 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Investigate range of values for a certain field</span></div><div class="t m0 x5 hf y1791 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">rats[<span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Current Activity</span><span class="ls34">&apos;</span></span>]<span class="fc6 ls34">.</span>unique()</span></div><div class="t m0 x5 hf y1792 ff8 fs5 fc8 sc0 ls0 ws4">array([nan, Dispatch Crew, Request Sanitation Inspector], dtype=object)</div><div class="t m0 x5 h11 y10dc ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Filter the data</span></div><div class="t m0 x5 hf y12d0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws151">crew_dispatched <span class="fc6 ls32">=</span><span class="ws13a">rats[rats[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Current Activity<span class="ff9 ws13b">&apos;</span></span><span class="ls33">]</span><span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13b">Dispatch Crew<span class="ff9 ls34">&apos;</span></span></span>]</span></span></div><div class="t m0 x5 hf y12d1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">len<span class="fc0">(crew_dispatched)</span></span></div><div class="t m0 x5 hf y12d2 ff8 fs5 fc8 sc0 ls0">65676</div><div class="t m0 x5 hf y12d3 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h11 y1793 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Find 10 most rat-infested ZIP codes in Chicago</span></div><div class="t m0 x5 hf y1794 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">crew_dispatched[<span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">ZIP Code</span><span class="ls34">&apos;</span></span><span class="ls34">]</span><span class="fc6">.</span>value_counts()[:<span class="fc7">10</span>]</span></div><div class="t m0 x5 hf y1795 ff8 fs5 fc8 sc0 ls0 ws4">60647 3837</div><div class="t m0 x5 hf y1796 ff8 fs5 fc8 sc0 ls0 ws4">60618 3530</div><div class="t m0 x5 hf y1797 ff8 fs5 fc8 sc0 ls0 ws4">60614 3284</div><div class="t m0 x5 hf y1798 ff8 fs5 fc8 sc0 ls0 ws4">60629 3251</div><div class="t m0 x5 hf y1799 ff8 fs5 fc8 sc0 ls0 ws4">60636 2801</div><div class="t m0 x5 hf y179a ff8 fs5 fc8 sc0 ls0 ws4">60657 2465</div><div class="t m0 x5 hf y179b ff8 fs5 fc8 sc0 ls0 ws4">60641 2238</div><div class="t m0 x5 hf y179c ff8 fs5 fc8 sc0 ls0 ws4">60609 2206</div><div class="t m0 x5 hf y179d ff8 fs5 fc8 sc0 ls0 ws4">60651 2152</div><div class="t m0 x5 hf y179e ff8 fs5 fc8 sc0 ls0 ws4">60632 2071</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">8.13.<span class="_ _5"> </span>6.13 <span class="ff1 ws509">数据的累加与统计操作 </span>206</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
