<div id="pf205" class="pf w0 h0" data-page-no="205"><div class="pc pc205 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg205.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 h11 y1e8 ffa fs5 fcd sc0 ls0 ws4"># Variables (to make the calls that follow work)</div><div class="t m0 x15 hf y1e9 ff8 fs5 fc0 sc0 ls0 ws1f5">hostname <span class="fc6 ls33">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">www.python.org<span class="ff9">&apos;</span></span></div><div class="t m0 x15 hf y1ea ff8 fs5 fc0 sc0 ls0 ws13c">item <span class="fc6 ls32">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">spam<span class="ff9">&apos;</span></span></div><div class="t m0 x15 hf y903 ff8 fs5 fc0 sc0 ls0 ws1f5">filename <span class="fc6 ls33">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">data.csv<span class="ff9">&apos;</span></span></div><div class="t m0 x15 hf y1eb ff8 fs5 fc0 sc0 ls0 ws13c">mode <span class="fc6 ls32">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">r<span class="ff9">&apos;</span></span></div><div class="t m0 x15 h11 y904 ffa fs5 fcd sc0 ls0 ws4"># Example logging calls (insert into your program)</div><div class="t m0 x15 hf y905 ff8 fs5 fc0 sc0 ls0 ws13a">logging<span class="fc6 ls34">.</span>critical(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13c">Host <span class="ffa fcf ws159">%s </span><span class="ws13a">unknown<span class="ff9 ls34">&apos;</span></span></span><span class="ws13b">, hostname)</span></div><div class="t m0 x15 hf y906 ff8 fs5 fc0 sc0 ls0 ws13a">logging<span class="fc6 ls34">.</span>error(<span class="fc9">&quot;Couldn<span class="ff9 ls34">&apos;</span><span class="ws13b">t find </span><span class="ffa fcf">%r</span><span class="ls34">&quot;</span></span><span class="ws4">, item)</span></div><div class="t m0 x15 hf y907 ff8 fs5 fc0 sc0 ls0 ws13a">logging<span class="fc6 ls34">.</span>warning(<span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Feature is deprecated</span>&apos;</span>)</div><div class="t m0 x15 hf y908 ff8 fs5 fc0 sc0 ls0 ws13a">logging<span class="fc6 ls34">.</span>info(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Opening file </span><span class="ffa fcf">%r</span><span class="fc9 ws13b">, mode=</span><span class="ffa fcf">%r<span class="ff9 fc9 ws13b">&apos;</span></span><span class="ws4">, filename, mode)</span></div><div class="t m0 x15 hf y909 ff8 fs5 fc0 sc0 ls0 ws13a">logging<span class="fc6 ls34">.</span>debug(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13b">Got here<span class="ff9">&apos;</span></span>)</div><div class="t m0 x5 hf ybd9 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws16d">__name__ <span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">__main__<span class="ff9 ls34">&apos;</span></span></span>:</span></div><div class="t m0 x15 hf y90a ff8 fs5 fc0 sc0 ls0">main()</div><div class="t m0 x0 h7 y328a ff1 fs3 fc0 sc0 ls42 ws186">上面五个日志调用（<span class="ff4 ls0 ws1246">critical(), error(), w<span class="_ _c"></span>arning(), info(), debug()<span class="ff1 ls42 ws186">）以降序方式表示</span></span></div><div class="t m0 x5 h9 y328b ff1 fs3 fc0 sc0 ls0 ws1247">不同的严<span class="_ _6"></span>重级别。 <span class="ff6 ws1248">basicConfig() </span><span class="ls122">的</span><span class="ff6 ws9a1">level </span><span class="ls51 ws1c8">参数是一个过滤器。所有级别低于此级别</span></div><div class="t m0 x5 h7 y328c ff1 fs3 fc0 sc0 ls0 ws1249">的日志消息都会被忽略掉。每个 <span class="ff4 ws124a">logging </span><span class="ls1f ws113">操作的参数是一个消息字<span class="_ _6"></span>符串，后面再跟一个</span></div><div class="t m0 x5 h7 y328d ff1 fs3 fc0 sc0 ls0 wsa0">或多个参数。构造最终的日志消息的时候我们使用了<span class="ff4 lsd2">%</span>操作符来格式化消息字符串。</div><div class="t m0 x0 h9 y328e ff1 fs3 fc0 sc0 ls0 ws38">运行这个程序后，在文件 <span class="ff6 ws23a">app.log </span>中的内容应该是下面这样：</div><div class="t m0 x5 hf y328f ff8 fs5 fc0 sc0 ls0 ws4">CRITICAL:root:Host www.python.org unknown</div><div class="t m0 x5 hf y3290 ff8 fs5 fc0 sc0 ls0 ws4">ERROR:root:Could not find <span class="ff9 ls34">&apos;</span><span class="ws13a">spam<span class="ff9">&apos;</span></span></div><div class="t m0 x0 h7 y27df ff4 fs3 fc0 sc0 ls0 ws124b">If y<span class="_ _1"></span>ou w<span class="_ _1"></span>ant to c<span class="_ _c"></span>hange the output or level of output, you can c<span class="_ _c"></span>hange the param-</div><div class="t m0 x5 h7 y3291 ff4 fs3 fc0 sc0 ls0 wscfb">eters to the basicConﬁg() call.<span class="_ _36"> </span>F<span class="_ _8"></span>or example:<span class="_ _40"> </span><span class="ff1 ls19c wsc48">如果你想改变输出等级<span class="_ _8"></span>，<span class="_ _6"></span>你可以修改<span class="_ _8"></span></span></div><div class="t m0 x5 h9 y3292 ff6 fs3 fc0 sc0 ls0 ws317">basicConfig() <span class="ff1">调用中的参数。例如：</span></div><div class="t m0 x5 hf y3293 ff8 fs5 fc0 sc0 ls0 ws13a">logging<span class="fc6 ls34">.</span>basicConfig(</div><div class="t m0 x31 hf y3294 ff8 fs5 fc0 sc0 ls0 ws13a">filename<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span><span class="fc9">app.log<span class="ff9 ls34">&apos;</span></span>,</div><div class="t m0 x31 hf y3295 ff8 fs5 fc0 sc0 ls0 ws13a">level<span class="fc6 ls34">=</span>logging<span class="fc6 ls34">.</span>WARNING,</div><div class="t m0 x31 hf y3296 ff8 fs5 fc0 sc0 ls0 ws13a">format<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span><span class="ffa fcf">%(levelname)s</span><span class="fc9 ls34">:</span><span class="ffa fcf">%(asctime)s</span><span class="fc9">:<span class="ffa fcf">%(message)s</span><span class="ff9 ls34">&apos;</span></span>)</div><div class="t m0 x0 h9 y3297 ff1 fs3 fc0 sc0 ls0">最后输出变成如下：</div><div class="t m0 x5 hf y5ce ff8 fs5 fc0 sc0 ls0 ws4">CRITICAL:2012-11-20 12:27:13,595:Host www.python.org unknown</div><div class="t m0 x5 hf y5cf ff8 fs5 fc0 sc0 ls0 ws4">ERROR:2012-11-20 12:27:13,595:Could not find <span class="ff9 ws13b">&apos;</span><span class="ws13a">spam<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y5d0 ff8 fs5 fc0 sc0 ls0 ws4">WARNING:2012-11-20 12:27:13,595:Feature is deprecated</div><div class="t m0 x0 h9 y3298 ff1 fs3 fc0 sc0 ls3a ws153">上面的日志配置都是硬编码到程序中的。如果你想使用配置文件，可以像下面这样</div><div class="t m0 x5 h9 y3299 ff1 fs3 fc0 sc0 ls0 ws14">修改 <span class="ff6 ws309">basicConfig() </span>调用：</div><div class="t m0 x5 h10 y329a ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">logging</span></div><div class="t m0 x5 h10 y329b ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">logging.config</span></div><div class="t m0 x5 hf y329c ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">main<span class="fc0">():</span></span></div><div class="t m0 x15 h11 y2c2b ffa fs5 fcd sc0 ls0 ws4"># Configure the logging system</div><div class="t m0 x15 hf y2c2c ff8 fs5 fc0 sc0 ls0 ws13a">logging<span class="fc6 ls34">.</span>config<span class="fc6 ls34">.</span>fileConfig(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">logconfig.ini<span class="ff9 ls34">&apos;</span></span>)</div><div class="t m0 x15 hf y2c2d ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsd97">15.11.<span class="_ _36"> </span>13.11 <span class="ff1 wse2d">给简单脚本增加日志功能 </span>508</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
