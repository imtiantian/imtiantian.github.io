<div id="pf70" class="pf w0 h0" data-page-no="70"><div class="pc pc70 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg70.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; d = relativedelta(b, a)</div><div class="t m0 x5 hf y1ac ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; d</div><div class="t m0 x5 hf y1ad ff8 fs5 fc0 sc0 ls0 ws4">relativedelta(months=+2, days=+28)</div><div class="t m0 x5 hf y1ae ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; d.months</div><div class="t m0 x5 hf y1af ff8 fs5 fc0 sc0 ls0">2</div><div class="t m0 x5 hf y1b0 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; d.days</div><div class="t m0 x5 hf y355 ff8 fs5 fc0 sc0 ls0">28</div><div class="t m0 x5 hf y410 ff8 fs5 fc0 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 hd yc88 ff2 fs4 fc4 sc0 ls0 ws211">5.13<span class="_ _e"> </span>3.13 <span class="ff1">计算最后一个周五的日期</span></div><div class="t m0 x5 he yc89 ff2 fs2 fc4 sc0 ls0 ws212">5.13.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 yc8a ff1 fs3 fc0 sc0 ls0">你需要查找星期中某一天最后出现的日期，比如星期五。</div><div class="t m0 x5 he yc8b ff2 fs2 fc4 sc0 ls0 ws212">5.13.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 yc8c ff4 fs3 fc0 sc0 ls0 ws50f">Python <span class="ff1 lsdc">的</span><span class="ff6 ws510">datetime <span class="ff1 lsa5 ws3b5">模块中有工具函数和类可以帮助你执行这样的计算<span class="_ _c"></span>。下面是</span></span></div><div class="t m0 x5 h9 yc8d ff1 fs3 fc0 sc0 ls0">对类似这样的问题的一个通用解决方案：</div><div class="t m0 x5 h11 yc8e ffa fs5 fcd sc0 ls0 ws4">#!/usr/bin/env python</div><div class="t m0 x5 h11 yc8f ffa fs5 fcd sc0 ls0 ws4"># -*- encoding: utf-8 -*-</div><div class="t m0 x5 h11 yc90 ffa fs5 fc9 sc0 ls0">&quot;&quot;&quot;</div><div class="t m0 x5 h12 y737 ffa fs5 fc9 sc0 ls0 ws145">Topic: <span class="ffc fs6">最后的周五</span></div><div class="t m0 x5 h11 yc91 ffa fs5 fc9 sc0 ls0 ws4">Desc :</div><div class="t m0 x5 h11 yc92 ffa fs5 fc9 sc0 ls0">&quot;&quot;&quot;</div><div class="t m0 x5 hf yc93 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws248">datetime </span><span class="ws146">import <span class="ff8 fc0 ws4">datetime, timedelta</span></span></div><div class="t m0 x5 hf yc94 ff8 fs5 fc0 sc0 ls0 ws16d">weekdays <span class="fc6 ls32">=</span><span class="ls34">[</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">Monday</span><span class="ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">Tuesday<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">Wednesday<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">Thursday<span class="ff9 ls34">&apos;</span></span>,</div><div class="t m0 x17 hf yc95 ff9 fs5 fc9 sc0 ls0 ws13b">&apos;<span class="ff8 ws13a">Friday</span><span class="ls34">&apos;<span class="ff8 fc0 ls32">,</span>&apos;</span><span class="ff8 ws13a">Saturday</span>&apos;<span class="ff8 fc0 ls33">,</span>&apos;<span class="ff8 ws13a">Sunday</span><span class="ls34">&apos;</span><span class="ff8 fc0">]</span></div><div class="t m0 x5 hf yc96 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">get_previous_byday<span class="fc0 ws4">(dayname, start_date</span><span class="fc6">=<span class="fca">None<span class="fc0">):</span></span></span></span></div><div class="t m0 x15 hf yc97 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws2a3">start_date </span>is <span class="ff8 ws13a">None<span class="fc0">:</span></span></div><div class="t m0 x16 hf yc98 ff8 fs5 fc0 sc0 ls0 ws2a3">start_date <span class="fc6 ls32">=</span><span class="ws13a">datetime<span class="fc6 ls34">.</span>today()</span></div><div class="t m0 x15 hf yc99 ff8 fs5 fc0 sc0 ls0 ws155">day_num <span class="fc6 ls32">=</span><span class="ws13a">start_date<span class="fc6 ls34">.</span>weekday()</span></div><div class="t m0 x15 hf yc9a ff8 fs5 fc0 sc0 ls0 ws169">day_num_target <span class="fc6 ls32">=</span><span class="ws13a">weekdays<span class="fc6 ls34">.</span>index(dayname)</span></div><div class="t m0 x15 hf yc9b ff8 fs5 fc0 sc0 ls0 ws1f5">days_ago <span class="fc6 ls33">=</span><span class="ls34">(<span class="fc7 ls32">7<span class="fc6 ls33">+</span></span></span><span class="ws1f4">day_num <span class="fc6 ls33">-</span><span class="ws511">day_num_target) <span class="fc6 ls33">%</span><span class="fc7">7</span></span></span></div><div class="t m0 x15 hf yc9c ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws16d">days_ago <span class="fc6 ws159">== <span class="fc7 ls34">0</span></span>:</span></div><div class="t m0 x16 hf yc9d ff8 fs5 fc0 sc0 ls0 ws1f5">days_ago <span class="fc6 ls33">=</span><span class="fc7">7</span></div><div class="t m0 x15 hf yc9e ff8 fs5 fc0 sc0 ls0 ws208">target_date <span class="fc6 ls32">=</span><span class="ws2a3">start_date <span class="fc6 ls33">-</span><span class="ws13a">timedelta(days<span class="fc6">=</span>days_ago)</span></span></div><div class="t m0 x15 hf yc9f ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">target_date</span></div><div class="t m0 x0 h9 yca0 ff1 fs3 fc0 sc0 ls0">在交互式解释器中使用如下：</div><div class="t m0 x5 hf yca1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">datetime<span class="fc6">.</span><span class="ws155">today() <span class="ffa fcd ws4"># For reference</span></span></span></div><div class="t m0 x5 hf yca2 ff8 fs5 fc8 sc0 ls0 ws4">datetime.datetime(2012, 8, 28, 22, 4, 30, 263076)</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">5.13.<span class="_ _5"> </span>3.13 <span class="ff1 ws512">计算最后一个周五的日期 </span>103</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
