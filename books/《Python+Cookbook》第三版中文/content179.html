<div id="pfb3" class="pf w0 h0" data-page-no="b3"><div class="pc pcb3 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgb3.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h9 y2a ff1 fs3 fc0 sc0 ls6f ws76b">在上面的代码中<span class="_ _1"></span>， <span class="ff6 ls0 ws76c">row </span><span class="ws2a7">会是一个列表<span class="_ _1"></span>。因此<span class="_ _1"></span>，为了访问某个字段<span class="_ _1"></span>，你需要使用下</span></div><div class="t m0 x5 h7 y2b ff1 fs3 fc0 sc0 ls0 ws38">标，如 <span class="ff6 ws25d">row[0] </span><span class="ws14">访问 <span class="ff4 wsa5">Sym<span class="_ _1"></span>b<span class="_ _6"></span>ol<span class="ff1 ls5">，</span><span class="ff6 ws3ce">row[4] <span class="ff1 ws14">访问 </span></span>Change<span class="ff1">。</span></span></span></div><div class="t m0 x0 h9 y8dd ff1 fs3 fc0 sc0 ls0">由于这种下标访问通常会引起混淆，你可以考虑使用命名元组。例如：</div><div class="t m0 x5 hf y1360 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws168">collections </span><span class="ws146">import <span class="ff8 fc0">namedtuple</span></span></div><div class="t m0 x5 hf y1361 ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">stock.csv<span class="ff9 ws13b">&apos;</span></span><span class="ls33">)</span></span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y1362 ff8 fs5 fc0 sc0 ls0 ws15f">f_csv <span class="fc6 ls33">=</span><span class="ws13a">csv<span class="fc6 ls34">.</span>reader(f)</span></div><div class="t m0 x15 hf y1363 ff8 fs5 fc0 sc0 ls0 ws1f5">headings <span class="fc6 ls33">=</span><span class="fca ws13a">next</span>(f_csv)</div><div class="t m0 x15 hf y1364 ff8 fs5 fc0 sc0 ls0 ws158">Row <span class="fc6 ls32">=</span><span class="ws13a">namedtuple(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Row<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, headings)</span></span></div><div class="t m0 x15 hf y1365 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ls32">r</span><span class="ws157">in <span class="ff8 fc0">f_csv:</span></span></div><div class="t m0 x16 hf y1366 ff8 fs5 fc0 sc0 ls0 ws158">row <span class="fc6 ls32">=</span><span class="ws13a">Row(<span class="fc6 ls34">*</span>r)</span></div><div class="t m0 x16 h11 y1367 ffa fs5 fcd sc0 ls0 ws13b"># Process row</div><div class="t m0 x16 hf y1368 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h9 yb6d ff1 fs3 fc0 sc0 ls22 ws76d">它允许你使用列名如 <span class="ff6 ls0 ws76e">row.Symbol </span><span class="ls125">和<span class="ff6 ls0 ws76f">row.Change </span></span><span class="ws119">代替下标访问<span class="_ _1"></span>。需要注意的是这</span></div><div class="t m0 x5 h7 y1369 ff1 fs3 fc0 sc0 ls0 ws348">个只有在列名是合法的 <span class="ff4 ws12b">Python </span><span class="wsa0">标识符的时候才生效。如果不是的话，<span class="_ _1"></span>你可能需要修改</span></div><div class="t m0 x5 h7 y136a ff1 fs3 fc0 sc0 ls0 ws14">下原始的列名 <span class="ff4 wsa5">(</span><span class="wsa0">如将非标识符字符替换成下划线之类的<span class="ff4 ls1b">)</span>。</span></div><div class="t m0 x0 h9 y136b ff1 fs3 fc0 sc0 ls0">另外一个选择就是将数据读取到一个字典序列中去。可以这样做：</div><div class="t m0 x5 h10 y136c ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">csv</span></div><div class="t m0 x5 hf y136d ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">stocks.csv<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws160">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y136e ff8 fs5 fc0 sc0 ls0 ws15f">f_csv <span class="fc6 ls33">=</span><span class="ws13a">csv<span class="fc6 ls34">.</span>DictReader(f)</span></div><div class="t m0 x15 hf y136f ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws158">row </span><span class="ws157">in <span class="ff8 fc0">f_csv:</span></span></div><div class="t m0 x16 h11 y1370 ffa fs5 fcd sc0 ls0 ws13b"># process row</div><div class="t m0 x16 hf y1371 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h9 y1372 ff1 fs3 fc0 sc0 ls3a ws153">在这个版本中，你可以使用列名去访问每一行的数据了。比如，<span class="ff6 ls0 ws770">row[&apos;Symbol&apos;] <span class="ff1">或</span></span></div><div class="t m0 x5 h9 y1373 ff1 fs3 fc0 sc0 ls4">者<span class="ff6 ls0">row[&apos;Change&apos;]</span></div><div class="t m0 x0 h7 y1374 ff1 fs3 fc0 sc0 ls0 ws771">为了写入 <span class="ff4 ws772">CSV </span><span class="ws773">数据，<span class="_ _c"></span>你仍然可以使用 <span class="ff4 ws774">csv </span><span class="ws775">模块，不过这时候先创建一个 <span class="ff6 ws776">writer </span>对</span></span></div><div class="t m0 x5 h7 y1375 ff1 fs3 fc0 sc0 ls0 wsa0">象。例如<span class="ff4">:</span></div><div class="t m0 x5 hf y1376 ff8 fs5 fc0 sc0 ls0 ws155">headers <span class="fc6 ls32">=</span><span class="ls34">[<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13a">Symbol<span class="ff9 ls34">&apos;</span></span><span class="ls34">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">Price</span><span class="ls34">&apos;</span></span><span class="ws13a">,<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Date<span class="ff9 ls34">&apos;</span></span>,<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Time<span class="ff9 ls34">&apos;</span></span><span class="ls34">,</span><span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">Change<span class="ff9 ws13b">&apos;</span></span><span class="ls34">,<span class="ff9 fc9">&apos;</span></span><span class="fc9">Volume<span class="ff9 ls34">&apos;</span></span>]</span></div><div class="t m0 x5 hf y1377 ff8 fs5 fc0 sc0 ls0 ws13c">rows <span class="fc6 ls32">=</span><span class="ws13a">[(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">AA<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="fc7">39.48</span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">6/11/2007<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">9:36am<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="fc6">-<span class="fc7">0.18</span></span><span class="ls33">,</span><span class="fc7">181800</span>),</span></div><div class="t m0 x2b hf y1378 ff8 fs5 fc0 sc0 ls0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">AIG<span class="ff9 ls34">&apos;</span></span><span class="ls32">,</span><span class="fc7">71.38</span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">6/11/2007<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">9:36am<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="fc6 ls34">-</span></span><span class="fc7">0.15</span><span class="ls32">,</span><span class="fc7">195500</span>),</div><div class="t m0 x2b hf y1379 ff8 fs5 fc0 sc0 ls0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">AXP<span class="ff9 ls34">&apos;</span></span><span class="ls32">,</span><span class="fc7">62.58</span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">6/11/2007<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">9:36am<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="fc6 ls34">-</span></span><span class="fc7">0.46</span><span class="ls32">,</span><span class="fc7">935000</span>),</div><div class="t m0 x2c hf y137a ff8 fs5 fc0 sc0 ls0">]</div><div class="t m0 x5 hf y137b ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">stocks.csv<span class="ff9 ls34">&apos;</span></span><span class="ls34">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">w<span class="ff9">&apos;</span></span></span><span class="ls32">)</span></span></span><span class="ws160">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y137c ff8 fs5 fc0 sc0 ls0 ws15f">f_csv <span class="fc6 ls33">=</span><span class="ws13a">csv<span class="fc6 ls34">.</span>writer(f)</span></div><div class="t m0 x15 hf y11c0 ff8 fs5 fc0 sc0 ls0 ws13a">f_csv<span class="fc6">.</span>writerow(headers)</div><div class="t m0 x15 hf y137d ff8 fs5 fc0 sc0 ls0 ws13a">f_csv<span class="fc6">.</span>writerows(rows)</div><div class="t m0 x0 h9 y137e ff1 fs3 fc0 sc0 ls0">如果你有一个字典序列的数据，可以像这样做：</div><div class="t m0 x5 hf y23 ff8 fs5 fc0 sc0 ls0 ws155">headers <span class="fc6 ls32">=</span><span class="ls34">[<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13a">Symbol<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">Price<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">Date<span class="ff9 ls34">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">Time</span><span class="ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">Change<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">Volume</span><span class="ls34">&apos;</span></span>]</div><div class="t m0 x5 hf y137f ff8 fs5 fc0 sc0 ls0 ws13c">rows <span class="fc6 ls32">=</span><span class="ws13a">[{<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">Symbol<span class="ff9 ws13b">&apos;</span></span><span class="ls34">:<span class="ff9 fc9">&apos;</span></span><span class="fc9">AA<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">Price<span class="ff9 ls34">&apos;</span></span>:<span class="fc7">39.48</span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">Date<span class="ff9 ls34">&apos;</span></span>:<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">6/11/2007<span class="ff9 ws13b">&apos;</span></span>,</span></div><div class="t m0 x16 hf y1380 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">Time</span>&apos;<span class="ff8 fc0">:</span>&apos;<span class="ff8 ls0 ws13a">9:36am</span>&apos;<span class="ff8 fc0 ls32">,</span>&apos;<span class="ff8 ls0 ws13a">Change</span>&apos;<span class="ff8 fc0">:<span class="fc6 ls0 ws13a">-<span class="fc7">0.18</span></span><span class="ls33">,</span></span>&apos;<span class="ff8 ls0 ws13a">Volume</span>&apos;<span class="ff8 fc0 ls0 ws13a">:<span class="fc7">181800</span>},</span></div><div class="t m0 x16 hf y573 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">Symbol</span>&apos;</span>:<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">AIG</span>&apos;</span><span class="ls32">,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Price</span><span class="ls0 ws13b">&apos;</span></span><span class="ls33">:<span class="fc7 ls0 ws13a">71.38</span>,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Date</span>&apos;</span>:<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">6/11/2007</span>&apos;</span><span class="ls0">,</span></div><div class="t m0 x16 hf y574 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">Time</span>&apos;<span class="ff8 fc0">:</span>&apos;<span class="ff8 ls0 ws13a">9:36am</span>&apos;<span class="ff8 fc0 ls32">,</span>&apos;<span class="ff8 ls0 ws13a">Change</span>&apos;<span class="ff8 fc0">:<span class="fc6 ls0 ws13a">-<span class="fc7">0.15</span></span><span class="ls33">,</span></span>&apos;<span class="ff8 ls0 ws13a">Volume</span>&apos;<span class="ff8 fc0 ls32">:<span class="fc7 ls0 ws13a">195500<span class="fc0">},</span></span></span></div><div class="t m0 x16 hf y575 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">Symbol</span>&apos;</span>:<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">AXP</span>&apos;</span><span class="ls32">,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Price</span><span class="ls0 ws13b">&apos;</span></span><span class="ls33">:<span class="fc7 ls0 ws13a">62.58</span>,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Date</span>&apos;</span>:<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">6/11/2007</span>&apos;</span><span class="ls0">,</span></div><div class="t m0 x16 hf y576 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">Time</span>&apos;<span class="ff8 fc0">:</span>&apos;<span class="ff8 ls0 ws13a">9:36am</span>&apos;<span class="ff8 fc0 ls32">,</span>&apos;<span class="ff8 ls0 ws13a">Change</span>&apos;<span class="ff8 fc0">:<span class="fc6 ls0 ws13a">-<span class="fc7">0.46</span></span><span class="ls33">,</span></span>&apos;<span class="ff8 ls0 ws13a">Volume</span>&apos;<span class="ff8 fc0 ls32">:<span class="fc7 ls0 ws13a">935000<span class="fc0">},</span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">8.1.<span class="_ _5"> </span>6.1 <span class="ff1 ws16b">读写 </span><span class="ws777">CSV <span class="ff1 ws778">数据 </span>170</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
