<div id="pf113" class="pf w0 h0" data-page-no="113"><div class="pc pc113 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg113.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 hf y1e8 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__set__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, instance, value):</span></span></span></div><div class="t m0 x16 hf y1e9 ff7 fs5 fca sc0 ls0 ws157">if not <span class="ff8 ws13a">isinstance<span class="fc0 ws4">(value, expected_type):</span></span></div><div class="t m0 x17 hf y1ea ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws16d">expected <span class="ff9 ls32">&apos;</span><span class="fc6 ls33">+</span></span></span>str<span class="fc0">(expected_type))</span></span></div><div class="t m0 x16 hf y903 ff8 fs5 fc0 sc0 ls0 ws13a">super_set(<span class="fca">self</span><span class="ws13b">, instance, value)</span></div><div class="t m0 x15 hf y1ec ff8 fs5 fc0 sc0 ls0 ws13a">cls<span class="fc6 ls34">.</span><span class="ws155">__set__ <span class="fc6 ls32">=</span>__set__</span></div><div class="t m0 x15 hf y904 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">cls</span></div><div class="t m0 x5 h11 y907 ffa fs5 fcd sc0 ls0 ws4"># Decorator for unsigned values</div><div class="t m0 x5 hf y908 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">Unsigned<span class="fc0">(cls):</span></span></div><div class="t m0 x15 hf y909 ff8 fs5 fc0 sc0 ls0 ws16e">super_set <span class="fc6 ls33">=</span><span class="ws13a">cls<span class="fc6 ls34">.</span>__set__</span></div><div class="t m0 x15 hf ybd9 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__set__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, instance, value):</span></span></span></div><div class="t m0 x16 hf y90a ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws15f">value <span class="fc6 ls33">&lt;<span class="fc7 ls34">0</span></span>:</span></div><div class="t m0 x17 hf y61 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">ValueError<span class="fc0 ls34">(<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13b">Expected &gt;= 0<span class="ff9 ls34">&apos;</span><span class="fc0">)</span></span></span></div><div class="t m0 x16 hf y90b ff8 fs5 fc0 sc0 ls0 ws13a">super_set(<span class="fca">self</span><span class="ws13b">, instance, value)</span></div><div class="t m0 x15 hf y90d ff8 fs5 fc0 sc0 ls0 ws13a">cls<span class="fc6 ls34">.</span><span class="ws155">__set__ <span class="fc6 ls32">=</span>__set__</span></div><div class="t m0 x15 hf y90e ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">cls</span></div><div class="t m0 x5 h11 y911 ffa fs5 fcd sc0 ls0 ws4"># Decorator for allowing sized values</div><div class="t m0 x5 hf ye93 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">MaxSized<span class="fc0">(cls):</span></span></div><div class="t m0 x15 hf y912 ff8 fs5 fc0 sc0 ls0 ws2a3">super_init <span class="fc6 ls32">=</span><span class="ws13a">cls<span class="fc6">.</span>__init__</span></div><div class="t m0 x15 hf y914 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, name</span><span class="fc6">=<span class="fca">None</span></span><span class="ls33">,</span><span class="fc6">**</span>opts):</span></span></div><div class="t m0 x16 hf y915 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">size</span><span class="ls32">&apos;</span></span>not in <span class="ff8 fc0">opts:</span></div><div class="t m0 x17 hf y916 ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">missing size option<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x16 hf y917 ff8 fs5 fc0 sc0 ls0 ws13a">super_init(<span class="fca">self</span><span class="ws13b">, name, </span><span class="fc6">**</span>opts)</div><div class="t m0 x15 hf y918 ff8 fs5 fc0 sc0 ls0 ws13a">cls<span class="fc6 ls34">.</span><span class="ws1f5">__init__ <span class="fc6 ls33">=</span>__init__</span></div><div class="t m0 x15 hf y91a ff8 fs5 fc0 sc0 ls0 ws16e">super_set <span class="fc6 ls33">=</span><span class="ws13a">cls<span class="fc6 ls34">.</span>__set__</span></div><div class="t m0 x15 hf y91b ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__set__<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, instance, value):</span></span></span></div><div class="t m0 x16 hf y91c ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 ws13a">len<span class="fc0 ws155">(value) <span class="fc6 ws23d">&gt;= </span></span>self<span class="fc6 ls34">.</span><span class="fc0">size:</span></span></div><div class="t m0 x17 hf y91d ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">ValueError<span class="fc0 ls34">(<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws4">size must be &lt; <span class="ff9 ls32">&apos;</span><span class="fc6 ls33">+</span></span>str<span class="fc0 ls34">(</span>self<span class="fc6 ls34">.</span><span class="fc0">size))</span></span></div><div class="t m0 x16 hf y91e ff8 fs5 fc0 sc0 ls0 ws13a">super_set(<span class="fca">self</span><span class="ws13b">, instance, value)</span></div><div class="t m0 x15 hf y920 ff8 fs5 fc0 sc0 ls0 ws13a">cls<span class="fc6 ls34">.</span><span class="ws155">__set__ <span class="fc6 ls32">=</span>__set__</span></div><div class="t m0 x15 hf y921 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">cls</span></div><div class="t m0 x5 h11 y923 ffa fs5 fcd sc0 ls0 ws4"># Specialized descriptors</div><div class="t m0 x5 hf y924 ff7 fs5 fc12 sc0 ls0 ws156">@Typed<span class="ff8 fc0 ls34">(<span class="fca ls0 ws13a">int<span class="fc0">)</span></span></span></div><div class="t m0 x5 hf y925 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Integer<span class="ff8 fc0">(Descriptor):</span></span></div><div class="t m0 x15 h10 yedf ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">10.13.<span class="_ _5"> </span>8.13 <span class="ff1 wsb03">实现数据模型的类型约束 </span>266</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
