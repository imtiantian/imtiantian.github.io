<div id="pf157" class="pf w0 h0" data-page-no="157"><div class="pc pc157 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg157.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hd y112 ff2 fs4 fc4 sc0 ls0 ws211">11.16<span class="_ _e"> </span>9.16 <span class="fc2 ls198">*</span><span class="wsc37">a<span class="_ _c"></span>rgs <span class="ff1 ls7c">和</span><span class="wsc38">**kw<span class="_ _c"></span>a<span class="_ _c"></span>rgs <span class="ff1">的强制参数签名</span></span></span></div><div class="t m0 x5 he y113 ff2 fs2 fc4 sc0 ls0 wsadf">11.16.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y2b2 ff1 fs3 fc0 sc0 ls0 wsc39">你有一个函<span class="_ _6"></span>数或方法，它使<span class="_ _6"></span>用 <span class="ff4 wsc3a">*args </span><span class="ls199">和</span><span class="ff4 wsc3b">**kw<span class="_ _c"></span>args <span class="ff1 wsa0">作<span class="_ _6"></span>为参数，这样使<span class="_ _6"></span>得它比较通用，</span></span></div><div class="t m0 x5 h9 y23ec ff1 fs3 fc0 sc0 ls0">但有时候你想检查传递进来的参数是不是某个你想要的类型。</div><div class="t m0 x5 he y23ed ff2 fs2 fc4 sc0 ls0 wsadf">11.16.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y6f0 ff1 fs3 fc0 sc0 ls14 wsc3c">对任何涉及到操作函数调用签名的问题<span class="_ _1"></span>，你都应该使用 <span class="ff6 ls0 ws183">inspect </span><span class="ws174">模块中的签名特</span></div><div class="t m0 x5 h9 y6f1 ff1 fs3 fc0 sc0 ls22 ws119">性。我们最主要关注两个<span class="_ _1"></span>类：<span class="ff6 ls0 wsc3d">Signature </span><span class="ls125">和<span class="ff6 ls0 wsc3d">Parameter </span></span>。下面是一个创建函数前面的<span class="_ _1"></span></div><div class="t m0 x5 h9 y23ee ff1 fs3 fc0 sc0 ls0">交互例子：</div><div class="t m0 x5 hf y23ef ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws2f0">inspect </span><span class="ws146">import <span class="ff8 fc0 ws4">Signature, Parameter</span></span></span></div><div class="t m0 x5 h11 y23f0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Make a signature for a func(x, y=42, *, z=None)</span></div><div class="t m0 x5 hf y2083 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">parms <span class="fc6 ls33">=</span><span class="ws13b">[ Parameter(<span class="ff9 fc9 ls34">&apos;<span class="ff8">x</span>&apos;</span>, Parameter<span class="fc6 ws13a">.</span>POSITIONAL_OR_KEYWORD),</span></span></div><div class="t m0 x5 hf y23f1 ff7 fs5 fc5 sc0 ls0 ws1a3">... <span class="ff8 fc0 ws13a">Parameter(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">y<span class="ff9 ls34">&apos;</span></span><span class="ws4">, Parameter<span class="fc6 ls34">.</span><span class="ws13b">POSITIONAL_OR_KEYWORD, default</span></span><span class="fc6">=<span class="fc7">42</span></span>),</span></div><div class="t m0 x5 hf yb88 ff7 fs5 fc5 sc0 ls0 ws1a3">... <span class="ff8 fc0 ws13a">Parameter(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">z<span class="ff9 ls34">&apos;</span></span><span class="ws4">, Parameter<span class="fc6 ls34">.</span><span class="ws13b">KEYWORD_ONLY, default<span class="fc6 ls34">=</span></span></span><span class="fca">None</span><span class="ws13b">) ]</span></span></div><div class="t m0 x5 hf y23f2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws158">sig <span class="fc6 ls32">=</span>Signature(parms)</span></div><div class="t m0 x5 hf y23f3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(sig)</span></span></div><div class="t m0 x5 hf y23f4 ff8 fs5 fc8 sc0 ls0 ws4">(x, y=42, *, z=None)</div><div class="t m0 x5 hf y23f5 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y23f6 ff1 fs3 fc0 sc0 ls0 wsc3e">一<span class="_ _6"></span>旦<span class="_ _0"></span>你<span class="_ _6"></span>有<span class="_ _0"></span>了<span class="_ _6"></span>一<span class="_ _6"></span>个<span class="_ _0"></span>签<span class="_ _6"></span>名<span class="_ _0"></span>对<span class="_ _6"></span>象，<span class="_ _0"></span>你<span class="_ _6"></span>就<span class="_ _6"></span>可<span class="_ _0"></span>以<span class="_ _6"></span>使<span class="_ _0"></span>用<span class="_ _6"></span>它<span class="_ _0"></span>的 <span class="ff6 wsc3f">bind() </span><span class="ls19a wsc40">方法很容易的将它绑定到<span class="_ _d"></span></span></div><div class="t m0 x5 h9 y23f7 ff6 fs3 fc0 sc0 ls0 ws17d">*args <span class="ff1 ls4">和</span><span class="ws26f">**kwargs <span class="ff1">上去。下面是一个简单的演示：</span></span></div><div class="t m0 x5 hf y23f8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">def <span class="ff8 fcb ws13a">func<span class="fc0">(<span class="fc6 ls34">*</span><span class="ws458">args, </span><span class="fc6">**</span>kwargs):</span></span></span></div><div class="t m0 x5 hf y23f9 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fc0 ws150">bound_values <span class="fc6 ls33">=</span><span class="ws13a">sig<span class="fc6 ls34">.</span>bind(<span class="fc6 ls34">*</span><span class="ws15f">args, <span class="fc6 ls34">**</span>kwargs)</span></span></span></div><div class="t m0 x5 hf yb8c ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws139">for <span class="ff8 fc0 ws13b">name, value </span><span class="ws160">in <span class="ff8 fc0 ws13a">bound_values<span class="fc6 ls34">.</span>arguments<span class="fc6">.</span>items():</span></span></span></div><div class="t m0 x5 hf y23fa ff7 fs5 fc5 sc0 ls0 ws1a3">... <span class="fca ws156">print<span class="ff8 fc0">(name,value)</span></span></div><div class="t m0 x5 h10 y23fb ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 h11 y23fc ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Try various examples</span></div><div class="t m0 x5 hf y23fd ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">func(<span class="fc7">1</span><span class="ls33">,</span><span class="fc7">2</span><span class="ws4">, z</span><span class="fc6">=<span class="fc7 ls34">3</span></span>)</span></div><div class="t m0 x5 hf y23fe ff8 fs5 fc8 sc0 ls0 ws4">x 1</div><div class="t m0 x5 hf y1a8c ff8 fs5 fc8 sc0 ls0 ws4">y 2</div><div class="t m0 x5 hf y23ff ff8 fs5 fc8 sc0 ls0 ws4">z 3</div><div class="t m0 x5 hf y2400 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">func(<span class="fc7">1</span>)</span></div><div class="t m0 x5 hf y2401 ff8 fs5 fc8 sc0 ls0 ws4">x 1</div><div class="t m0 x5 hf y2402 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">func(<span class="fc7">1</span><span class="ws4">, z<span class="fc6 ls34">=<span class="fc7">3</span></span>)</span></span></div><div class="t m0 x5 hf y2403 ff8 fs5 fc8 sc0 ls0 ws4">x 1</div><div class="t m0 x5 hf y2404 ff8 fs5 fc8 sc0 ls0 ws4">z 3</div><div class="t m0 x5 hf y2405 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">func(y<span class="fc6 ls34">=<span class="fc7">2</span></span><span class="ws13b">, x<span class="fc6 ls34">=</span></span><span class="fc7">1</span>)</span></div><div class="t m0 x5 hf y2406 ff8 fs5 fc8 sc0 ls0 ws4">x 1</div><div class="t m0 x5 hf y2407 ff8 fs5 fc8 sc0 ls0 ws4">y 2</div><div class="t m0 x5 hf y2408 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">func(<span class="fc7">1</span><span class="ls33">,</span><span class="fc7">2</span><span class="ls33">,<span class="fc7 ls34">3</span><span class="ls32">,<span class="fc7 ls34">4</span></span></span>)</span></div><div class="t m0 x5 hf y2409 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x5 h11 y240a ffa fs5 fcd sc0 ls0">...</div><div class="t m0 x15 hf y240b ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;/usr/local/lib/python3.3/inspect.py&quot;</span><span class="ws4">, line <span class="fc7 ws13a">1972</span><span class="ls33">,</span><span class="ff7 fca ws157">in </span>_bind</span></div><div class="t m0 x16 hf y240c ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">too many positional arguments<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">11.16.<span class="_ _5"> </span>9.16 <span class="fc2 wsc41">*</span><span class="wsc42">a<span class="_ _c"></span>rgs <span class="ff1 ls7f">和</span><span class="wsc43">**kwa<span class="_ _c"></span>rgs <span class="ff1 wsc44">的强制参数签名 </span>334</span></span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
