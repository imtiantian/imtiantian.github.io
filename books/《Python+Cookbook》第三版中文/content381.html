<div id="pf17d" class="pf w0 h0" data-page-no="17d"><div class="pc pc17d w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg17d.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hd y112 ff2 fs4 fc4 sc0 ls0 ws211">12.6<span class="_ _e"> </span>10.6 <span class="ff1">重新加载模块</span></div><div class="t m0 x5 he y113 ff2 fs2 fc4 sc0 ls0 ws212">12.6.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y2b2 ff1 fs3 fc0 sc0 ls0">你想重新加载已经加载的模块，因为你对其源码进行了修改。</div><div class="t m0 x5 he y2744 ff2 fs2 fc4 sc0 ls0 ws212">12.6.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y2b4 ff1 fs3 fc0 sc0 ls0 wsc">使用 <span class="ff4 wsd4c">imp.reload() </span>来重新加载先前加载的模块。举个例子：</div><div class="t m0 x5 h10 y2745 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">spam</span></span></div><div class="t m0 x5 h10 y2746 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">imp</span></span></div><div class="t m0 x5 hf y2747 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">imp<span class="fc6 ls34">.</span>reload(spam)</span></div><div class="t m0 x5 hf y4d8 ff8 fs5 fc8 sc0 ls0 ws155">&lt;module <span class="ff9 ls34">&apos;</span><span class="ws13a">spam<span class="ff9 ls33">&apos;</span><span class="ws13c">from <span class="ff9 ws13b">&apos;</span></span>./spam.py<span class="ff9 ls34">&apos;</span>&gt;</span></div><div class="t m0 x5 hf y2748 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y2749 ff2 fs2 fc4 sc0 ls0 ws212">12.6.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y274a ff1 fs3 fc0 sc0 ls3a ws153">重新加载模块在开发和调试过程中常常很有用。但在生产环境中的代码使用会不安</div><div class="t m0 x5 h9 y274b ff1 fs3 fc0 sc0 ls0">全，因为它并不总是像您期望的那样工作。</div><div class="t m0 x0 h7 y274c ff4 fs3 fc0 sc0 ls0 wsd4d">reload() <span class="ff1 ls19 ws22a">擦除了模块底层字典的内容，并通过重新执行模块的源代码来刷新它。模<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y180b ff1 fs3 fc0 sc0 ls13 wse5">块对象本身的身份保持不变<span class="_ _1"></span>。因此，该操作在程序中所有已经被导入了的地方更新了<span class="_ _c"></span></div><div class="t m0 x5 h9 y274d ff1 fs3 fc0 sc0 ls0">模块。</div><div class="t m0 x0 h7 y10f5 ff1 fs3 fc0 sc0 ls0 wsa0">尽管<span class="_ _6"></span>如此，<span class="ff4 wsd4e">reload() </span>没<span class="_ _6"></span>有更<span class="_ _6"></span>新像<span class="ff4 wsd4f">”from mo<span class="_ _6"></span>dule imp<span class="_ _6"></span>ort name” </span><span class="wsd50">这<span class="_ _6"></span>样使用 <span class="ff4 wsd51">imp<span class="_ _6"></span>ort </span></span>语<span class="_ _6"></span>句</div><div class="t m0 x5 h9 y274e ff1 fs3 fc0 sc0 ls0">导入的定义。举个例子：</div><div class="t m0 x5 h11 y274f ffa fs5 fcd sc0 ls0 ws4"># spam.py</div><div class="t m0 x5 hf y2750 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">bar<span class="fc0">():</span></span></div><div class="t m0 x15 hf y2751 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">bar<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y2752 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">grok<span class="fc0">():</span></span></div><div class="t m0 x15 hf y2753 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">grok<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x0 h9 y2754 ff1 fs3 fc0 sc0 ls0">现在启动交互式会话：</div><div class="t m0 x5 h10 y2755 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">spam</span></span></div><div class="t m0 x5 hf y2756 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws218">spam </span><span class="ws146">import <span class="ff8 fc0">grok</span></span></span></div><div class="t m0 x5 hf y1c35 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam<span class="fc6 ls34">.</span>bar()</span></div><div class="t m0 x5 hf y2757 ff8 fs5 fc8 sc0 ls0">bar</div><div class="t m0 x5 hf y4a8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">grok()</span></div><div class="t m0 x5 hf y2001 ff8 fs5 fc8 sc0 ls0">grok</div><div class="t m0 x5 hf y2758 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y2759 ff1 fs3 fc0 sc0 ls0 ws38">不退出 <span class="ff4 ws5c">Python </span><span class="ws14">修改 <span class="ff4 wsd52">spam.p<span class="_ _1"></span>y <span class="ff1 ws38">的源码，将 </span><span class="wsd53">grok() <span class="ff1">函数改成这样：</span></span></span></span></div><div class="t m0 x5 hf y575 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">grok<span class="fc0">():</span></span></div><div class="t m0 x15 hf y576 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">New grok<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">12.6.<span class="_ _5"> </span>10.6 <span class="ff1 ws999">重新加载模块 </span>372</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
