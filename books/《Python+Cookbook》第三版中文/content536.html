<div id="pf218" class="pf w0 h0" data-page-no="218"><div class="pc pc218 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg218.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hd y112 ff2 fs4 fc4 sc0 ls0 ws211">16.7<span class="_ _e"> </span>14.7 <span class="ff1">捕获所有异常</span></div><div class="t m0 x5 he y113 ff2 fs2 fc4 sc0 ls0 ws212">16.7.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y658 ff1 fs3 fc0 sc0 ls0">怎样捕获代码中的所有异常？</div><div class="t m0 x5 he y6ee ff2 fs2 fc4 sc0 ls0 ws212">16.7.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y340e ff1 fs3 fc0 sc0 ls0 ws14">想要捕获所有的异常，可以直接捕获 <span class="ff6 ws4d0">Exception </span>即可：</div><div class="t m0 x5 hf y340f ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x3c hf y3410 ff8 fs5 fc6 sc0 ls34 ws76a">...</div><div class="t m0 x5 hf y3411 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 ws16e">Exception </span><span class="ws160">as <span class="ff8 fc0">e:</span></span></div><div class="t m0 x3c hf y3412 ff8 fs5 fc6 sc0 ls34 ws76a">...</div><div class="t m0 x3c hf y3413 ff8 fs5 fc0 sc0 ls0 ws13a">log(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Reason:<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, e)<span class="_ _41"> </span><span class="ffa fcd"># Important!</span></span></div><div class="t m0 x0 h9 y3414 ff1 fs3 fc0 sc0 ls14 ws12c2">这个将会捕获除了 <span class="ff6 ls0 ws12c3">SystemExit </span><span class="ls121">、<span class="ff6 ls0 ws12bf">KeyboardInterrupt </span><span class="ls114">和<span class="ff6 ls0 ws230">GeneratorExit <span class="ff1 wsa0">之<span class="_ _6"></span>外<span class="_ _6"></span>的</span></span></span></span></div><div class="t m0 x5 h9 y3415 ff1 fs3 fc0 sc0 ls0 ws63">所有异常。如果你还想捕获这三个异常，将 <span class="ff6 ws1d1">Exception </span><span class="wsc">改成 <span class="ff6 ws317">BaseException </span>即可。</span></div><div class="t m0 x5 he y3416 ff2 fs2 fc4 sc0 ls0 ws212">16.7.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y3417 ff1 fs3 fc0 sc0 ls3a ws153">捕获所有异常通常是由于程序员在某些复杂操作中并不能记住所有可能的异常。如</div><div class="t m0 x5 h9 y3418 ff1 fs3 fc0 sc0 ls0">果你不是很细心的人，这也是编写不易调试代码的一个简单方法。</div><div class="t m0 x0 h9 y3419 ff1 fs3 fc0 sc0 ls0 wsa0">正因如此，如果你选择<span class="_ _6"></span>捕获所有异常，那么在某<span class="_ _6"></span>个地方（比如日志文件、打<span class="_ _6"></span>印异常</div><div class="t m0 x5 h9 y341a ff1 fs3 fc0 sc0 ls1e ws111">到屏幕<span class="_ _1"></span>）打印确切原因就比较重要了<span class="_ _1"></span>。如果你没有这样做，有时候你看到异常打<span class="_ _1"></span>印时</div><div class="t m0 x5 h9 y341b ff1 fs3 fc0 sc0 ls0">可能摸不着头脑，就像下面这样：</div><div class="t m0 x5 hf y30aa ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">parse_int<span class="fc0">(s):</span></span></div><div class="t m0 x15 hf y341c ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x16 hf y341d ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls33">=<span class="fca ls0 ws13a">int<span class="fc0">(v)</span></span></span></div><div class="t m0 x15 hf y341e ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 ws13a">Exception<span class="fc0">:</span></span></div><div class="t m0 x16 hf y341f ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="fc9 ls0 ws13a">&quot;Couldn<span class="ff9 ls34">&apos;</span><span class="ws13b">t parse&quot;<span class="fc0">)</span></span></span></span></div><div class="t m0 x0 h9 y3420 ff1 fs3 fc0 sc0 ls0">试着运行这个函数，结果如下：</div><div class="t m0 x5 hf y3421 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">parse_int(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">n/a<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y3422 ff8 fs5 fc8 sc0 ls0 ws13a">Couldn<span class="ff9 ls34">&apos;</span><span class="ws4">t parse</span></div><div class="t m0 x5 hf y20 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">parse_int(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">42<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y3423 ff8 fs5 fc8 sc0 ls0 ws13a">Couldn<span class="ff9 ls34">&apos;</span><span class="ws4">t parse</span></div><div class="t m0 x5 hf y3424 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y3425 ff1 fs3 fc0 sc0 ls0 wsa0">这时候你就会挠头想：<span class="_ _3"></span>“这咋回事啊？<span class="_ _1d"></span>”假如你像下面这样重写这个函数：</div><div class="t m0 x5 hf y3395 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">parse_int<span class="fc0">(s):</span></span></div><div class="t m0 x15 hf y17ed ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x16 hf y3396 ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls33">=<span class="fca ls0 ws13a">int<span class="fc0">(v)</span></span></span></div><div class="t m0 x15 hf y3426 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 ws16e">Exception </span><span class="ws157">as <span class="ff8 fc0">e:</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">16.7.<span class="_ _36"> </span>14.7 <span class="ff1 ws999">捕获所有异常 </span>527</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
