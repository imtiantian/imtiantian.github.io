<div id="pf229" class="pf w0 h0" data-page-no="229"><div class="pc pc229 w0 h0"><img class="bi x13 y5 w2 hb" alt="" src="bg229.png"/><div class="t m0 xe h8 y76 ff2 fs3 fc0 sc0 ls0">CHAPTER</div><div class="t m0 x10 hc y77 ff2 fs4 fc0 sc0 ls0">SEVENTEEN</div><div class="t m0 x51 hd y78 ff1 fs4 fc0 sc0 ls0 ws117f">第十五章：<span class="ff2 ls23d">C</span>语言扩展</div><div class="t m0 x0 h7 y79 ff1 fs3 fc0 sc0 ls0 ws133f">本<span class="_ _6"></span>章<span class="_ _6"></span>着眼<span class="_ _6"></span>于<span class="_ _6"></span>从 <span class="ff4 ws1340">Python </span><span class="ws1341">访<span class="_ _6"></span>问 <span class="ff4 ls23e">C</span><span class="ws1342">代<span class="_ _6"></span>码<span class="_ _6"></span>的<span class="_ _6"></span>问<span class="_ _6"></span>题。<span class="_ _6"></span>许<span class="_ _6"></span>多 <span class="ff4 ws1340">Python </span><span class="ws1343">内<span class="_ _6"></span>置库<span class="_ _6"></span>是<span class="_ _6"></span>用 <span class="ff4 ls23f">C</span><span class="wsa0">写<span class="_ _6"></span>的，<span class="_ _6"></span>访</span></span></span></span></div><div class="t m0 x5 h7 ycf ff1 fs3 fc0 sc0 ls124">问<span class="ff4 ls240">C</span><span class="ls0 ws1344">是让 <span class="ff4 ws1345">Python </span></span><span class="ls6b ws28f">的对现有库进行交互一个重要的组成部分。这也是一个当你面临从</span></div><div class="t m0 x5 h7 yd0 ff4 fs3 fc0 sc0 ls0 ws1346">Python 2 <span class="ff1 lsf0">到</span><span class="ws1347">Python 3 <span class="ff1 ws1348">扩展代码的问题。虽然 </span><span class="ws1349">Python <span class="ff1 ws49d">提供了一个广泛的编程 </span><span class="wsa5">API<span class="ff1 wsa0">，实</span></span></span></span></div><div class="t m0 x5 h7 yd1 ff1 fs3 fc0 sc0 lse ws134a">际上有很多方法来处理 <span class="ff4 ls20">C</span><span class="wsd8">的代码。相比试图给出对于每一个可能的工具<span class="_ _1"></span>或技术的详细</span></div><div class="t m0 x5 h7 y520 ff1 fs3 fc0 sc0 ls0 ws134b">参<span class="_ _6"></span>考，<span class="_ _6"></span>我么<span class="_ _6"></span>采<span class="_ _6"></span>用<span class="_ _6"></span>的<span class="_ _6"></span>是<span class="_ _6"></span>是<span class="_ _6"></span>集<span class="_ _6"></span>中<span class="_ _6"></span>在<span class="_ _6"></span>一<span class="_ _6"></span>个小<span class="_ _6"></span>片<span class="_ _6"></span>段<span class="_ _6"></span>的 <span class="ff4 ws134c">C<span class="_ _6"></span>+<span class="_ _6"></span>+ </span><span class="ls48 ws242">代码<span class="_ _1"></span>，以及一些有代表性的例子来<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y20ac ff1 fs3 fc0 sc0 ls13 wse5">展示如何与代码交互<span class="_ _1"></span>。这个目标是提供一系列的编程模板，有经验的程序员可以扩展<span class="_ _c"></span></div><div class="t m0 x5 h9 y20ad ff1 fs3 fc0 sc0 ls0">自己的使用。</div><div class="t m0 x0 h9 y90f ff1 fs3 fc0 sc0 ls0">这里是我们将在大部分秘籍中工作的代码：</div><div class="t m0 x5 hf y35ab ff8 fs5 fc0 sc0 ls0 ws4">/* sample.c */_method</div><div class="t m0 x5 hf y35ac ff8 fs5 fc0 sc0 ls0 ws4">#include &lt;math.h&gt;</div><div class="t m0 x5 hf y35ad ff8 fs5 fc0 sc0 ls0 ws4">/* Compute the greatest common divisor */</div><div class="t m0 x5 hf y1e27 ff8 fs5 fc0 sc0 ls0 ws4">int gcd(int x, int y) {</div><div class="t m0 x15 hf y35ae ff8 fs5 fc0 sc0 ls0 ws4">int g = y;</div><div class="t m0 x15 hf y13b4 ff8 fs5 fc0 sc0 ls0 ws4">while (x &gt; 0) {</div><div class="t m0 x16 hf y35af ff8 fs5 fc0 sc0 ls0 ws13b">g = x;</div><div class="t m0 x16 hf y35b0 ff8 fs5 fc0 sc0 ls0 ws4">x = y % x;</div><div class="t m0 x16 hf y35b1 ff8 fs5 fc0 sc0 ls0 ws13b">y = g;</div><div class="t m0 x15 hf y18 ff8 fs5 fc0 sc0 ls0">}</div><div class="t m0 x15 hf y35b2 ff8 fs5 fc0 sc0 ls0 ws13b">return g;</div><div class="t m0 x5 hf y15bd ff8 fs5 fc0 sc0 ls0">}</div><div class="t m0 x5 hf y35b3 ff8 fs5 fc0 sc0 ls0 ws4">/* Test if (x0,y0) is in the Mandelbrot set or not */</div><div class="t m0 x5 hf y35b4 ff8 fs5 fc0 sc0 ls0 ws4">int in_mandel(double x0, double y0, int n) {</div><div class="t m0 x15 hf y35b5 ff8 fs5 fc0 sc0 ls0 ws13b">double x=0,y=0,xtemp;</div><div class="t m0 x15 hf y35b6 ff8 fs5 fc0 sc0 ls0 ws4">while (n &gt; 0) {</div><div class="t m0 x16 hf y35b7 ff8 fs5 fc0 sc0 ls0 ws4">xtemp = x*x - y*y + x0;</div><div class="t m0 x16 hf y35b8 ff8 fs5 fc0 sc0 ls0 ws4">y = 2*x*y + y0;</div><div class="t m0 x16 hf y35b9 ff8 fs5 fc0 sc0 ls0 ws13b">x = xtemp;</div><div class="t m0 x16 hf y35ba ff8 fs5 fc0 sc0 ls0 ws13b">n -= 1;</div><div class="t m0 x16 hf y35bb ff8 fs5 fc0 sc0 ls0 ws4">if (x*x + y*y &gt; 4) return 0;</div><div class="t m0 x15 hf y35bc ff8 fs5 fc0 sc0 ls0">}</div><div class="t m0 x15 hf y35bd ff8 fs5 fc0 sc0 ls0 ws13b">return 1;</div><div class="t m0 x5 hf y35be ff8 fs5 fc0 sc0 ls0">}</div><div class="t m0 x5 hf y35bf ff8 fs5 fc0 sc0 ls0 ws4">/* Divide two numbers */</div><div class="t m0 x26 h8 y29 ff2 fs3 fc0 sc0 ls0">544</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
