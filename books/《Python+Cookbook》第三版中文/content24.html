<div id="pf18" class="pf w0 h0" data-page-no="18"><div class="pc pc18 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg18.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h7 y2a ff1 fs3 fc0 sc0 ls0 wsc">为了阐明这些，先假定 <span class="ff4 ws5d">Item </span>实例是不支持排序的：</div><div class="t m0 x5 hf y212 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; a = Item(<span class="ff9 ls34">&apos;</span><span class="ws13a">foo<span class="ff9 ls34">&apos;</span>)</span></div><div class="t m0 x5 hf y213 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; b = Item(<span class="ff9 ls34">&apos;</span><span class="ws13a">bar<span class="ff9 ls34">&apos;</span>)</span></div><div class="t m0 x5 hf y214 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; a &lt; b</div><div class="t m0 x5 hf y215 ff8 fs5 fc0 sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x5 hf y216 ff8 fs5 fc0 sc0 ls0 ws4">File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</div><div class="t m0 x5 hf y217 ff8 fs5 fc0 sc0 ls0 ws4">TypeError: unorderable types: Item() &lt; Item()</div><div class="t m0 x5 hf y218 ff8 fs5 fc0 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y219 ff1 fs3 fc0 sc0 ls51 ws1c6">如果你使用元组 <span class="ff6 ls0 ws1c7">(priority,<span class="_ _11"> </span>item) </span><span class="ws1c8">，只要两个元素的优先级不同就能比较。但是</span></div><div class="t m0 x5 h9 y21a ff1 fs3 fc0 sc0 ls0">如果两个元素优先级一样的话，那么比较操作就会跟之前一样出错：</div><div class="t m0 x5 hf y21b ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; a = (1, Item(<span class="ff9 ls34">&apos;</span><span class="ws13a">foo<span class="ff9 ls34">&apos;</span>))</span></div><div class="t m0 x5 hf y21c ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; b = (5, Item(<span class="ff9 ls34">&apos;</span><span class="ws13a">bar<span class="ff9 ls34">&apos;</span>))</span></div><div class="t m0 x5 hf y21d ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; a &lt; b</div><div class="t m0 x5 hf y21e ff8 fs5 fc0 sc0 ls0">True</div><div class="t m0 x5 hf y21f ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; c = (1, Item(<span class="ff9 ls34">&apos;</span><span class="ws13a">grok<span class="ff9 ls34">&apos;</span>))</span></div><div class="t m0 x5 hf y220 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; a &lt; c</div><div class="t m0 x5 hf y221 ff8 fs5 fc0 sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x5 hf y222 ff8 fs5 fc0 sc0 ls0 ws4">File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</div><div class="t m0 x5 hf y223 ff8 fs5 fc0 sc0 ls0 ws4">TypeError: unorderable types: Item() &lt; Item()</div><div class="t m0 x5 hf y224 ff8 fs5 fc0 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y225 ff1 fs3 fc0 sc0 ls0 ws1c9">通过<span class="_ _6"></span>引入另<span class="_ _6"></span>外的 <span class="ff6 ws1ca">index </span><span class="ls19 ws1cb">变量组成三元组 </span><span class="ff6 ws1cc">(priority, index, item)<span class="_ _7"> </span></span><span class="wsa0">，就能<span class="_ _6"></span>很好<span class="_ _6"></span>的</span></div><div class="t m0 x5 h7 y226 ff1 fs3 fc0 sc0 ls3a ws1cd">避免上面的错误，因为不可能有两个元素有相同的 <span class="ff6 ls0 ws1ce">index <span class="ff1 wsa0">值。<span class="ff4 ws1cf">Python </span>在做元组比较时</span></span></div><div class="t m0 x5 h9 y227 ff1 fs3 fc0 sc0 ls0">候，如果前面的比较以及可以确定结果了，后面的比较操作就不会发生了：</div><div class="t m0 x5 hf y228 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls34">(<span class="fc7 ls0 ws13a">1</span><span class="ls33">,<span class="fc7 ls0 ws13a">0<span class="fc0 ws4">, Item(<span class="ff9 fc9 ws13b">&apos;</span></span><span class="fc9">foo<span class="ff9 ls34">&apos;</span><span class="fc0">))</span></span></span></span></span></span></div><div class="t m0 x5 hf y229 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=</span><span class="ls34">(<span class="fc7 ls0 ws13a">5</span><span class="ls33">,<span class="fc7 ls0 ws13a">1<span class="fc0 ws4">, Item(<span class="ff9 fc9 ws13b">&apos;</span></span><span class="fc9">bar<span class="ff9 ls34">&apos;</span><span class="fc0">))</span></span></span></span></span></span></div><div class="t m0 x5 hf y22a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">c<span class="fc6 ls33">=</span><span class="ls34">(<span class="fc7 ls0 ws13a">1</span><span class="ls33">,<span class="fc7 ls0 ws13a">2<span class="fc0 ws4">, Item(<span class="ff9 fc9 ws13b">&apos;</span></span><span class="fc9">grok<span class="ff9 ls34">&apos;</span><span class="fc0">))</span></span></span></span></span></span></div><div class="t m0 x5 hf y22b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">&lt;</span><span class="ls0">b</span></span></div><div class="t m0 x5 hf y22c ff8 fs5 fc8 sc0 ls0">True</div><div class="t m0 x5 hf y22d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">&lt;</span><span class="ls0">c</span></span></div><div class="t m0 x5 hf y22e ff8 fs5 fc8 sc0 ls0">True</div><div class="t m0 x5 hf y22f ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y230 ff1 fs3 fc0 sc0 ls30 ws138">如果你想在多个线程中使用同一个队列，那么你需要增加适当的锁和信号量机制<span class="_ _c"></span>。</div><div class="t m0 x5 h7 y231 ff1 fs3 fc0 sc0 ls0 ws14">可以查看 <span class="ff4 ws1d0">12.3 </span>小节的例子演示是怎样做的。</div><div class="t m0 x0 h9 y232 ff6 fs3 fc0 sc0 ls0 ws17d">heapq <span class="ff1">模块的官方文档有更详细的例子程序以及对于堆理论及其实现的详细说明。</span></div><div class="t m0 x5 hd y233 ff2 fs4 fc4 sc0 ls0 ws134">3.6<span class="_ _e"> </span>1.6 <span class="ff1">字典中的键映射多个值</span></div><div class="t m0 x5 he y234 ff2 fs2 fc4 sc0 ls0 ws135">3.6.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y235 ff1 fs3 fc0 sc0 ls0 ws38">怎样实现一个键对应多个值的字典 <span class="ff4 ls1b">(</span><span class="wsc">也叫 <span class="ff6 ws1d1">multidict <span class="ff4 ls1b">)</span></span>？</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">3.6.<span class="_ _5"> </span>1.6 <span class="ff1 ws1d2">字典中的键映射多个值 </span>15</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
