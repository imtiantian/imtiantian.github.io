<div id="pfb6" class="pf w0 h0" data-page-no="b6"><div class="pc pcb6 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgb6.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws135">8.2.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y236 ff6 fs3 fc0 sc0 ls0 ws793">json <span class="ff1 ls12 ws794">模块提供了一种很简单的方式来编码和解码 </span><span class="ff4 ws795">JSON <span class="ff1 wsa0">数据。<span class="_ _6"></span>其中<span class="_ _6"></span>两个<span class="_ _6"></span>主要<span class="_ _6"></span>的<span class="_ _6"></span>函</span></span></div><div class="t m0 x5 h7 y237 ff1 fs3 fc0 sc0 ls0 ws670">数<span class="_ _6"></span>是 <span class="ff6 ws796">json.dumps() </span><span class="ls12b">和</span><span class="ff6 ws672">json.loads() </span><span class="ws797">，<span class="_ _0"></span>要<span class="_ _6"></span>比<span class="_ _6"></span>其<span class="_ _6"></span>他<span class="_ _0"></span>序<span class="_ _6"></span>列<span class="_ _6"></span>化<span class="_ _0"></span>函<span class="_ _6"></span>数<span class="_ _6"></span>库<span class="_ _6"></span>如 <span class="ff4 ws798">pickle </span><span class="wsa0">的<span class="_ _6"></span>接<span class="_ _6"></span>口<span class="_ _0"></span>少<span class="_ _6"></span>得</span></span></div><div class="t m0 x5 h7 y238 ff1 fs3 fc0 sc0 ls0 ws38">多。下面演示如何将一个 <span class="ff4 ws5c">Python </span><span class="ws63">数据结构转换为 <span class="ff4 wsa5">JSON</span>：</span></div><div class="t m0 x5 h10 y13be ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">json</span></div><div class="t m0 x5 hf y13bf ff8 fs5 fc0 sc0 ls0 ws13c">data <span class="fc6 ls32">=</span>{</div><div class="t m0 x15 hf y13c0 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">name</span><span class="ls32">&apos;<span class="ff8 fc0">:</span></span>&apos;<span class="ff8 ls0 ws13a">ACME</span>&apos;<span class="ff8 fc0 ls0">,</span></div><div class="t m0 x15 hf y13c1 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">shares</span><span class="ls32">&apos;<span class="ff8 fc0 ls33">:<span class="fc7 ls0 ws13a">100<span class="fc0">,</span></span></span></span></div><div class="t m0 x15 hf y13c2 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">price</span><span class="ls33">&apos;<span class="ff8 fc0 ls32">:<span class="fc7 ls0">542.23</span></span></span></div><div class="t m0 x5 hf y13c3 ff8 fs5 fc0 sc0 ls0">}</div><div class="t m0 x5 hf y13c4 ff8 fs5 fc0 sc0 ls0 ws16d">json_str <span class="fc6 ls32">=</span><span class="ws13a">json<span class="fc6 ls34">.</span>dumps(data)</span></div><div class="t m0 x0 h7 y13c5 ff1 fs3 fc0 sc0 ls0 ws38">下面演示如何将一个 <span class="ff4 ws5f">JSON </span>编码的字符串转换回一个 <span class="ff4 ws5c">Python </span>数据结构：</div><div class="t m0 x5 hf y13c6 ff8 fs5 fc0 sc0 ls0 ws13c">data <span class="fc6 ls32">=</span><span class="ws13a">json<span class="fc6 ls34">.</span>loads(json_str)</span></div><div class="t m0 x0 h9 y13c7 ff1 fs3 fc0 sc0 ls36 ws799">如果你要处理的是文件而不是字符串<span class="_ _c"></span>，你可以使用 <span class="ff6 ls0 ws79a">json.dump() </span><span class="ls9a">和<span class="ff6 ls0">json.load()</span></span></div><div class="t m0 x5 h7 y13c8 ff1 fs3 fc0 sc0 ls0 ws14">来编码和解码 <span class="ff4 ws5f">JSON </span>数据。例如：</div><div class="t m0 x5 h11 y13c9 ffa fs5 fcd sc0 ls0 ws4"># Writing JSON data</div><div class="t m0 x5 hf y13ca ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">data.json<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">w<span class="ff9">&apos;</span></span></span><span class="ls32">)</span></span></span><span class="ws160">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y13cb ff8 fs5 fc0 sc0 ls0 ws13a">json<span class="fc6 ls34">.</span><span class="ws13b">dump(data, f)</span></div><div class="t m0 x5 h11 y13cc ffa fs5 fcd sc0 ls0 ws4"># Reading data back</div><div class="t m0 x5 hf y13cd ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">data.json<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">r<span class="ff9">&apos;</span></span></span><span class="ls32">)</span></span></span><span class="ws160">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y13ce ff8 fs5 fc0 sc0 ls0 ws13c">data <span class="fc6 ls32">=</span><span class="ws13a">json<span class="fc6 ls34">.</span>load(f)</span></div><div class="t m0 x5 he y13cf ff2 fs2 fc4 sc0 ls0 ws135">8.2.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 y13d0 ff4 fs3 fc0 sc0 ls0 ws79b">JSON <span class="ff1 ls68 ws79c">编码支持的基本数据类型为 </span><span class="ff6 ws26d">None <span class="ff1 ls12c">，</span>bool <span class="ff1 ls12c">，</span><span class="ws79d">int <span class="ff1 ls12c">，</span><span class="ws5f3">float <span class="ff1 ls12d">和</span></span>str <span class="ff1 wsa0">，以及包</span></span></span></div><div class="t m0 x5 h7 y13d1 ff1 fs3 fc0 sc0 ls18 ws79e">含这些类型数据的 <span class="ff4 ls0 wsa5">lists</span><span class="ls12e">，<span class="ff4 ls0 ws79f">tuples </span><span class="lsc9">和<span class="ff4 ls0 wsa5">dictionaries</span></span></span><span class="ws7a0">。对于 <span class="ff4 ls0 wsa5">dictionaries</span><span class="ls12e">，<span class="ff4 ls0 ws7a1">k<span class="_ _1"></span>eys <span class="ff1 ls18 ws110">需要是字符串</span></span></span></span></div><div class="t m0 x5 h7 y13d2 ff1 fs3 fc0 sc0 ls0 ws7a2">类型 <span class="ff4 wsa5">(</span><span class="ls2d ws7a3">字典中任何非字符串类型的 </span><span class="ff4 ws7a4">key </span><span class="ls2d ws132">在编码时会先转换为字符串<span class="_ _c"></span><span class="ff4 ls0 wsa5">)<span class="ff1 ls2d ws7a5">。为了遵循 </span>JSON</span></span></div><div class="t m0 x5 h7 y1140 ff1 fs3 fc0 sc0 ls3a ws7a6">规范，你应该只编码 <span class="ff4 ls0 ws4eb">Python </span><span class="ls12f">的<span class="ff4 ls0 ws7a7">lists </span><span class="lsad">和<span class="ff4 ls0 wsa5">dictionaries<span class="ff1 ws7a8">。而且，在 </span><span class="ws7a9">web <span class="ff1 wsa0">应用程序中，顶层</span></span></span></span></span></div><div class="t m0 x5 h9 y13d3 ff1 fs3 fc0 sc0 ls0">对象被编码为一个字典是一个标准做法。</div><div class="t m0 x0 h7 y13d4 ff4 fs3 fc0 sc0 ls0 ws7aa">JSON <span class="ff1 ls42 ws7ab">编码的格式对于 </span><span class="ws7ac">Python <span class="ff1 wsa0">语法<span class="_ _6"></span>而已<span class="_ _6"></span>几乎<span class="_ _6"></span>是完<span class="_ _6"></span>全一<span class="_ _6"></span>样的，<span class="_ _6"></span>除了<span class="_ _6"></span>一些<span class="_ _6"></span>小的<span class="_ _6"></span>差异<span class="_ _6"></span>之</span></span></div><div class="t m0 x5 h7 y13d5 ff1 fs3 fc0 sc0 ls0 wsa0">外。比如，<span class="ff4 ws7ad">T<span class="_ _8"></span>rue <span class="ff1 ws7ae">会被映射为 </span><span class="wsa5">true<span class="ff1 wsa0">，</span><span class="ws7af">F<span class="_ _8"></span>alse <span class="ff1 ws2c9">被映射为 </span><span class="wsa5">false<span class="ff1 ws7b0">，而 </span><span class="ws7b1">None <span class="ff1 ws7ae">会被映射为 </span></span>n<span class="_ _1"></span>ull<span class="ff1 wsa0">。下</span></span></span></span></span></div><div class="t m0 x5 h9 y13d6 ff1 fs3 fc0 sc0 ls0">面是一个例子，演示了编码后的字符串效果：</div><div class="t m0 x5 hf y42b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">json<span class="fc6 ls34">.</span>dumps(<span class="fca">False</span>)</span></div><div class="t m0 x5 hf y13d7 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">false<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y13d8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">d<span class="fc6 ls33">=</span><span class="ls34">{</span></span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">a<span class="ff9">&apos;</span><span class="fc0 ls32">:<span class="fca ls0 ws13a">True<span class="fc0">,</span></span></span></span></span></div><div class="t m0 x5 hf y42e ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">b</span>&apos;<span class="ff8 fc0 ls32">:</span>&apos;<span class="ff8 ls0 ws13a">Hello</span>&apos;</span><span class="ff8 fc0">,</span></div><div class="t m0 x5 hf y42f ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">c</span>&apos;<span class="ff8 fc0 ls32">:<span class="fca ls0 ws13a">None<span class="fc0">}</span></span></span></span></div><div class="t m0 x5 hf y430 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">json<span class="fc6 ls34">.</span>dumps(d)</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">8.2.<span class="_ _5"> </span>6.2 <span class="ff1 ws16b">读写 </span><span class="ws791">JSON <span class="ff1 ws792">数据 </span>173</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
