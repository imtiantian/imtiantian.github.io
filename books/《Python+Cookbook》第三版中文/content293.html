<div id="pf125" class="pf w0 h0" data-page-no="125"><div class="pc pc125 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg125.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 hf y1ab ff8 fs5 fc0 sc0 ls0 ws13a">Point(<span class="fc7 ls34">3</span><span class="ls32">,<span class="fc7 ls34">2</span></span>)</div><div class="t m0 x5 hf y1ac ff8 fs5 fc0 sc0 ls0">]</div><div class="t m0 x5 h11 y1ad ffa fs5 fcd sc0 ls0 ws4"># Sort by distance from origin (0, 0)</div><div class="t m0 x5 hf y1ae ff8 fs5 fc0 sc0 ls0 ws13a">points<span class="fc6 ls34">.</span>sort(key<span class="fc6 ls34">=</span>operator<span class="fc6 ls34">.</span>methodcaller(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">distance<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="fc7 ls34">0</span><span class="ls33">,</span></span><span class="fc7">0</span>))</div><div class="t m0 x5 he y1f12 ff2 fs2 fc4 sc0 ls0 wsadf">10.20.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y1f13 ff1 fs3 fc0 sc0 ls0 wsa0">调用一个方法实际上<span class="_ _6"></span>是两部独立操作，第一步是<span class="_ _6"></span>查找属性，第二步是函数<span class="_ _6"></span>调用。因</div><div class="t m0 x5 h9 y1f14 ff1 fs3 fc0 sc0 lsa8 wsb4f">此，为了调用某个方法<span class="_ _1"></span>，你可以首先通过 <span class="ff6 ls0 ws8e5">getattr() </span><span class="ws3de">来查找到这个属性，然后再去以<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y1f15 ff1 fs3 fc0 sc0 ls0">函数方式调用它即可。</div><div class="t m0 x0 h9 y1f16 ff6 fs3 fc0 sc0 ls0 wsb50">operator.methodcaller() <span class="ff1 wsa0">创建一个可调用对象，<span class="_ _1"></span>并同时提供所有必要参数，<span class="_ _1"></span>然后</span></div><div class="t m0 x5 h9 y1595 ff1 fs3 fc0 sc0 ls0">调用的时候只需要将实例对象传递给它即可，比如：</div><div class="t m0 x5 hf y1f17 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">p<span class="fc6 ls33">=</span><span class="ls0 ws13a">Point(<span class="fc7 ls34">3</span></span>,<span class="fc7 ls34">4</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y1f18 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0 ws13a">operator<span class="fc6">.</span>methodcaller(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">distance<span class="ff9 ls34">&apos;</span></span><span class="ls33">,</span><span class="fc7">0</span><span class="ls33">,</span><span class="fc7">0</span>)</span></span></div><div class="t m0 x5 hf y1f19 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">d(p)</span></div><div class="t m0 x5 hf y1f1a ff8 fs5 fc8 sc0 ls0">5.0</div><div class="t m0 x5 hf y1f1b ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1f1c ff1 fs3 fc0 sc0 lse wsb51">通过方法名称字符串来调用方法通常出现在需要模拟 <span class="ff6 ls0 ws179">case </span><span class="wsd8">语句或实现访问者模式<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y1f1d ff1 fs3 fc0 sc0 ls0">的时候。参考下一小节获取更多高级例子。</div><div class="t m0 x5 hd y1f1e ff2 fs4 fc4 sc0 ls0 ws211">10.21<span class="_ _e"> </span>8.21 <span class="ff1">实现访问者模式</span></div><div class="t m0 x5 he y1f1f ff2 fs2 fc4 sc0 ls0 wsadf">10.21.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y1f20 ff1 fs3 fc0 sc0 ls3a ws153">你要处理由大量不同类型的对象组成的复杂数据结构，每一个对象都需要需要进行</div><div class="t m0 x5 h9 y1f21 ff1 fs3 fc0 sc0 ls1e ws111">不同的处理<span class="_ _1"></span>。比如，遍历一个树形结<span class="_ _1"></span>构，然后根据每个节点的相应状态执行不同<span class="_ _1"></span>的操</div><div class="t m0 x5 h9 y1f22 ff1 fs3 fc0 sc0 ls0">作。</div><div class="t m0 x5 he y1f23 ff2 fs2 fc4 sc0 ls0 wsadf">10.21.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y1f24 ff1 fs3 fc0 sc0 ls3a ws153">这里遇到的问题在编程领域中是很普遍的，有时候会构建一个由大量不同对象组成</div><div class="t m0 x5 h9 y1f25 ff1 fs3 fc0 sc0 ls0">的数据结构。假设你要写一个表示数学表达式的程序，那么你可能需要定义如下的类：</div><div class="t m0 x5 hf y1f26 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Node<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 h10 y1f27 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hf y1801 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">UnaryOperator<span class="ff8 fc0">(Node):</span></span></div><div class="t m0 x15 hf y1f28 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, operand):</span></span></span></div><div class="t m0 x16 hf y1f29 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws155">operand </span><span class="ls33">=</span><span class="fc0">operand</span></span></div><div class="t m0 x5 hf y1f2a ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">BinaryOperator<span class="ff8 fc0">(Node):</span></span></div><div class="t m0 x15 hf y1f2b ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, left, right):</span></span></span></div><div class="t m0 x16 hf y1f2c ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws13c">left </span><span class="ls33">=</span><span class="fc0">left</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">10.21.<span class="_ _5"> </span>8.21 <span class="ff1 wsb0f">实现访问者模式 </span>284</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
