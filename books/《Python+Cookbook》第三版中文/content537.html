<div id="pf219" class="pf w0 h0" data-page-no="219"><div class="pc pc219 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg219.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x16 hf y1ab ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="fc9 ls0 ws13a">&quot;Couldn<span class="ff9 ls34">&apos;</span><span class="ws13b">t parse&quot;<span class="fc0">)</span></span></span></span></div><div class="t m0 x16 hf y1ac ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Reason:</span>&apos;</span><span class="ls0 ws13b">, e)</span></span></div><div class="t m0 x0 h9 y2ad9 ff1 fs3 fc0 sc0 ls0">这时候你能获取如下输出，指明了有个编程错误：</div><div class="t m0 x5 hf y2632 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">parse_int(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">42<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y2633 ff8 fs5 fc8 sc0 ls0 ws13a">Couldn<span class="ff9 ls34">&apos;</span><span class="ws4">t parse</span></div><div class="t m0 x5 hf y3427 ff8 fs5 fc8 sc0 ls0 ws4">Reason: global name <span class="ff9 ws13b">&apos;</span><span class="ls34">v<span class="ff9 ls32">&apos;</span></span>is not defined</div><div class="t m0 x5 hf y3428 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y3429 ff1 fs3 fc0 sc0 ls0 wsa0">很明显，你应该尽可能<span class="_ _6"></span>将异常处理器定义的精准<span class="_ _6"></span>一些。不过，要是你必须捕<span class="_ _6"></span>获所有</div><div class="t m0 x5 h9 ye3a ff1 fs3 fc0 sc0 ls0">异常，确保打印正确的诊断信息或将异常传播出去，这样不会丢失掉异常。</div><div class="t m0 x5 hd y2440 ff2 fs4 fc4 sc0 ls0 ws211">16.8<span class="_ _e"> </span>14.8 <span class="ff1">创建自定义异常</span></div><div class="t m0 x5 he y342a ff2 fs2 fc4 sc0 ls0 ws212">16.8.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y342b ff1 fs3 fc0 sc0 ls0">在你构建的应用程序中，你想将底层异常包装成自定义的异常。</div><div class="t m0 x5 he y342c ff2 fs2 fc4 sc0 ls0 ws212">16.8.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y2c19 ff1 fs3 fc0 sc0 ls0 ws12c4">创建新的异常很简单—<span class="_ _8"></span>—定义新的类，<span class="_ _c"></span>让它继承自 <span class="ff6 ws12c5">Exception </span>（或者是任何一个已</div><div class="t m0 x5 h9 y342d ff1 fs3 fc0 sc0 ls0 wsa0">存在的异常类型）<span class="_ _f"></span>。例如，如果你编写网络相关的程序，<span class="_ _1"></span>你可能会定义一些类似如下的</div><div class="t m0 x5 h9 y342e ff1 fs3 fc0 sc0 ls0">异常：</div><div class="t m0 x5 hf y342f ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">NetworkError<span class="ff8 fc0 ls34">(</span></span><span class="ff8 ws13a">Exception<span class="fc0">):</span></span></div><div class="t m0 x15 h10 y1223 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hf y47 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">HostnameError<span class="ff8 fc0">(NetworkError):</span></span></div><div class="t m0 x15 h10 y3430 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hf y3431 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">TimeoutError<span class="ff8 fc0">(NetworkError):</span></span></div><div class="t m0 x15 h10 y3432 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hf y3433 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">ProtocolError<span class="ff8 fc0">(NetworkError):</span></span></div><div class="t m0 x15 h10 y3434 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x0 h9 y1f6d ff1 fs3 fc0 sc0 ls0">然后用户就可以像通常那样使用这些异常了，例如：</div><div class="t m0 x5 hf y3435 ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x15 hf y3436 ff8 fs5 fc0 sc0 ls0 ws158">msg <span class="fc6 ls32">=</span><span class="ls34">s<span class="fc6">.</span></span>recv()</div><div class="t m0 x5 hf y3437 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 fc0 ws3c7">TimeoutError </span><span class="ws157">as <span class="ff8 fc0">e:</span></span></div><div class="t m0 x15 hf y2834 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x5 hf y3438 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 fc0 ws147">ProtocolError </span><span class="ws157">as <span class="ff8 fc0">e:</span></span></div><div class="t m0 x15 hf y2835 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">16.8.<span class="_ _36"> </span>14.8 <span class="ff1 ws600">创建自定义异常 </span>528</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
