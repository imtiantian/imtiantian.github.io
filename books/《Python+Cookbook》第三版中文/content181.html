<div id="pfb5" class="pf w0 h0" data-page-no="b5"><div class="pc pcb5 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgb5.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x16 h11 y334 ffa fs5 fcd sc0 ls0 ws13b"># Process row</div><div class="t m0 x16 hf y335 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h7 y13a1 ff1 fs3 fc0 sc0 ls42 ws186">还有重要的一点需要强调的是，<span class="ff4 ls0 ws786">csv </span>产生的数据都是字符串类型的<span class="_ _c"></span>，它不会做任何</div><div class="t m0 x5 h9 y13a2 ff1 fs3 fc0 sc0 ls1e ws111">其他类型的转换<span class="_ _1"></span>。如果你需要做这样的类型转换<span class="_ _1"></span>，你必须自己手动去实现。下面<span class="_ _1"></span>是一</div><div class="t m0 x5 h7 y13a3 ff1 fs3 fc0 sc0 ls0 ws14">个在 <span class="ff4 ws5d">CSV </span>数据上执行其他类型转换的例子：</div><div class="t m0 x5 hf y13a4 ff8 fs5 fc0 sc0 ls0 ws16e">col_types <span class="fc6 ls33">=</span><span class="ws13a">[<span class="fca">str</span><span class="ls32">,</span><span class="fca">float</span><span class="ls32">,</span><span class="fca">str</span><span class="ls33">,</span><span class="fca">str</span><span class="ls32">,</span><span class="fca">float</span><span class="ls33">,</span><span class="fca">int</span>]</span></div><div class="t m0 x5 hf y13a5 ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">stocks.csv<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws160">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y13a6 ff8 fs5 fc0 sc0 ls0 ws15f">f_csv <span class="fc6 ls33">=</span><span class="ws13a">csv<span class="fc6 ls34">.</span>reader(f)</span></div><div class="t m0 x15 hf y13a7 ff8 fs5 fc0 sc0 ls0 ws155">headers <span class="fc6 ls32">=</span><span class="fca ws13a">next</span>(f_csv)</div><div class="t m0 x15 hf y13a8 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws158">row </span><span class="ws157">in <span class="ff8 fc0">f_csv:</span></span></div><div class="t m0 x16 h11 y13a9 ffa fs5 fcd sc0 ls0 ws4"># Apply conversions to the row items</div><div class="t m0 x16 hf y13aa ff8 fs5 fc0 sc0 ls0 ws158">row <span class="fc6 ls32">=</span><span class="fca ws13a">tuple</span><span class="ws511">(convert(value) <span class="ff7 fca ws139">for </span><span class="ws4">convert, value <span class="ff7 fca ws157">in <span class="ff8 ws13a">zip</span></span><span class="ws13b">(col_types, row))</span></span></span></div><div class="t m0 x16 hf y13ab ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h9 y13ac ff1 fs3 fc0 sc0 ls0">另外，下面是一个转换字典中特定字段的例子：</div><div class="t m0 x5 hf y13ad ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">Reading as dicts with type conversion<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y63c ff8 fs5 fc0 sc0 ls0 ws208">field_types <span class="fc6 ls32">=</span><span class="ws4">[ (<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">Price<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="fca ws13a">float</span>),</span></div><div class="t m0 x18 hf y13ae ff8 fs5 fc0 sc0 ls0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Change<span class="ff9 ls34">&apos;</span></span><span class="ls33">,</span><span class="fca">float</span>),</div><div class="t m0 x18 hf y360 ff8 fs5 fc0 sc0 ls0 ws13a">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Volume<span class="ff9 ls34">&apos;</span></span><span class="ls33">,</span><span class="fca">int</span><span class="ws13b">) ]</span></div><div class="t m0 x5 hf y13af ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">stocks.csv<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws160">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf y13b0 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws158">row </span><span class="ws157">in <span class="ff8 fc0 ws13a">csv<span class="fc6 ls34">.</span>DictReader(f):</span></span></div><div class="t m0 x16 hf y13b1 ff8 fs5 fc0 sc0 ls0 ws13a">row<span class="fc6 ls34">.</span><span class="ws13b">update((key, conversion(row[key]))</span></div><div class="t m0 x18 hf y13b2 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13b">key, conversion </span><span class="ws157">in <span class="ff8 fc0">field_types)</span></span></div><div class="t m0 x16 hf y13b3 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(row)</span></div><div class="t m0 x0 h7 y13b4 ff1 fs3 fc0 sc0 ls48 ws242">通常来讲<span class="_ _1"></span>，你可能并不想过多去考虑这些转换问题。在实际情况中<span class="_ _c"></span>，<span class="ff4 ls0 ws787">CSV </span>文件都</div><div class="t m0 x5 h9 y13b5 ff1 fs3 fc0 sc0 ls0 wsa0">或<span class="_ _6"></span>多或<span class="_ _6"></span>少<span class="_ _6"></span>有<span class="_ _6"></span>些<span class="_ _6"></span>缺<span class="_ _6"></span>失的<span class="_ _6"></span>数<span class="_ _6"></span>据，<span class="_ _6"></span>被<span class="_ _6"></span>破<span class="_ _6"></span>坏的<span class="_ _6"></span>数<span class="_ _6"></span>据<span class="_ _6"></span>以<span class="_ _6"></span>及<span class="_ _6"></span>其它<span class="_ _6"></span>一<span class="_ _6"></span>些<span class="_ _6"></span>让<span class="_ _6"></span>转<span class="_ _6"></span>换失<span class="_ _6"></span>败<span class="_ _6"></span>的<span class="_ _6"></span>问<span class="_ _6"></span>题。<span class="_ _6"></span>因<span class="_ _6"></span>此，除</div><div class="t m0 x5 h7 y13b6 ff1 fs3 fc0 sc0 ls1f ws788">非你的数据确实有保障是准确无误的，否则你必须考虑这些问题 <span class="ff4 ls0 wsa5">(</span><span class="ws113">你可能需要增加合适</span></div><div class="t m0 x5 h7 y13b7 ff1 fs3 fc0 sc0 ls0 wsa0">的错误处理机制<span class="ff4 wsa5">)</span>。</div><div class="t m0 x0 h7 y13b8 ff1 fs3 fc0 sc0 ls0 ws789">最后，<span class="_ _6"></span>如果<span class="_ _6"></span>你读<span class="_ _6"></span>取 <span class="ff4 ws77c">CSV </span><span class="ls17 wsf6">数据的目的是做数据分析和统计的话，你可能需要看一看<span class="_ _c"></span></span></div><div class="t m0 x5 h9 y96a ff6 fs3 fc0 sc0 ls0 ws78a">Pandas <span class="ff1 wsa0">包。<span class="_ _6"></span></span>Pandas <span class="ff1 ls49 ws78b">包含了一个非常方便的函数叫 </span><span class="ws78c">pandas.read csv() <span class="ff1 ls49 ws1a6">，它可以加载</span></span></div><div class="t m0 x5 h7 y13b9 ff4 fs3 fc0 sc0 ls0 ws78d">CSV <span class="ff1 ws78e">数据到一个 <span class="ff6 ws78f">DataFrame </span><span class="ls68 ws23f">对象中去。然后利用这个对象你就可以生成各种形式的统</span></span></div><div class="t m0 x5 h7 y13ba ff1 fs3 fc0 sc0 ls0 ws63">计、过滤数据以及执行其他高级操作了。在 <span class="ff4 ws1d0">6.13 </span>小节中会有这样一个例子。</div><div class="t m0 x5 hd y13bb ff2 fs4 fc4 sc0 ls0 ws134">8.2<span class="_ _e"> </span>6.2 <span class="ff1 ws763">读写 </span><span class="ws790">JSON <span class="ff1">数据</span></span></div><div class="t m0 x5 he y13bc ff2 fs2 fc4 sc0 ls0 ws135">8.2.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y13bd ff1 fs3 fc0 sc0 ls0 wsc">你想读写 <span class="ff4 wsd0">JSON(Ja<span class="_ _1"></span>v<span class="_ _c"></span>aScript Ob<span class="_ _6"></span>ject Notation) <span class="ff1">编码格式的数据。</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">8.2.<span class="_ _5"> </span>6.2 <span class="ff1 ws16b">读写 </span><span class="ws791">JSON <span class="ff1 ws792">数据 </span>172</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
