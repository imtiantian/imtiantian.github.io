<div id="pf90" class="pf w0 h0" data-page-no="90"><div class="pc pc90 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg90.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h10 yb1e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">sys</span></span></div><div class="t m0 x5 hf yb1f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">/etc/passwd<span class="ff9 ls34">&apos;</span></span>)</span></span></span></span></div><div class="t m0 x5 hf yb20 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ws15f">chunk </span><span class="ws157">in <span class="ff8 ws13a">iter<span class="fc0 ls34">(</span></span><span class="ws156">lambda<span class="ff8 fc0 ws4">: f<span class="fc6 ws13a">.<span class="fc0">read(<span class="fc7">10</span><span class="ws15c">), <span class="ff9 fc9 ws13b">&apos;&apos;</span>):</span></span></span></span></span></span></span></div><div class="t m0 x5 hf yb21 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fc0 ls32">n<span class="fc6 ls33">=</span><span class="ls0 ws13a">sys<span class="fc6 ls34">.</span>stdout<span class="fc6 ls34">.</span>write(chunk)</span></span></div><div class="t m0 x5 h10 yb22 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf yb23 ff8 fs5 fc8 sc0 ls0 ws4">nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false</div><div class="t m0 x5 hf yb24 ff8 fs5 fc8 sc0 ls0 ws4">root:*:0:0:System Administrator:/var/root:/bin/sh</div><div class="t m0 x5 hf yb25 ff8 fs5 fc8 sc0 ls0 ws4">daemon:*:1:1:System Services:/var/root:/usr/bin/false</div><div class="t m0 x5 hf yb26 ff8 fs5 fc8 sc0 ls0 ws4">_uucp:*:4:4:Unix to Unix Copy Protocol:/var/spool/uucp:/usr/sbin/uucico</div><div class="t m0 x5 h10 yb27 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf yfda ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he yfdb ff2 fs2 fc4 sc0 ls0 ws212">6.16.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 yfdc ff6 fs3 fc0 sc0 ls0 ws612">iter <span class="ff1 ls2b ws613">函数一个鲜为人知的特性是它接受一个可选的 </span><span class="ws21c">callable <span class="ff1 ls2b ws614">对象和一个标记 </span><span class="ff4 wsa5">(<span class="ff1">结</span></span></span></div><div class="t m0 x5 h7 yfdd ff1 fs3 fc0 sc0 lsb">尾<span class="ff4 lsfb">)</span><span class="ls1f ws113">值作为输入参数。当以这种方式使用的时候，它会创建一个迭代器，这个迭代器会</span></div><div class="t m0 x5 h9 yfde ff1 fs3 fc0 sc0 ls0 ws14">不断调用 <span class="ff6 ws1f3">callable </span>对象直到返回值和标记值相等为止。</div><div class="t m0 x0 h7 yfdf ff1 fs3 fc0 sc0 ls56 ws615">这种特殊的方法对于一些特定的会被重复调用的函数很有效果<span class="_ _1"></span>，比如涉及到 <span class="ff4 ls0 wsa5">I/<span class="_ _6"></span>O</span></div><div class="t m0 x5 h9 y8e9 ff1 fs3 fc0 sc0 ls1e ws111">调用的函数<span class="_ _1"></span>。举例来讲，如果你想从<span class="_ _1"></span>套接字或文件中以数据块的方式读取数据<span class="_ _1"></span>，通常</div><div class="t m0 x5 h9 yfe0 ff1 fs3 fc0 sc0 ls2c ws616">你得要不断重复的执行 <span class="ff6 ls0 ws617">read() </span><span class="lsd6">或<span class="ff6 ls0 ws617">recv() </span></span><span class="ws12f">，并在后面紧跟一个文件结尾测试来决定是</span></div><div class="t m0 x5 h9 yfe1 ff1 fs3 fc0 sc0 ls36 ws618">否终止<span class="_ _c"></span>。<span class="_ _6"></span>这节中的方案使用一个简单的 <span class="ff6 ls0 ws619">iter() </span><span class="ws14a">调用就可以将两者结合起来了<span class="_ _c"></span>。其中</span></div><div class="t m0 x5 h9 yfe2 ff6 fs3 fc0 sc0 ls0 ws61a">lambda <span class="ff1 ws61b">函数参数是为<span class="_ _6"></span>了创建一个无参的 </span><span class="ws61c">callable <span class="ff1 ws61d">对<span class="_ _6"></span>象，并为 </span><span class="ws61e">recv <span class="ff1 lsfc">或</span></span></span>read() <span class="ff1 ls35 ws144">方法提</span></div><div class="t m0 x5 h9 yfe3 ff1 fs3 fc0 sc0 ls0 ws14">供了 <span class="ff6 ws17a">size </span>参数。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">6.16.<span class="_ _5"> </span>4.16 <span class="ff1 ws36c">迭代器代替 </span><span class="ws610">while <span class="ff1 ws611">无限循环 </span>135</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
