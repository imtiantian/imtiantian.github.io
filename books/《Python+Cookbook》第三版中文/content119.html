<div id="pf77" class="pf w0 h0" data-page-no="77"><div class="pc pc77 w0 h0"><img class="bi x13 y5 w2 hb" alt="" src="bg77.png"/><div class="t m0 xe h8 y76 ff2 fs3 fc0 sc0 ls0">CHAPTER</div><div class="t m0 x25 hc y77 ff2 fs4 fc0 sc0 ls0">SIX</div><div class="t m0 x14 hd y78 ff1 fs4 fc0 sc0 ls0">第四章：迭代器与生成器</div><div class="t m0 x0 h7 y79 ff1 fs3 fc0 sc0 ls0 ws552">迭代是 <span class="ff4 ws453">Python </span><span class="ls18 ws110">最强大的功能之一。初看起来，你可能会简单的认为迭代只不过是</span></div><div class="t m0 x5 h9 ycf ff1 fs3 fc0 sc0 ls0 wsa0">处<span class="_ _6"></span>理<span class="_ _0"></span>序<span class="_ _6"></span>列<span class="_ _6"></span>中<span class="_ _0"></span>元<span class="_ _6"></span>素<span class="_ _6"></span>的<span class="_ _0"></span>一<span class="_ _6"></span>种<span class="_ _6"></span>方<span class="_ _0"></span>法。<span class="_ _6"></span>然<span class="_ _6"></span>而，<span class="_ _0"></span>绝<span class="_ _6"></span>非<span class="_ _6"></span>仅<span class="_ _0"></span>仅<span class="_ _6"></span>就<span class="_ _6"></span>是<span class="_ _0"></span>如<span class="_ _6"></span>此，<span class="_ _0"></span>还<span class="_ _6"></span>有<span class="_ _6"></span>很<span class="_ _0"></span>多<span class="_ _6"></span>你<span class="_ _6"></span>可<span class="_ _0"></span>能<span class="_ _6"></span>不<span class="_ _6"></span>知<span class="_ _0"></span>道<span class="_ _6"></span>的，</div><div class="t m0 x5 h7 yd0 ff1 fs3 fc0 sc0 ls22 ws553">比如创建你自己的迭代器对象，在 <span class="ff4 ls0 ws554">itertools </span><span class="ws119">模块中使用有用的迭代模式，构造生成器<span class="_ _1"></span></span></div><div class="t m0 x5 h9 yd1 ff1 fs3 fc0 sc0 ls0">函数等等。这一章目的就是向你展示跟迭代有关的各种常见问题。</div><div class="t m0 x0 h7 yd2 ff4 fs3 fc0 sc0 ls0 wsa5">Con<span class="_ _1"></span>ten<span class="_ _1"></span>ts:</div><div class="t m0 x5 hd yd3 ff2 fs4 fc4 sc0 ls0 ws134">6.1<span class="_ _e"> </span>4.1 <span class="ff1">手动遍历迭代器</span></div><div class="t m0 x5 he yd4 ff2 fs2 fc4 sc0 ls0 ws135">6.1.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 yd4d ff1 fs3 fc0 sc0 ls0 ws38">你想遍历一个可迭代对象中的所有元素，但是却不想使用 <span class="ff4 ws555">for </span>循环。</div><div class="t m0 x5 he yd4e ff2 fs2 fc4 sc0 ls0 ws135">6.1.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 yd4f ff1 fs3 fc0 sc0 ls0 ws556">为了手动的遍历可迭代对象，使用 <span class="ff6 ws557">next() </span><span class="ws558">函数并在代码中捕获 <span class="ff6 ws559">StopIteration </span>异</span></div><div class="t m0 x5 h9 yd50 ff1 fs3 fc0 sc0 ls0">常。比如，下面的例子手动读取一个文件中的所有行：</div><div class="t m0 x5 hf yd51 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">manual_iter<span class="fc0">():</span></span></div><div class="t m0 x15 hf yd52 ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0 ls34">(<span class="ff9 fc9">&apos;</span></span><span class="fc9">/etc/passwd<span class="ff9 ls34">&apos;</span><span class="fc0 ls32">)</span></span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x16 hf yd53 ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x17 hf yd54 ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 ws13a">True<span class="fc0">:</span></span></div><div class="t m0 x18 hf yd55 ff8 fs5 fc0 sc0 ls0 ws161">line <span class="fc6 ls33">=</span><span class="fca ws13a">next</span>(f)</div><div class="t m0 x18 hf yd56 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws4">(line, end<span class="fc6 ws13a">=<span class="ff9 fc9 ls34">&apos;&apos;</span></span>)</span></div><div class="t m0 x16 hf yd57 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 ws13a">StopIteration<span class="fc0">:</span></span></div><div class="t m0 x17 h10 yd58 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x0 h9 yd59 ff1 fs3 fc0 sc0 ls0 ws55a">通<span class="_ _6"></span>常<span class="_ _6"></span>来<span class="_ _6"></span>讲， <span class="ff6 ws2f6">StopIteration </span><span class="wsa0">用<span class="_ _6"></span>来<span class="_ _6"></span>指<span class="_ _6"></span>示<span class="_ _6"></span>迭<span class="_ _6"></span>代<span class="_ _6"></span>的<span class="_ _6"></span>结<span class="_ _6"></span>尾。<span class="_ _6"></span>然<span class="_ _6"></span>而，<span class="_ _6"></span>如<span class="_ _6"></span>果<span class="_ _6"></span>你<span class="_ _6"></span>手<span class="_ _6"></span>动<span class="_ _6"></span>使<span class="_ _6"></span>用<span class="_ _6"></span>上<span class="_ _6"></span>面演</span></div><div class="t m0 x5 h9 yd5a ff1 fs3 fc0 sc0 ls0 ws55b">示的 <span class="ff6 ws55c">next() </span><span class="ls18 ws55d">函数的话，你还可以通过返回一个指定值来标记结尾，比如 </span><span class="ff6 ws55e">None </span><span class="ls18 ws110">。下面</span></div><div class="t m0 x5 h9 yd5b ff1 fs3 fc0 sc0 ls0">是示例：</div><div class="t m0 x5 hf yd5c ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">/etc/passwd<span class="ff9 ls34">&apos;</span></span><span class="ls32">)</span></span></span><span class="ws157">as <span class="ff8 fc0">f:</span></span></div><div class="t m0 x15 hf yd5d ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 ws13a">True<span class="fc0">:</span></span></div><div class="t m0 x16 hf yd5e ff8 fs5 fc0 sc0 ls0 ws161">line <span class="fc6 ls33">=</span><span class="fca ws13a">next</span><span class="ws158">(f, <span class="fca ws13a">None</span>)</span></div><div class="t m0 x16 hf yd5f ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws13c">line </span>is <span class="ff8 ws13a">None<span class="fc0">:</span></span></div><div class="t m0 x26 h8 y29 ff2 fs3 fc0 sc0 ls0">110</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
