<div id="pf14a" class="pf w0 h0" data-page-no="14a"><div class="pc pc14a w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg14a.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 h10 y181 ff7 fs5 fc12 sc0 ls0">@classmethod</div><div class="t m0 x15 h10 y182 ff7 fs5 fc12 sc0 ls0">@timethis</div><div class="t m0 x15 hf y183 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">class_method<span class="fc0 ws13b">(cls, n):</span></span></div><div class="t m0 x16 hf y184 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws4">(cls, n)</span></div><div class="t m0 x16 hf y185 ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 fc0 ls33">n<span class="fc6 ls32">&gt;<span class="fc7 ls34">0</span></span><span class="ls0">:</span></span></div><div class="t m0 x17 hf y186 ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls0 ws23d">-= <span class="fc7">1</span></span></div><div class="t m0 x15 h10 y188 ff7 fs5 fc12 sc0 ls0">@staticmethod</div><div class="t m0 x15 h10 y98e ff7 fs5 fc12 sc0 ls0">@timethis</div><div class="t m0 x15 hf y98f ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">static_method<span class="fc0">(n):</span></span></div><div class="t m0 x16 hf y990 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(n)</span></div><div class="t m0 x16 hf y991 ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 fc0 ls33">n<span class="fc6 ls32">&gt;<span class="fc7 ls34">0</span></span><span class="ls0">:</span></span></div><div class="t m0 x17 hf y992 ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls0 ws23d">-= <span class="fc7">1</span></span></div><div class="t m0 x0 h9 y2293 ff1 fs3 fc0 sc0 ls0">装饰后的类和静态方法可正常工作，只不过增加了额外的计时功能：</div><div class="t m0 x5 hf ye8f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0">Spam()</span></span></div><div class="t m0 x5 hf ye90 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">instance_method(<span class="fc7">1000000</span>)</span></span></span></div><div class="t m0 x5 hf ye91 ff8 fs5 fc8 sc0 ls0 ws4">&lt;__main__.Spam object at 0x1006a6050&gt; 1000000</div><div class="t m0 x5 hf ye92 ff8 fs5 fc8 sc0 ls0">0.11817407608032227</div><div class="t m0 x5 hf y90e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">Spam<span class="fc6 ls34">.</span>class_method(<span class="fc7">1000000</span>)</span></div><div class="t m0 x5 hf y90f ff8 fs5 fc8 sc0 ls0 ws145">&lt;class <span class="ff9 ls34">&apos;</span><span class="ws13a">__main__.Spam<span class="ff9 ls34">&apos;</span><span class="ws4">&gt; 1000000</span></span></div><div class="t m0 x5 hf y910 ff8 fs5 fc8 sc0 ls0">0.11334395408630371</div><div class="t m0 x5 hf y911 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">Spam<span class="fc6 ls34">.</span>static_method(<span class="fc7">1000000</span>)</span></div><div class="t m0 x5 hf ye93 ff8 fs5 fc8 sc0 ls0">1000000</div><div class="t m0 x5 hf ya73 ff8 fs5 fc8 sc0 ls0">0.11740279197692871</div><div class="t m0 x5 hf ya74 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y2294 ff2 fs2 fc4 sc0 ls0 wsadf">11.10.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y2295 ff1 fs3 fc0 sc0 ls0">如果你把装饰器的顺序写错了就会出错。例如，假设你像下面这样写：</div><div class="t m0 x5 hf y2296 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Spam<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 h10 y2297 ff7 fs5 fc12 sc0 ls0">@timethis</div><div class="t m0 x15 h10 y2298 ff7 fs5 fc12 sc0 ls0">@staticmethod</div><div class="t m0 x15 hf y2299 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">static_method<span class="fc0">(n):</span></span></div><div class="t m0 x16 hf y229a ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(n)</span></div><div class="t m0 x16 hf y229b ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 fc0 ls33">n<span class="fc6 ls32">&gt;<span class="fc7 ls34">0</span></span><span class="ls0">:</span></span></div><div class="t m0 x17 hf y229c ff8 fs5 fc0 sc0 ls32">n<span class="fc6 ls0 ws23d">-= <span class="fc7">1</span></span></div><div class="t m0 x0 h9 y229d ff1 fs3 fc0 sc0 ls0">那么你调用这个镜头方法时就会报错：</div><div class="t m0 x5 hf y229e ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; Spam.static_method(1000000)</div><div class="t m0 x5 hf y229f ff8 fs5 fc0 sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x5 hf y22a0 ff8 fs5 fc0 sc0 ls0 ws4">File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</div><div class="t m0 x5 hf y22a1 ff8 fs5 fc0 sc0 ls0 ws4">File &quot;timethis.py&quot;, line 6, in wrapper</div><div class="t m0 x5 hf y54 ff8 fs5 fc0 sc0 ls0 ws4">start = time.time()</div><div class="t m0 x5 hf y22a2 ff8 fs5 fc0 sc0 ls0 ws2a3">TypeError: <span class="ff9 ls34">&apos;</span><span class="ws13a">staticmethod<span class="ff9 ls33">&apos;</span><span class="ws4">object is not callable</span></span></div><div class="t m0 x5 hf y22a3 ff8 fs5 fc0 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y22a4 ff1 fs3 fc0 sc0 ls0 wsc0b">问题<span class="_ _6"></span>在<span class="_ _6"></span>于 <span class="ff6 ws6c1">@classmethod </span><span class="ls124">和</span><span class="ff6 wsc0c">@staticmethod </span><span class="ls6b ws28f">实际上并不会创建可直接调用的对象<span class="_ _1"></span>，</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">11.10.<span class="_ _5"> </span>9.10 <span class="ff1 wsc0a">为类和静态方法提供装饰器 </span>321</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
