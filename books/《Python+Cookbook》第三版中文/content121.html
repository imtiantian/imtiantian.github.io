<div id="pf79" class="pf w0 h0" data-page-no="79"><div class="pc pc79 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg79.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 hf y1ab ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__repr__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y1ac ff7 fs5 fca sc0 ls0 ws146">return <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">Node({!r})</span>&apos;</span><span class="ff8 fc6 ws13a">.<span class="fc0">format(<span class="fca">self</span></span><span class="ls34">.</span><span class="fc0">_value)</span></span></div><div class="t m0 x15 hf y1ae ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">add_child<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, node):</span></span></span></div><div class="t m0 x16 hf y1af ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">_children</span><span class="ls34">.</span><span class="fc0">append(node)</span></span></div><div class="t m0 x15 hf y355 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__iter__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y410 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">iter<span class="fc0 ls34">(</span>self<span class="fc6 ls34">.</span><span class="fc0">_children)</span></span></div><div class="t m0 x5 h11 yba ffa fs5 fcd sc0 ls0 ws4"># Example</div><div class="t m0 x5 hf y8c6 ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws16d">__name__ <span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">__main__<span class="ff9 ls34">&apos;</span></span></span>:</span></div><div class="t m0 x15 hf ybed ff8 fs5 fc0 sc0 ls0 ws13c">root <span class="fc6 ls32">=</span><span class="ws13a">Node(<span class="fc7">0</span>)</span></div><div class="t m0 x15 hf ybee ff8 fs5 fc0 sc0 ls0 ws145">child1 <span class="fc6 ls32">=</span><span class="ws13a">Node(<span class="fc7 ls34">1</span>)</span></div><div class="t m0 x15 hf ybef ff8 fs5 fc0 sc0 ls0 ws145">child2 <span class="fc6 ls32">=</span><span class="ws13a">Node(<span class="fc7 ls34">2</span>)</span></div><div class="t m0 x15 hf ybf0 ff8 fs5 fc0 sc0 ls0 ws13a">root<span class="fc6 ls34">.</span>add_child(child1)</div><div class="t m0 x15 hf yd7d ff8 fs5 fc0 sc0 ls0 ws13a">root<span class="fc6 ls34">.</span>add_child(child2)</div><div class="t m0 x15 h11 ybf1 ffa fs5 fcd sc0 ls0 ws4"># Outputs Node(1), Node(2)</div><div class="t m0 x15 hf ybf2 ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws159">ch </span><span class="ws157">in <span class="ff8 fc0">root:</span></span></div><div class="t m0 x16 hf ybf3 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0">(ch)</span></div><div class="t m0 x0 h9 yd7e ff1 fs3 fc0 sc0 ls16 ws564">在上面代码中<span class="_ _c"></span>， <span class="ff6 ls0 ws565">iter<span class="_ _e"> </span>() </span><span class="ws566">方法只是简单的将迭代请求传递给内部的 <span class="ff6 ls0">children</span></span></div><div class="t m0 x5 h9 yd7f ff1 fs3 fc0 sc0 ls0">属性。</div><div class="t m0 x5 he yd80 ff2 fs2 fc4 sc0 ls0 ws135">6.2.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 yd81 ff4 fs3 fc0 sc0 ls0 ws453">Python <span class="ff1 ls18 ws567">的迭代器协议需要 </span><span class="ff6 ws568">iter<span class="_ _e"> </span>() <span class="ff1 ls18 ws569">方法返回一个实现了 </span>next<span class="_ _e"> </span>() <span class="ff1 ls18 ws110">方法的迭代</span></span></div><div class="t m0 x5 h9 yd82 ff1 fs3 fc0 sc0 ls1e ws111">器对象<span class="_ _1"></span>。如果你只是迭代遍历其他容器的内容<span class="_ _1"></span>，你无须担心底层是怎样实现的<span class="_ _1"></span>。你所</div><div class="t m0 x5 h9 yd83 ff1 fs3 fc0 sc0 ls0">要做的只是传递迭代请求既可。</div><div class="t m0 x0 h9 yd84 ff1 fs3 fc0 sc0 ls0 ws56a">这 里 的<span class="_ _13"> </span><span class="ff6 ws56b">iter() </span><span class="lse7 ws56c">函数的使用简化了代码<span class="_ _1f"></span>， <span class="ff6 ls0 ws56d">iter(s) </span><span class="ws56e">只是简单的<span class="_ _1"></span>通过调用<span class="_ _1f"></span></span></span></div><div class="t m0 x5 h9 yd85 ff6 fs3 fc0 sc0 ls0 ws56f">s.<span class="_ _e"> </span>iter<span class="_ _e"> </span>() <span class="ff1 lse8 ws570">方法来返回对应的迭代器对象<span class="_ _d"></span>，就跟 <span class="ff6 ls0 ws571">len(s) <span class="ff1 ws572">会<span class="_ _0"></span>调<span class="_ _0"></span>用 </span><span class="ws573">s.<span class="_ _e"> </span>len<span class="_ _e"> </span>() <span class="ff1 wsa0">原<span class="_ _0"></span>理</span></span></span></span></div><div class="t m0 x5 h9 yd86 ff1 fs3 fc0 sc0 ls0">是一样的。</div><div class="t m0 x5 hd yd87 ff2 fs4 fc4 sc0 ls0 ws134">6.3<span class="_ _e"> </span>4.3 <span class="ff1">使用生成器创建新的迭代模式</span></div><div class="t m0 x5 he yd88 ff2 fs2 fc4 sc0 ls0 ws135">6.3.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 yd89 ff1 fs3 fc0 sc0 ls14 ws574">你想实现一个自定义迭代模式<span class="_ _c"></span>，<span class="_ _6"></span>跟普通的内置函数比如 <span class="ff6 ls0 ws575">range() <span class="ff4 lse9">,</span><span class="ws576">reversed() <span class="ff1">不</span></span></span></div><div class="t m0 x5 h9 yd8a ff1 fs3 fc0 sc0 ls0">一样。</div><div class="t m0 x5 he yd8b ff2 fs2 fc4 sc0 ls0 ws135">6.3.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 yd8c ff1 fs3 fc0 sc0 ls3a ws153">如果你想实现一种新的迭代模式，使用一个生成器函数来定义它。下面是一个生产</div><div class="t m0 x5 h9 yd8d ff1 fs3 fc0 sc0 ls0">某个范围内浮点数的生成器：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">6.3.<span class="_ _5"> </span>4.3 <span class="ff1 ws577">使用生成器创建新的迭代模式 </span>112</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
