<div id="pf73" class="pf w0 h0" data-page-no="73"><div class="pc pc73 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg73.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h9 y2a ff1 fs3 fc0 sc0 ls3a ws153">一旦该月的天数已知了，那么结束日期就可以通过在开始日期上面加上这个天数获</div><div class="t m0 x5 h7 y2b ff1 fs3 fc0 sc0 ls1f ws52e">得。有个需要注意的是结束日期并不包含在这个日期范围内 <span class="ff4 ls0 wsa5">(</span><span class="ws113">事实上它是下个月的开始</span></div><div class="t m0 x5 h7 y2c ff1 fs3 fc0 sc0 ls0 wsa0">日期<span class="ff4 ls1b">)</span><span class="wsc">。这个和 <span class="ff4 ws5c">Python </span><span class="ls5">的</span><span class="ff6 ws17d">slice </span><span class="ls4">与</span><span class="ff6 ws17d">range </span>操作行为保持一致，同样也不包含结尾。</span></div><div class="t m0 x0 h9 y99 ff1 fs3 fc0 sc0 lsdf ws52f">为了在日期范围上循环<span class="_ _19"></span>，要使用到标准的数学和比较操作<span class="_ _8"></span>。比如<span class="_ _19"></span>，可以利用<span class="_ _8"></span></div><div class="t m0 x5 h9 y9a ff6 fs3 fc0 sc0 ls0 ws1d1">timedelta <span class="ff1 wsa0">实例来递增日期，小于号<span class="ff12 lse0">&lt;</span>用来检查一个日期是否在结束日期之前。</span></div><div class="t m0 x0 h9 y30 ff1 fs3 fc0 sc0 ls14 ws530">理想情况下<span class="_ _1"></span>，如果能为日期迭代创建一个同内置的 <span class="ff6 ls0 ws307">range() </span><span class="ws174">函数一样的函数就好</span></div><div class="t m0 x5 h9 y31 ff1 fs3 fc0 sc0 ls0">了。幸运的是，可以使用一个生成器来很容易的实现这个目标：</div><div class="t m0 x5 hf ycdc ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">date_range<span class="fc0 ws4">(start, stop, step):</span></span></div><div class="t m0 x15 hf ycdd ff7 fs5 fca sc0 ls0 ws16a">while <span class="ff8 fc0 ws458">start <span class="fc6 ls32">&lt;</span>stop:</span></div><div class="t m0 x16 hf ycde ff7 fs5 fca sc0 ls0 ws16a">yield <span class="ff8 fc0">start</span></div><div class="t m0 x16 hf ycdf ff8 fs5 fc0 sc0 ls0 ws15f">start <span class="fc6 ws23d">+= </span>step</div><div class="t m0 x0 h9 yce0 ff1 fs3 fc0 sc0 ls0">下面是使用这个生成器的例子：</div><div class="t m0 x5 hf yce1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">d</span><span class="ws157">in <span class="ff8 fc0 ws13a">date_range(datetime(<span class="fc7">2012</span><span class="ls32">,<span class="fc7 ls34">9</span><span class="ls33">,</span></span><span class="fc7">1</span><span class="ws4">), datetime(</span><span class="fc7">2012</span><span class="ls34">,</span><span class="fc7">10</span><span class="ls34">,<span class="fc7">1</span></span>),</span></span></span></div><div class="t m0 x24 hf yce2 ff8 fs5 fc8 sc0 ls0">timedelta(hours=6)):</div><div class="t m0 x5 hf yce3 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(d)</span></span></div><div class="t m0 x5 h10 yce4 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf yce5 ff8 fs5 fc8 sc0 ls0 ws4">2012-09-01 00:00:00</div><div class="t m0 x5 hf yce6 ff8 fs5 fc8 sc0 ls0 ws4">2012-09-01 06:00:00</div><div class="t m0 x5 hf yce7 ff8 fs5 fc8 sc0 ls0 ws4">2012-09-01 12:00:00</div><div class="t m0 x5 hf yce8 ff8 fs5 fc8 sc0 ls0 ws4">2012-09-01 18:00:00</div><div class="t m0 x5 hf yce9 ff8 fs5 fc8 sc0 ls0 ws4">2012-09-02 00:00:00</div><div class="t m0 x5 hf ycea ff8 fs5 fc8 sc0 ls0 ws4">2012-09-02 06:00:00</div><div class="t m0 x5 h10 yceb ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf ycec ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 yced ff1 fs3 fc0 sc0 ls18 ws531">这种实现之所以这么简单，还得归功于 <span class="ff4 ls0 ws453">Python </span><span class="ws110">中的日期和时间能够使用标准的数<span class="_ _1"></span></span></div><div class="t m0 x5 h9 ycee ff1 fs3 fc0 sc0 ls0">学和比较操作符来进行运算。</div><div class="t m0 x5 hd ycef ff2 fs4 fc4 sc0 ls0 ws211">5.15<span class="_ _e"> </span>3.15 <span class="ff1">字符串转换为日期</span></div><div class="t m0 x5 he ycf0 ff2 fs2 fc4 sc0 ls0 ws212">5.15.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 ycf1 ff1 fs3 fc0 sc0 ls3d ws532">你的应用程序接受字符串格式的输入，但是你想将它们转换为 <span class="ff6 ls0 ws214">datetime <span class="ff1 wsa0">对象以便</span></span></div><div class="t m0 x5 h9 ycf2 ff1 fs3 fc0 sc0 ls0">在上面执行非字符串操作。</div><div class="t m0 x5 he ycf3 ff2 fs2 fc4 sc0 ls0 ws212">5.15.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 ycf4 ff1 fs3 fc0 sc0 ls0 wsc">使用 <span class="ff4 ws5c">Python </span><span class="ws63">的标准模块 <span class="ff6 ws1f3">datetime </span>可以很容易的解决这个问题。比如：</span></div><div class="t m0 x5 hf y83e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws248">datetime </span><span class="ws146">import <span class="ff8 fc0">datetime</span></span></span></div><div class="t m0 x5 hf ycf5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">text <span class="fc6 ls32">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">2012-09-20<span class="ff9">&apos;</span></span></span></div><div class="t m0 x5 hf y83f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">y<span class="fc6 ls33">=</span><span class="ls0 ws13a">datetime<span class="fc6">.</span><span class="ws169">strptime(text, <span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">%Y-%m-<span class="ffa fcf">%d</span><span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y840 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">z<span class="fc6 ls33">=</span><span class="ls0 ws13a">datetime<span class="fc6">.</span>now()</span></span></div><div class="t m0 x5 hf y841 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">diff <span class="fc6 ls32">=<span class="fc0">z</span><span class="ls33">-</span></span>y</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">5.15.<span class="_ _5"> </span>3.15 <span class="ff1 ws533">字符串转换为日期 </span>106</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
