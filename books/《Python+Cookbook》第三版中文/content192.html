<div id="pfc0" class="pf w0 h0" data-page-no="c0"><div class="pc pcc0 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgc0.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws135">8.5.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y236 ff1 fs3 fc0 sc0 ls0 ws82c">尽<span class="_ _6"></span>管 <span class="ff6 ws82d">xml.etree.ElementTree </span><span class="ls77 ws82e">库通常用来做解析工作<span class="_ _1"></span>，其实它也可以创建 <span class="ff4 ls0">XML</span></span></div><div class="t m0 x5 h9 y237 ff1 fs3 fc0 sc0 ls0">文档。例如，考虑如下这个函数：</div><div class="t m0 x5 hf y14e8 ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws7d9">xml.etree.ElementTree </span><span class="ws146">import <span class="ff8 fc0">Element</span></span></div><div class="t m0 x5 hf y14e9 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">dict_to_xml<span class="fc0 ws13b">(tag, d):</span></span></div><div class="t m0 x5 h15 y14ea ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x5 h11 y14eb ffa fs5 fc9 sc0 ls0 ws4">Turn a simple dict of key/value pairs into XML</div><div class="t m0 x5 h15 y14ec ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x5 hf y14ed ff8 fs5 fc0 sc0 ls0 ws13c">elem <span class="fc6 ls32">=</span>Element(tag)</div><div class="t m0 x5 hf y14ee ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws13b">key, val </span><span class="ws160">in <span class="ff8 fc0 ws13a">d<span class="fc6 ls34">.</span>items():</span></span></div><div class="t m0 x15 hf y14ef ff8 fs5 fc0 sc0 ls0 ws15f">child <span class="fc6 ls33">=</span>Element(key)</div><div class="t m0 x15 hf y14f0 ff8 fs5 fc0 sc0 ls0 ws13a">child<span class="fc6">.</span><span class="ws13c">text <span class="fc6 ls32">=</span></span><span class="fca">str</span>(val)</div><div class="t m0 x15 hf y14f1 ff8 fs5 fc0 sc0 ls0 ws13a">elem<span class="fc6 ls34">.</span>append(child)</div><div class="t m0 x5 hf y14f2 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">elem</span></div><div class="t m0 x0 h9 yc6d ff1 fs3 fc0 sc0 ls0">下面是一个使用例子：</div><div class="t m0 x5 hf y93a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span>{<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">name</span>&apos;</span>:<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">GOOG<span class="ff9 ws13b">&apos;</span></span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">shares</span>&apos;</span></span>:<span class="fc7 ls0 ws13a">100</span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13a">price</span>&apos;</span><span class="ls34">:<span class="fc7 ls0 ws15f">490.1 <span class="fc0">}</span></span></span></span></span></div><div class="t m0 x5 hf y93b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">e<span class="fc6 ls33">=</span><span class="ls0 ws13a">dict_to_xml(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">stock<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, s)</span></span></span></div><div class="t m0 x5 hf y93c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">e</span></div><div class="t m0 x5 hf y9b2 ff8 fs5 fc8 sc0 ls0 ws16d">&lt;Element <span class="ff9 ws13b">&apos;</span><span class="ws13a">stock<span class="ff9 ls32">&apos;</span><span class="ws4">at 0x1004b64c8&gt;</span></span></div><div class="t m0 x5 hf y14f3 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y14f4 ff1 fs3 fc0 sc0 ls0 ws82f">转换结果是<span class="_ _6"></span>一个 <span class="ff6 ws830">Element </span><span class="ws831">实例。对于 <span class="ff4 ws6ea">I/O </span>操作，<span class="_ _6"></span>使用 <span class="ff6 ws832">xml.etree.ElementTree </span>中</span></div><div class="t m0 x5 h9 y14f5 ff1 fs3 fc0 sc0 ls4">的<span class="ff6 ls0 ws17c">tostring() <span class="ff1">函数很容易就能将它转换成一个字节字符串。例如：</span></span></div><div class="t m0 x5 hf y14f6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws7d9">xml.etree.ElementTree </span><span class="ws146">import <span class="ff8 fc0">tostring</span></span></span></div><div class="t m0 x5 hf y14f7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">tostring(e)</span></div><div class="t m0 x5 hf y14f8 ff8 fs5 fc8 sc0 ls34">b<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">&lt;stock&gt;&lt;price&gt;490.1&lt;/price&gt;&lt;shares&gt;100&lt;/shares&gt;&lt;name&gt;GOOG&lt;/name&gt;&lt;/stock&gt;<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y14f9 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y14fa ff1 fs3 fc0 sc0 ls0 ws38">如果你想给某个元素添加属性值，可以使用 <span class="ff6 ws17d">set() </span>方法：</div><div class="t m0 x5 hf y14fb ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">e<span class="fc6 ls0 ws13a">.<span class="fc0">set(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">_id</span>&apos;</span>,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws13a">1234</span><span class="ls34">&apos;</span><span class="ff8 fc0">)</span></span></div><div class="t m0 x5 hf y14fc ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">tostring(e)</span></div><div class="t m0 x5 hf y14fd ff8 fs5 fc8 sc0 ls34">b<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">&lt;stock _id=&quot;1234&quot;&gt;&lt;price&gt;490.1&lt;/price&gt;&lt;shares&gt;100&lt;/shares&gt;&lt;name&gt;GOOG&lt;/name&gt;</span></div><div class="t m0 x5 hf y14fe ff8 fs5 fc8 sc0 ls0 ws13a">&lt;/stock&gt;<span class="ff9">&apos;</span></div><div class="t m0 x5 hf y14ff ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1500 ff1 fs3 fc0 sc0 ls14 ws833">如果你还想保持元素的顺序<span class="_ _1"></span>，可以考虑构造一个 <span class="ff6 ls0 ws3a2">OrderedDict </span><span class="ws174">来代替一个普通的<span class="_ _1"></span></span></div><div class="t m0 x5 h7 y1501 ff1 fs3 fc0 sc0 ls0 ws14">字典。请参考 <span class="ff4 ws2b4">1.7 </span>小节。</div><div class="t m0 x5 he y1502 ff2 fs2 fc4 sc0 ls0 ws135">8.5.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 y1503 ff1 fs3 fc0 sc0 ls0 ws38">当创建 <span class="ff4 ws64">XML </span>的时候，你被限制只能构造字符串类型的值。例如：</div><div class="t m0 x5 hf y83f ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">dict_to_xml_str<span class="fc0 ws13b">(tag, d):</span></span></div><div class="t m0 x15 h15 y840 ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x15 h11 y841 ffa fs5 fc9 sc0 ls0 ws4">Turn a simple dict of key/value pairs into XML</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">8.5.<span class="_ _5"> </span>6.5 <span class="ff1 ws16b">将字典转换为 </span><span class="ws82b">XML 183</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
