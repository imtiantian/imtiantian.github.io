<div id="pfdf" class="pf w0 h0" data-page-no="df"><div class="pc pcdf w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bgdf.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h7 y2a ff1 fs3 fc0 sc0 ls12 ws91c">其次，默认参数的值应该是不可变的对象<span class="_ _c"></span>，比如 <span class="ff4 ls0 wsa5">None</span><span class="ls14e">、<span class="ff4 ls0 wsa5">T<span class="_ _d"></span>rue<span class="ff1 ls14e">、</span>F<span class="_ _8"></span>alse<span class="ff1 ls12 wse4">、数字或字符</span></span></span></div><div class="t m0 x5 h9 y2b ff1 fs3 fc0 sc0 ls0">串。特别的，千万不要像下面这样写代码：</div><div class="t m0 x5 hf y48d ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">spam<span class="fc0 ws13b">(a, b<span class="fc6 ls34">=</span><span class="ws13c">[]): </span><span class="ffa fcd"># NO!</span></span></span></div><div class="t m0 x15 hf y48e ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h9 y184f ff1 fs3 fc0 sc0 ls3a ws153">如果你这么做了，当默认值在其他地方被修改后你将会遇到各种麻烦。这些修改会</div><div class="t m0 x5 h9 y1850 ff1 fs3 fc0 sc0 ls0">影响到下次调用这个函数时的默认值。比如：</div><div class="t m0 x5 hf y1216 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">def <span class="ff8 fcb ws13a">spam<span class="fc0 ws13b">(a, b<span class="fc6 ls34">=</span>[]):</span></span></span></div><div class="t m0 x5 hf y517 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(b)</span></span></div><div class="t m0 x5 hf y518 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws146">return <span class="ff8 fc0">b</span></span></div><div class="t m0 x5 h10 y519 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y51a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">x<span class="fc6 ls33">=</span><span class="ls0 ws13a">spam(<span class="fc7 ls34">1</span>)</span></span></div><div class="t m0 x5 hf y51b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">x</span></div><div class="t m0 x5 hf y51c ff8 fs5 fc8 sc0 ls0">[]</div><div class="t m0 x5 hf y51d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">x<span class="fc6 ls0 ws13a">.<span class="fc0">append(<span class="fc7">99</span>)</span></span></span></div><div class="t m0 x5 hf y51e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">x<span class="fc6 ls0 ws13a">.<span class="fc0">append(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">Yow!</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y51f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">x</span></div><div class="t m0 x5 hf y1851 ff8 fs5 fc8 sc0 ls0 ws13c">[99, <span class="ff9 ws13b">&apos;</span><span class="ws13a">Yow!<span class="ff9 ls34">&apos;</span>]</span></div><div class="t m0 x5 hf y5dc ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam(<span class="fc7">1</span><span class="ls33">)</span><span class="ffa fcd ws4"># Modified list gets returned!</span></span></div><div class="t m0 x5 hf y1852 ff8 fs5 fc8 sc0 ls0 ws13c">[99, <span class="ff9 ws13b">&apos;</span><span class="ws13a">Yow!<span class="ff9 ls34">&apos;</span>]</span></div><div class="t m0 x5 hf y1853 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1854 ff1 fs3 fc0 sc0 ls14f ws91d">这种结果应该不是你想要的<span class="_ _d"></span>。为了避免这种情况的发生<span class="_ _d"></span>，最好是将默认值设为<span class="_ _d"></span></div><div class="t m0 x5 h7 y1855 ff4 fs3 fc0 sc0 ls0 wsa5">None<span class="ff1">，然后在函数里面检查它，前面的例子就是这样做的。</span></div><div class="t m0 x0 h7 y1856 ff1 fs3 fc0 sc0 ls12 ws91e">在测试 <span class="ff4 ls0 ws91f">None <span class="ff1 ws920">值时<span class="_ _6"></span>使<span class="_ _6"></span>用 <span class="ff6 ws921">is </span><span class="wsa0">操作<span class="_ _6"></span>符是<span class="_ _6"></span>很<span class="_ _6"></span>重要<span class="_ _6"></span>的，也<span class="_ _6"></span>是<span class="_ _6"></span>这种<span class="_ _6"></span>方<span class="_ _6"></span>案的<span class="_ _6"></span>关键<span class="_ _6"></span>点。<span class="_ _6"></span>有时<span class="_ _6"></span>候大</span></span></span></div><div class="t m0 x5 h9 y1857 ff1 fs3 fc0 sc0 ls0">家会犯下下面这样的错误：</div><div class="t m0 x5 hf y1858 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">spam<span class="fc0 ws13b">(a, b<span class="fc6 ls34">=</span></span><span class="fca">None<span class="fc0">):</span></span></span></div><div class="t m0 x15 hf yfe9 ff7 fs5 fca sc0 ls0 ws157">if not <span class="ff8 fc0 ws159">b: <span class="ffa fcd ws4"># NO! Use <span class="ffb ls34">&apos;</span>b is None<span class="ffb ls32">&apos;</span>instead</span></span></div><div class="t m0 x16 hf y1859 ff8 fs5 fc0 sc0 ls32">b<span class="fc6 ls33">=</span><span class="ls0">[]</span></div><div class="t m0 x15 hf y185a ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h7 y185b ff1 fs3 fc0 sc0 ls0 ws922">这么写的问题在于尽管 <span class="ff4 ws923">None </span><span class="ws924">值确实是被<span class="_ _6"></span>当成 <span class="ff4 wsa5">F<span class="_ _8"></span>alse<span class="ff1 ws925">，但是还有其他的对<span class="_ _6"></span>象 </span>(<span class="ff1 wsa0">比如长</span></span></span></div><div class="t m0 x5 h7 y36e ff1 fs3 fc0 sc0 ls0 ws926">度为 <span class="ff4 lsed">0</span><span class="wsa0">的<span class="_ _6"></span>字符<span class="_ _6"></span>串、列<span class="_ _6"></span>表、元<span class="_ _6"></span>组、字<span class="_ _6"></span>典等<span class="ff4 ls150">)</span><span class="ls42 ws927">都会被当做 </span><span class="ff4 wsa5">F<span class="_ _d"></span>alse<span class="ff1 wsa0">。因<span class="_ _6"></span>此，上<span class="_ _6"></span>面的<span class="_ _6"></span>代码<span class="_ _6"></span>会误<span class="_ _6"></span>将</span></span></span></div><div class="t m0 x5 h9 y185c ff1 fs3 fc0 sc0 ls0">一些其他输入也当成是没有输入。比如：</div><div class="t m0 x5 hf y185d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam(<span class="fc7">1</span><span class="ls33">)</span><span class="ffa fcd ws13b"># OK</span></span></div><div class="t m0 x5 hf y185e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">x<span class="fc6 ls33">=</span><span class="ls0">[]</span></span></div><div class="t m0 x5 hf y185f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam(<span class="fc7">1</span><span class="ws4">, x) <span class="ffa fcd"># Silent error. x value overwritten by default</span></span></span></div><div class="t m0 x5 hf y1860 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam(<span class="fc7">1</span><span class="ls33">,</span><span class="fc7">0</span><span class="ls33">)</span><span class="ffa fcd ws4"># Silent error. 0 ignored</span></span></div><div class="t m0 x5 hf y1861 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">spam(<span class="fc7">1</span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;&apos;</span><span class="ls33">)</span><span class="ffa fcd ws13b"># Silent error. <span class="ffb ws928">&apos;&apos; </span>ignored</span></span></div><div class="t m0 x5 hf y256 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y5f4 ff1 fs3 fc0 sc0 ls3a ws153">最后一个问题比较微妙，那就是一个函数需要测试某个可选参数是否被使用者传递</div><div class="t m0 x5 h7 y1862 ff1 fs3 fc0 sc0 ls22 ws929">进来。这时候需要小心的是你不能用某个默认值比如 <span class="ff4 ls0 wsa5">None</span><span class="ls151">、<span class="ff4 ls152">0</span><span class="ls0 ws2eb">或者 <span class="ff4 ws92a">F<span class="_ _8"></span>alse <span class="ff1 ls22 ws119">值来测试用</span></span></span></span></div><div class="t m0 x5 h7 y1863 ff1 fs3 fc0 sc0 ls10 ws92b">户提供的值 <span class="ff4 ls1b">(</span><span class="wsdf">因为这些值都是合法的值，是可能被用户传递进来的<span class="_ _c"></span><span class="ff4 ls1b">)<span class="ff1 ls10">。因此，你需要其<span class="_ _1"></span></span></span></span></div><div class="t m0 x5 h9 y1864 ff1 fs3 fc0 sc0 ls0">他的解决方案了。</div><div class="t m0 x0 h9 y1865 ff1 fs3 fc0 sc0 ls0 ws389">为 了 解 决 这 个 问 题， 你 可 以 创 建 一 个 独 一 无 二 的 私 有 对 象 实 例， 就 像 上 面</div><div class="t m0 x5 h7 y1866 ff1 fs3 fc0 sc0 ls96">的<span class="ff4 ls0 ws92c">no v<span class="_ _d"></span>alue<span class="_ _18"> </span><span class="ff1 ls130 ws7ba">变量那样<span class="_ _c"></span>。<span class="_ _6"></span>在函数里面<span class="_ _d"></span>，你可以通过<span class="_ _6"></span>检查被传递参数值跟这个实例是否<span class="_ _d"></span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">9.5.<span class="_ _5"> </span>7.5 <span class="ff1 ws855">定义有默认参数的函数 </span>214</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
