<div id="pf216" class="pf w0 h0" data-page-no="216"><div class="pc pc216 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg216.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 h9 y2a ff1 fs3 fc0 sc0 ls0 ws12b5">用。使<span class="_ _6"></span>用 <span class="ff6 ws396">@expected </span><span class="lsa8 ws3de">的失败装饰器来标记那些确定会失败的测试，并且对<span class="_ _1"></span>这些测试你</span></div><div class="t m0 x5 h9 y2b ff1 fs3 fc0 sc0 ls0">不想让测试框架打印更多信息。</div><div class="t m0 x0 h9 y8dd ff1 fs3 fc0 sc0 ls0">忽略方法的装饰器还可以被用来装饰整个测试类，比如：</div><div class="t m0 x5 hf y33dc ff7 fs5 fc12 sc0 ls0 ws156">@unittest.skipUnless<span class="ff8 fc0 ws13a">(platform<span class="fc6 ls34">.</span><span class="ws1f5">system() <span class="fc6 ws15c">== <span class="ff9 fc9 ws13b">&apos;</span></span></span><span class="fc9">Darwin<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13b">Mac specific tests<span class="ff9">&apos;</span></span>)</span></div><div class="t m0 x5 hf y33dd ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">DarwinTests<span class="ff8 fc0 ws13a">(unittest<span class="fc6 ls34">.</span>TestCase):</span></span></div><div class="t m0 x15 h10 y33de ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x5 hd y3b7 ff2 fs4 fc4 sc0 ls0 ws211">16.6<span class="_ _e"> </span>14.6 <span class="ff1">处理多个异常</span></div><div class="t m0 x5 he y33df ff2 fs2 fc4 sc0 ls0 ws212">16.6.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y33e0 ff1 fs3 fc0 sc0 ls3a ws153">你有一个代码片段可能会抛出多个不同的异常，怎样才能不创建大量重复代码就能</div><div class="t m0 x5 h9 y33e1 ff1 fs3 fc0 sc0 ls0">处理所有的可能异常呢？</div><div class="t m0 x5 he y33e2 ff2 fs2 fc4 sc0 ls0 ws212">16.6.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y33e3 ff1 fs3 fc0 sc0 ls56 ws1fa">如果你可以用单个代码块处理不同的异常<span class="_ _c"></span>，可以将它们放入一个元组中<span class="_ _1"></span>，如下所<span class="_ _1"></span></div><div class="t m0 x5 h9 y33e4 ff1 fs3 fc0 sc0 ls0">示：</div><div class="t m0 x5 hf y33e5 ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x15 hf y33e6 ff8 fs5 fc0 sc0 ls0 ws13a">client_obj<span class="fc6 ls34">.</span>get_url(url)</div><div class="t m0 x5 hf y33e7 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 fc0 ws2a3">(URLError, <span class="fca ws13a">ValueError</span><span class="ws4">, SocketTimeout):</span></span></div><div class="t m0 x15 hf y33e8 ff8 fs5 fc0 sc0 ls0 ws13a">client_obj<span class="fc6 ls34">.</span>remove_url(url)</div><div class="t m0 x0 h9 y33e9 ff1 fs3 fc0 sc0 ls17 ws12b6">在这个例子中，元祖中任何一个异常发生时都会执行 <span class="ff6 ls0 ws4db">remove url() <span class="ff1 wsa0">方法。<span class="_ _6"></span>如果<span class="_ _6"></span>你</span></span></div><div class="t m0 x5 h9 y33ea ff1 fs3 fc0 sc0 ls0 ws14">想对其中某个异常进行不同的处理，可以将其放入另外一个 <span class="ff6 ws25d">except </span>语句中：</div><div class="t m0 x5 hf yf3f ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x15 hf y33eb ff8 fs5 fc0 sc0 ls0 ws13a">client_obj<span class="fc6 ls34">.</span>get_url(url)</div><div class="t m0 x5 hf y1059 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 fc0 ws2a3">(URLError, <span class="fca ws13a">ValueError</span>):</span></div><div class="t m0 x15 hf y33ec ff8 fs5 fc0 sc0 ls0 ws13a">client_obj<span class="fc6 ls34">.</span>remove_url(url)</div><div class="t m0 x5 hf y33ed ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 fc0">SocketTimeout:</span></div><div class="t m0 x15 hf y33ee ff8 fs5 fc0 sc0 ls0 ws13a">client_obj<span class="fc6 ls34">.</span>handle_url_timeout(url)</div><div class="t m0 x0 h9 y33ef ff1 fs3 fc0 sc0 ls3a ws153">很多的异常会有层级关系，对于这种情况，你可能使用它们的一个基类来捕获所有</div><div class="t m0 x5 h9 y33f0 ff1 fs3 fc0 sc0 ls0">的异常。例如，下面的代码：</div><div class="t m0 x5 hf y33f1 ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x15 hf y33f2 ff8 fs5 fc0 sc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open<span class="fc0">(filename)</span></span></span></div><div class="t m0 x5 hf y33f3 ff7 fs5 fca sc0 ls0 ws146">except <span class="ff8 fc0 ws4">(FileNotFoundError, PermissionError):</span></div><div class="t m0 x15 h10 y33f4 ff7 fs5 fca sc0 ls0">pass</div><div class="t m0 x0 h9 y33f5 ff1 fs3 fc0 sc0 ls0">可以被重写为：</div><div class="t m0 x5 hf y33f6 ff7 fs5 fca sc0 ls0 ws156">try<span class="ff8 fc0">:</span></div><div class="t m0 x15 hf y33f7 ff8 fs5 fc0 sc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open<span class="fc0">(filename)</span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">16.6.<span class="_ _36"> </span>14.6 <span class="ff1 ws999">处理多个异常 </span>525</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
