<div id="pf25" class="pf w0 h0" data-page-no="25"><div class="pc pc25 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg25.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h7 y2a ff1 fs3 fc0 sc0 ls0 ws38">另外一种方式是使用 <span class="ff6 ws270">operator.attrgetter() </span>来代替 <span class="ff4 ws271">lam<span class="_ _1"></span>b<span class="_ _6"></span>da <span class="ff1">函数：</span></span></div><div class="t m0 x5 hf y3b2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws248">operator </span><span class="ws146">import <span class="ff8 fc0">attrgetter</span></span></span></div><div class="t m0 x5 hf y3b3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">sorted<span class="fc0 ws4">(users, key<span class="fc6 ls34">=</span><span class="ws13a">attrgetter(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">user_id<span class="ff9 ls34">&apos;</span></span>))</span></span></span></div><div class="t m0 x5 hf y3b4 ff8 fs5 fc8 sc0 ls0 ws4">[User(3), User(23), User(99)]</div><div class="t m0 x5 hf y3b5 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 he y3b6 ff2 fs2 fc4 sc0 ls0 ws212">3.14.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 y3b7 ff1 fs3 fc0 sc0 ls0 ws272">选 择 使 用<span class="_ _17"> </span><span class="ff4 ws273">lam<span class="_ _1"></span>b<span class="_ _6"></span>da <span class="ff1 ws272">函 数 或 者 是<span class="_ _17"> </span><span class="ff6 ws274">attrgetter() </span>可 能 取 决 于 个 人 喜 好。 但 是，</span></span></div><div class="t m0 x5 h9 y3b8 ff6 fs3 fc0 sc0 ls0 ws275">attrgetter() <span class="ff1 ls52 ws276">函数通常会运行的快点<span class="_ _8"></span>，并且还能同时允许多个字段进行比较<span class="_ _d"></span>。这<span class="_ _8"></span></span></div><div class="t m0 x5 h7 y3b9 ff1 fs3 fc0 sc0 ls0 ws277">个跟 <span class="ff6 ws278">operator.itemgetter() </span><span class="ws279">函数作用于字典类型很类似 <span class="ff4 ls1b">(</span>参考 <span class="ff4 ws27a">1.13 </span><span class="wsa0">小节<span class="ff4 ls1b">)</span>。<span class="_ _1"></span>例如，<span class="_ _1"></span>如</span></span></div><div class="t m0 x5 h9 y3ba ff1 fs3 fc0 sc0 ls4">果<span class="ff6 ls0 ws27b">User </span><span class="ls0 ws14">实例还有一个 <span class="ff6 ws27b">first<span class="_ _7"> </span>name </span></span>和<span class="ff6 ls0 ws27b">last<span class="_ _16"> </span>name <span class="ff1">属性，那么可以向下面这样排序：</span></span></div><div class="t m0 x5 hf y3bb ff8 fs5 fc0 sc0 ls0 ws155">by_name <span class="fc6 ls32">=</span><span class="fca ws13a">sorted</span><span class="ws13b">(users, key<span class="fc6 ws13a">=<span class="fc0">attrgetter(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">last_name<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">first_name<span class="ff9 ls34">&apos;</span></span>))</span></span></span></div><div class="t m0 x0 h9 y3bc ff1 fs3 fc0 sc0 ls10 ws27c">同样需要注意的是<span class="_ _1"></span>，这一小节用到的技术同样适用于像 <span class="ff6 ls0 ws27d">min() </span><span class="ls47">和<span class="ff6 ls0 ws27d">max() <span class="ff1 wsa0">之<span class="_ _6"></span>类的<span class="_ _6"></span>函</span></span></span></div><div class="t m0 x5 h9 y3bd ff1 fs3 fc0 sc0 ls0">数。比如：</div><div class="t m0 x5 hf y3be ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">min<span class="fc0 ws4">(users, key<span class="fc6 ls34">=</span><span class="ws13a">attrgetter(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">user_id<span class="ff9 ws13b">&apos;</span></span>)</span></span></span></div><div class="t m0 x5 hf y3bf ff8 fs5 fc8 sc0 ls0">User(3)</div><div class="t m0 x5 hf y3c0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">max<span class="fc0 ws4">(users, key<span class="fc6 ls34">=</span><span class="ws13a">attrgetter(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">user_id<span class="ff9 ws13b">&apos;</span></span>)</span></span></span></div><div class="t m0 x5 hf y3c1 ff8 fs5 fc8 sc0 ls0">User(99)</div><div class="t m0 x5 hf y3c2 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 hd y3c3 ff2 fs4 fc4 sc0 ls0 ws211">3.15<span class="_ _e"> </span>1.15 <span class="ff1">通过某个字段将记录分组</span></div><div class="t m0 x5 he y3c4 ff2 fs2 fc4 sc0 ls0 ws212">3.15.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y3c5 ff1 fs3 fc0 sc0 lse ws27e">你有一个字典或者实例的序列，然后你想根据某个特定的字段比如 <span class="ff6 ls0 ws27f">date <span class="ff1 wsa0">来分组<span class="_ _6"></span>迭</span></span></div><div class="t m0 x5 h9 y3c6 ff1 fs3 fc0 sc0 ls0">代访问。</div><div class="t m0 x5 he y3c7 ff2 fs2 fc4 sc0 ls0 ws212">3.15.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y3c8 ff6 fs3 fc0 sc0 ls0 ws280">itertools.groupby() <span class="ff1 wsa0">函数对于这样的数据分组操作非常实用。为了演示，假设你</span></div><div class="t m0 x5 h9 y3c9 ff1 fs3 fc0 sc0 ls0">已经有了下列的字典列表：</div><div class="t m0 x5 hf y3ca ff8 fs5 fc0 sc0 ls0 ws13c">rows <span class="fc6 ls32">=</span>[</div><div class="t m0 x15 hf y3cb ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">address</span><span class="ls34">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws4">5412 N CLARK</span><span class="ls34">&apos;</span></span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">date</span>&apos;</span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">07/01/2012</span>&apos;</span><span class="ls0">},</span></div><div class="t m0 x15 hf y3cc ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">address</span><span class="ls34">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws4">5148 N CLARK</span><span class="ls34">&apos;</span></span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">date</span>&apos;</span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">07/04/2012</span>&apos;</span><span class="ls0">},</span></div><div class="t m0 x15 hf y3cd ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">address</span><span class="ls34">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws4">5800 E 58TH</span><span class="ls34">&apos;</span></span>,<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">date</span><span class="ls34">&apos;</span></span><span class="ls32">:</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">07/02/2012</span>&apos;</span><span class="ls0">},</span></div><div class="t m0 x15 hf y95 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">address</span><span class="ls34">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws4">2122 N CLARK</span><span class="ls34">&apos;</span></span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">date</span>&apos;</span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">07/03/2012</span>&apos;</span><span class="ls0">},</span></div><div class="t m0 x15 hf y3ce ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">address</span><span class="ls34">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws4">5645 N RAVENSWOOD</span>&apos;</span>,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">date</span><span class="ls0 ws13b">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">07/02/2012</span>&apos;</span><span class="ls0">},</span></span></div><div class="t m0 x15 hf y3cf ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">address</span><span class="ls34">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws4">1060 W ADDISON</span>&apos;</span>,<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">date</span><span class="ls34">&apos;</span></span>:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">07/02/2012</span>&apos;</span><span class="ls0">},</span></span></div><div class="t m0 x15 hf y3d0 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">address</span><span class="ls34">&apos;</span></span><span class="ls33">:<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws4">4801 N BROADWAY</span><span class="ls34">&apos;</span></span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">date</span>&apos;</span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">07/01/2012</span>&apos;</span><span class="ls0">},</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">3.15.<span class="_ _5"> </span>1.15 <span class="ff1 ws281">通过某个字段将记录分组 </span>28</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
