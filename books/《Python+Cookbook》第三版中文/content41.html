<div id="pf29" class="pf w0 h0" data-page-no="29"><div class="pc pc29 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg29.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 hf y432 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">1039 W GRANVILLE</span>&apos;<span class="ff8 fc0 ls0">,</span></div><div class="t m0 x5 hf y433 ff8 fs5 fc0 sc0 ls0">]</div><div class="t m0 x5 hf y434 ff8 fs5 fc0 sc0 ls0 ws145">counts <span class="fc6 ls33">=</span><span class="ls32">[<span class="fc7 ls34">0</span>,<span class="fc7 ls34">3</span>,</span><span class="fc7 ws13a">10</span><span class="ls32">,<span class="fc7 ls34">4</span>,<span class="fc7 ls34">1</span><span class="ls33">,</span></span><span class="fc7 ws13a">7</span><span class="ls33">,<span class="fc7 ls34">6</span><span class="ls32">,<span class="fc7 ls34">1</span></span></span>]</div><div class="t m0 x0 h7 y435 ff1 fs3 fc0 sc0 ls0 ws38">现在你想将那些对应 <span class="ff6 ws17d">count </span>值大于 <span class="ff4 ls39">5</span>的地址全部输出，那么你可以这样做：</div><div class="t m0 x5 hf y9b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws15a">from <span class="fcc ws285">itertools </span><span class="ws146">import <span class="ff8 fc0">compress</span></span></span></div><div class="t m0 x5 hf y436 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">more5 <span class="fc6 ls33">=</span><span class="ws159">[n <span class="fc6 ls32">&gt;<span class="fc7 ls33">5</span></span></span></span><span class="fca">for <span class="ff8 fc0 ls32">n</span><span class="ws157">in <span class="ff8 fc0">counts]</span></span></span></div><div class="t m0 x5 hf y437 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">more5</span></div><div class="t m0 x5 hf y438 ff8 fs5 fc8 sc0 ls0 ws4">[False, False, True, False, False, True, True, False]</div><div class="t m0 x5 hf y439 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">list<span class="fc0 ws13b">(compress(addresses, more5))</span></span></div><div class="t m0 x5 hf y43a ff8 fs5 fc8 sc0 ls34">[<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">5800 E 58TH</span><span class="ff9">&apos;</span><span class="ls33">,<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">4801 N BROADWAY</span></span><span class="ff9">&apos;</span><span class="ls32">,</span><span class="ff9">&apos;</span><span class="ls0 ws4">1039 W GRANVILLE</span><span class="ff9">&apos;</span><span class="ls0">]</span></div><div class="t m0 x5 hf y43b ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y43c ff1 fs3 fc0 sc0 ls6d ws29e">这里的关键点在于先创建一个 <span class="ff6 ls0 ws29f">Boolean </span><span class="ws2a0">序列<span class="_ _8"></span>，指示哪些元素复合条件<span class="_ _8"></span>。然后<span class="_ _8"></span></span></div><div class="t m0 x5 h9 y43d ff6 fs3 fc0 sc0 ls0 ws17c">compress() <span class="ff1 ws14">函数根据这个序列去选择输出对应位置为 </span><span class="ws17a">True <span class="ff1">的元素。</span></span></div><div class="t m0 x0 h9 y43e ff1 fs3 fc0 sc0 ls6e">和<span class="ff6 ls0 ws2a1">filter() </span><span class="ls0 ws2a2">函数<span class="_ _6"></span>类<span class="_ _6"></span>似， <span class="ff6 ws247">compress() </span></span><span class="ls30 ws138">也是返回的一个迭代器。因此<span class="_ _c"></span>，如果你需要</span></div><div class="t m0 x5 h9 y43f ff1 fs3 fc0 sc0 ls0 ws14">得到一个列表，那么你需要使用 <span class="ff6 ws25d">list() </span>来将结果转换为列表类型。</div><div class="t m0 x5 hd y440 ff2 fs4 fc4 sc0 ls0 ws211">3.17<span class="_ _e"> </span>1.17 <span class="ff1">从字典中提取子集</span></div><div class="t m0 x5 he y441 ff2 fs2 fc4 sc0 ls0 ws212">3.17.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y442 ff1 fs3 fc0 sc0 ls0">你想构造一个字典，它是另外一个字典的子集。</div><div class="t m0 x5 he y443 ff2 fs2 fc4 sc0 ls0 ws212">3.17.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y444 ff1 fs3 fc0 sc0 ls0">最简单的方式是使用字典推导。比如：</div><div class="t m0 x5 hf y445 ff8 fs5 fc0 sc0 ls0 ws145">prices <span class="fc6 ls33">=</span>{</div><div class="t m0 x15 hf y446 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">ACME</span><span class="ls0 ws13b">&apos;<span class="ff8 fc0 ls33">:<span class="fc7 ls0 ws13a">45.23<span class="fc0">,</span></span></span></span></div><div class="t m0 x15 hf y447 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">AAPL</span><span class="ls0 ws13b">&apos;<span class="ff8 fc0 ls33">:<span class="fc7 ls0 ws13a">612.78<span class="fc0">,</span></span></span></span></div><div class="t m0 x15 hf y448 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">IBM</span>&apos;<span class="ff8 fc0 ls32">:<span class="fc7 ls0 ws13a">205.55<span class="fc0">,</span></span></span></div><div class="t m0 x15 hf y449 ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">HPQ</span>&apos;<span class="ff8 fc0 ls32">:<span class="fc7 ls0 ws13a">37.20<span class="fc0">,</span></span></span></div><div class="t m0 x15 hf y44a ff9 fs5 fc9 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">FB</span>&apos;<span class="ff8 fc0 ls32">:<span class="fc7 ls0">10.75</span></span></div><div class="t m0 x5 hf y44b ff8 fs5 fc0 sc0 ls0">}</div><div class="t m0 x5 h11 y4 ffa fs5 fcd sc0 ls0 ws4"># Make a dictionary of all prices over 200</div><div class="t m0 x5 hf y44c ff8 fs5 fc0 sc0 ls0 ws159">p1 <span class="fc6 ls33">=</span><span class="ws13b">{key: value <span class="ff7 fca ws139">for </span><span class="ws4">key, value <span class="ff7 fca ws157">in </span><span class="ws13a">prices<span class="fc6 ls34">.</span><span class="ws1f4">items() <span class="ff7 fca ws160">if </span><span class="ws15f">value <span class="fc6 ls32">&gt;</span></span></span><span class="fc7">200</span>}</span></span></span></div><div class="t m0 x5 h11 y44d ffa fs5 fcd sc0 ls0 ws4"># Make a dictionary of tech stocks</div><div class="t m0 x5 hf y44e ff8 fs5 fc0 sc0 ls0 ws2a3">tech_names <span class="fc6 ls32">=</span><span class="ls34">{<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13a">AAPL<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">IBM<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">HPQ<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">MSFT<span class="ff9 ls34">&apos;</span></span>}</div><div class="t m0 x5 hf y44f ff8 fs5 fc0 sc0 ls0 ws159">p2 <span class="fc6 ls33">=</span><span class="ws13b">{key: value <span class="ff7 fca ws139">for </span><span class="ws4">key, value <span class="ff7 fca ws157">in </span><span class="ws13a">prices<span class="fc6 ls34">.</span><span class="ws1f4">items() <span class="ff7 fca ws160">if </span><span class="ws15b">key <span class="ff7 fca ws160">in </span>tech_names}</span></span></span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">3.17.<span class="_ _5"> </span>1.17 <span class="ff1 ws2a4">从字典中提取子集 </span>32</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
