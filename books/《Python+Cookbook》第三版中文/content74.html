<div id="pf4a" class="pf w0 h0" data-page-no="4a"><div class="pc pc4a w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg4a.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h9 y2a ff1 fs3 fc0 sc0 ls0 ws3d7">然<span class="_ _6"></span>而， <span class="ff6 ws29a">format() </span><span class="lsa7">和</span><span class="ff6 ws3b7">format map() </span><span class="ls40 ws180">相比较上面这些方案而已更加先进<span class="_ _1"></span>，因此应该<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y2b ff1 fs3 fc0 sc0 ls0 ws3d8">被优先选择。使用 <span class="ff6 ws2c7">format() </span>方法还有一个好处就是你可以获得对字符串格式化的所有</div><div class="t m0 x5 h7 y2c ff1 fs3 fc0 sc0 ls0 ws3d9">支持 <span class="ff4 ls1b">(</span><span class="wsa0">对<span class="_ _6"></span>齐，<span class="_ _6"></span>填<span class="_ _6"></span>充，数<span class="_ _6"></span>字<span class="_ _6"></span>格<span class="_ _6"></span>式化<span class="_ _6"></span>等<span class="_ _6"></span>待<span class="ff4 wsa5">)</span><span class="ls10 wsdf">，而这些特性是使用像模板字符串之类的方案不</span></span></div><div class="t m0 x5 h9 y2d ff1 fs3 fc0 sc0 ls0">可能获得的。</div><div class="t m0 x0 h9 y9a ff1 fs3 fc0 sc0 ls19 ws3da">本机还部分介绍了一些高级特性。映射或者字典类中鲜为人知的 <span class="ff6 ls0 ws3db">missing<span class="_ _e"> </span>() <span class="ff1">方</span></span></div><div class="t m0 x5 h9 y9b ff1 fs3 fc0 sc0 lsa8 ws3dc">法可以让你定义如何处理缺失的值。在 <span class="ff6 ls0 ws3dd">SafeSub </span><span class="ws3de">类中<span class="_ _1"></span>，这个方法被定义为对缺失的值</span></div><div class="t m0 x5 h7 y9c ff1 fs3 fc0 sc0 ls1f ws112">返回一个占位符。你可以发现缺失的值会出现在结果字符串中 <span class="ff4 ls0 wsa5">(</span><span class="ws113">在调试的时候可能很有</span></div><div class="t m0 x5 h7 y9d ff1 fs3 fc0 sc0 lsb">用<span class="ff4 ls0 wsa5">)</span><span class="ls0 ws14">，而不是产生一个 <span class="ff6 ws1f3">KeyError </span>异常。</span></div><div class="t m0 x0 h9 y33 ff6 fs3 fc0 sc0 ls0 ws3df">sub() <span class="ff1 lsa9 ws3e0">函数使用 </span><span class="ws3e1">sys. getframe(1)<span class="_ _1c"> </span><span class="ff1 lsa9 ws3e2">返回调用者的栈帧<span class="_ _1d"></span>。可以从中访问属性<span class="_ _1d"></span></span></span></div><div class="t m0 x5 h9 y34 ff6 fs3 fc0 sc0 ls0 ws3e3">f locals<span class="_ _1e"> </span><span class="ff1 lsaa ws3e4">来获得局部变量<span class="_ _8"></span>。毫无疑问绝大部分情况下在代码中去直接操作栈帧应<span class="_ _d"></span></span></div><div class="t m0 x5 h9 y35 ff1 fs3 fc0 sc0 ls1e ws111">该是不推荐的<span class="_ _1"></span>。但是，对于像字符串替换工具函数而言它是非常有用的<span class="_ _c"></span>。<span class="_ _6"></span>另外<span class="_ _1"></span>，值得</div><div class="t m0 x5 h9 y36 ff1 fs3 fc0 sc0 ls0 ws3e5">注意的是 <span class="ff6 ws3e6">f<span class="_ _7"> </span>locals </span><span class="ws3e7">是一个复制调用函数的本地变量的字典。<span class="_ _c"></span>尽管你可以改变 <span class="ff6 ws3e3">f locals</span></span></div><div class="t m0 x5 h9 y37 ff1 fs3 fc0 sc0 ls1e ws111">的内容<span class="_ _1"></span>，但是这个修改对于后面的变量访问没有任何影响<span class="_ _1"></span>。所以，虽说访问一个<span class="_ _1"></span>栈帧</div><div class="t m0 x5 h9 y38 ff1 fs3 fc0 sc0 ls0">看上去很邪恶，但是对它的任何操作不会覆盖和改变调用者本地变量的值。</div><div class="t m0 x5 hd y82c ff2 fs4 fc4 sc0 ls0 ws211">4.16<span class="_ _e"> </span>2.16 <span class="ff1">以指定列宽格式化字符串</span></div><div class="t m0 x5 he y82d ff2 fs2 fc4 sc0 ls0 ws212">4.16.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y82e ff1 fs3 fc0 sc0 ls0">你有一些长字符串，想以指定的列宽将它们重新格式化。</div><div class="t m0 x5 he y82f ff2 fs2 fc4 sc0 ls0 ws212">4.16.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y830 ff1 fs3 fc0 sc0 ls0 wsc">使用 <span class="ff6 ws26f">textwrap </span>模块来格式化字符串的输出。比如，假如你有下列的长字符串：</div><div class="t m0 x5 hf y831 ff8 fs5 fc0 sc0 ls32">s<span class="fc6 ls33">=<span class="fc9 ls0 ws4">&quot;Look into my eyes, look into my eyes, the eyes, the eyes, <span class="ff7">\</span></span></span></div><div class="t m0 x5 hf y832 ff8 fs5 fc9 sc0 ls0 ws4">the eyes, not around the eyes, don<span class="ff9 ws13b">&apos;</span>t look around the eyes, <span class="ff7">\</span></div><div class="t m0 x5 hf y833 ff8 fs5 fc9 sc0 ls0 ws4">look into my eyes, you<span class="ff9 ls34">&apos;</span><span class="ws13b">re under.&quot;</span></div><div class="t m0 x0 h9 y834 ff1 fs3 fc0 sc0 ls0 wsc">下面演示使用 <span class="ff6 ws26f">textwrap </span>格式化字符串的多种方式：</div><div class="t m0 x5 h10 y835 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">textwrap</span></span></div><div class="t m0 x5 hf y836 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0 ws13a">(textwrap<span class="fc6 ls34">.</span><span class="ws155">fill(s, </span><span class="fc7">70</span>))</span></span></div><div class="t m0 x5 hf y837 ff8 fs5 fc8 sc0 ls0 ws4">Look into my eyes, look into my eyes, the eyes, the eyes, the eyes,</div><div class="t m0 x5 hf y838 ff8 fs5 fc8 sc0 ls0 ws4">not around the eyes, don<span class="ff9 ls34">&apos;</span>t look around the eyes, look into my eyes,</div><div class="t m0 x5 hf y839 ff8 fs5 fc8 sc0 ls0 ws13a">you<span class="ff9 ls34">&apos;</span><span class="ws13b">re under.</span></div><div class="t m0 x5 hf y83a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0 ws13a">(textwrap<span class="fc6 ls34">.</span><span class="ws155">fill(s, </span><span class="fc7">40</span>))</span></span></div><div class="t m0 x5 hf y83b ff8 fs5 fc8 sc0 ls0 ws4">Look into my eyes, look into my eyes,</div><div class="t m0 x5 hf y83c ff8 fs5 fc8 sc0 ls0 ws4">the eyes, the eyes, the eyes, not around</div><div class="t m0 x5 hf y83d ff8 fs5 fc8 sc0 ls0 ws4">the eyes, don<span class="ff9 ls34">&apos;</span>t look around the eyes,</div><div class="t m0 x5 hf y83e ff8 fs5 fc8 sc0 ls0 ws4">look into my eyes, you<span class="ff9 ls34">&apos;</span><span class="ws13b">re under.</span></div><div class="t m0 x5 hf y83f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0 ws13a">(textwrap<span class="fc6 ls34">.</span><span class="ws155">fill(s, </span><span class="fc7">40</span><span class="ws4">, initial_indent</span><span class="fc6">=<span class="ff9 fc9 ws3e8">&apos; &apos;</span></span>))</span></span></div><div class="t m0 x15 hf y840 ff8 fs5 fc8 sc0 ls0 ws4">Look into my eyes, look into my</div><div class="t m0 x5 hf y841 ff8 fs5 fc8 sc0 ls0 ws4">eyes, the eyes, the eyes, the eyes, not</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.16.<span class="_ _5"> </span>2.16 <span class="ff1 ws281">以指定列宽格式化字符串 </span>65</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
