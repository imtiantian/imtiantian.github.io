<div id="pf72" class="pf w0 h0" data-page-no="72"><div class="pc pc72 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg72.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws212">5.14.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y236 ff1 fs3 fc0 sc0 ls3a ws153">在这样的日期上循环并需要事先构造一个包含所有日期的列表。你可以先计算出开</div><div class="t m0 x5 h9 y237 ff1 fs3 fc0 sc0 ls6c ws51b">始日期和结束日期<span class="_ _1"></span>，然后在你步进的时候使用 <span class="ff6 ls0 ws51c">datetime.timedelta </span><span class="ws29d">对象递增这个日<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y238 ff1 fs3 fc0 sc0 ls0">期变量即可。</div><div class="t m0 x0 h9 y278 ff1 fs3 fc0 sc0 ls18 ws51d">下面是一个接受任意 <span class="ff6 ls0 ws214">datetime <span class="ff1 wsa0">对象<span class="_ _6"></span>并返回<span class="_ _6"></span>一个由<span class="_ _6"></span>当前月<span class="_ _6"></span>份开始<span class="_ _6"></span>日和下<span class="_ _6"></span>个月<span class="_ _6"></span>开始日</span></span></div><div class="t m0 x5 h9 y279 ff1 fs3 fc0 sc0 ls0">组成的元组对象。</div><div class="t m0 x5 hf ycbc ff7 fs5 fca sc0 ls0 ws15a">from <span class="fcc ws248">datetime </span><span class="ws146">import <span class="ff8 fc0 ws4">datetime, date, timedelta</span></span></div><div class="t m0 x5 h10 ycbd ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">calendar</span></div><div class="t m0 x5 hf y35 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">get_month_range<span class="fc0">(start_date<span class="fc6 ls34">=</span><span class="fca">None</span>):</span></span></div><div class="t m0 x15 hf ycbe ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws2a3">start_date </span>is <span class="ff8 ws13a">None<span class="fc0">:</span></span></div><div class="t m0 x16 hf ycbf ff8 fs5 fc0 sc0 ls0 ws2a3">start_date <span class="fc6 ls32">=</span><span class="ws13a">date<span class="fc6 ls34">.</span>today()<span class="fc6 ls34">.</span>replace(day<span class="fc6">=<span class="fc7 ls34">1</span></span>)</span></div><div class="t m0 x15 hf ycc0 ff8 fs5 fc0 sc0 ls0 ws13b">_, days_in_month <span class="fc6 ls33">=</span><span class="ws13a">calendar<span class="fc6">.</span>monthrange(start_date<span class="fc6">.</span><span class="ws4">year, start_date<span class="fc6 ls34">.</span>month)</span></span></div><div class="t m0 x15 hf ycc1 ff8 fs5 fc0 sc0 ls0 ws1f5">end_date <span class="fc6 ls33">=</span><span class="ws2a3">start_date <span class="fc6 ls32">+</span><span class="ws13a">timedelta(days<span class="fc6">=</span>days_in_month)</span></span></div><div class="t m0 x15 hf ycc2 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0 ws4">(start_date, end_date)</span></div><div class="t m0 x0 h9 ycc3 ff1 fs3 fc0 sc0 ls0">有了这个就可以很容易的在返回的日期范围上面做循环操作了：</div><div class="t m0 x5 hf ycc4 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws15f">a_day <span class="fc6 ls33">=</span><span class="ws13a">timedelta(days<span class="fc6 ls34">=</span><span class="fc7">1</span>)</span></span></div><div class="t m0 x5 hf ycc5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13b">first_day, last_day <span class="fc6 ls33">=</span>get_month_range()</span></div><div class="t m0 x5 hf ycc6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws16a">while <span class="ff8 fc0 ws51e">first_day <span class="fc6 ls32">&lt;</span>last_day:</span></span></div><div class="t m0 x5 hf ycc7 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="fca ws156">print<span class="ff8 fc0">(first_day)</span></span></div><div class="t m0 x5 hf ycc8 ff7 fs5 fc5 sc0 ls0 ws1a2">... <span class="ff8 fc0 ws16e">first_day <span class="fc6 ws23d">+= </span>a_day</span></div><div class="t m0 x5 h10 ycc9 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf ycca ff8 fs5 fc8 sc0 ls0">2012-08-01</div><div class="t m0 x5 hf yccb ff8 fs5 fc8 sc0 ls0">2012-08-02</div><div class="t m0 x5 hf y302 ff8 fs5 fc8 sc0 ls0">2012-08-03</div><div class="t m0 x5 hf yccc ff8 fs5 fc8 sc0 ls0">2012-08-04</div><div class="t m0 x5 hf yccd ff8 fs5 fc8 sc0 ls0">2012-08-05</div><div class="t m0 x5 hf ycce ff8 fs5 fc8 sc0 ls0">2012-08-06</div><div class="t m0 x5 hf yccf ff8 fs5 fc8 sc0 ls0">2012-08-07</div><div class="t m0 x5 hf ycd0 ff8 fs5 fc8 sc0 ls0">2012-08-08</div><div class="t m0 x5 hf ycd1 ff8 fs5 fc8 sc0 ls0">2012-08-09</div><div class="t m0 x5 hf ycd2 ff8 fs5 fc8 sc0 ls0 ws4">#... and so on...</div><div class="t m0 x5 he ycd3 ff2 fs2 fc4 sc0 ls0 ws212">5.14.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 ycd4 ff1 fs3 fc0 sc0 ls2d ws51f">上面的代码先计算出一个对应月份第一天的日期。一个快速的方法就是使用 <span class="ff6 ls0">date</span></div><div class="t m0 x5 h7 ycd5 ff1 fs3 fc0 sc0 lsdd">或<span class="ff6 ls0 ws520">datetime </span><span class="ls36 ws521">对象的 </span><span class="ff6 ls0 ws522">replace() </span><span class="ls36 ws523">方法简单的将 </span><span class="ff6 ls0 ws524">days </span><span class="ls36 ws525">属性设置成 <span class="ff4 lsde">1</span></span><span class="ls0 ws526">即<span class="_ _6"></span>可。 <span class="ff6">replace()</span></span></div><div class="t m0 x5 h9 ycd6 ff1 fs3 fc0 sc0 ls13 wse5">方法一个好处就是它会创建和你开始传入对象类型相同的对象<span class="_ _1"></span>。所以，如果输入参数<span class="_ _c"></span></div><div class="t m0 x5 h9 ycd7 ff1 fs3 fc0 sc0 ls0 ws2c4">是一个 <span class="ff6 ws527">date </span><span class="ws528">实例，那么结果也是一个 <span class="ff6 ws527">date </span><span class="ws529">实例。<span class="_ _1"></span>同样的，如果输入是一个 <span class="ff6">datetime</span></span></span></div><div class="t m0 x5 h9 ycd8 ff1 fs3 fc0 sc0 ls0 ws38">实例，那么你得到的就是一个 <span class="ff6 ws26f">datetime </span>实例。</div><div class="t m0 x0 h9 ycd9 ff1 fs3 fc0 sc0 ls0 ws52a">然<span class="_ _6"></span>后，<span class="_ _6"></span>使<span class="_ _6"></span>用 <span class="ff6 ws52b">calendar.monthrange() </span><span class="ls14 ws174">函数来找出该月的总天数<span class="_ _1"></span>。任何时候只要你<span class="_ _1"></span></span></div><div class="t m0 x5 h9 ycda ff1 fs3 fc0 sc0 ls68 ws52c">想获得日历信息，那么 <span class="ff6 ls0 ws259">calendar </span><span class="ws52d">模块就非常有用了。 <span class="ff6 ls0 ws257">monthrange() </span><span class="ws23f">函数会返回包含</span></span></div><div class="t m0 x5 h9 ycdb ff1 fs3 fc0 sc0 ls0">星期和该月天数的元组。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">5.14.<span class="_ _5"> </span>3.14 <span class="ff1 ws512">计算当前月份的日期范围 </span>105</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
