<div id="pf3d" class="pf w0 h0" data-page-no="3d"><div class="pc pc3d w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg3d.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws155">comment <span class="fc6 ls32">=</span><span class="ws13a">re<span class="fc6">.</span>compile(<span class="fc9 ls34">r<span class="ff9">&apos;</span><span class="ls0">/\*(.*?)\*/<span class="ff9 ws13b">&apos;</span></span></span><span class="ws4">, re<span class="fc6 ls34">.</span>DOTALL)</span></span></span></div><div class="t m0 x5 hf y1ac ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">comment<span class="fc6 ls34">.</span>findall(text2)</span></div><div class="t m0 x5 hf y1ad ff8 fs5 fc8 sc0 ls34">[<span class="ff9 ls32">&apos;</span><span class="ls0 ws4">this is a\n multiline comment </span><span class="ff9">&apos;</span><span class="ls0">]</span></div><div class="t m0 x0 h9 y30d ff1 fs3 fc0 sc0 ls14 ws339">对于简单的情况使用 <span class="ff6 ls0 ws33a">re.DOTALL </span><span class="ws174">标记参数工作的很好<span class="_ _1"></span>，但是如果模式非常复杂或</span></div><div class="t m0 x5 h7 y30e ff1 fs3 fc0 sc0 ls6b ws33b">者是为了构造字符串令牌而将多个模式合并起来 <span class="ff4 ls0 ws33c">(2.18 <span class="ff1 wsa0">节有<span class="_ _6"></span>详<span class="_ _6"></span>细描<span class="_ _6"></span>述</span><span class="ls1b">)</span></span><span class="ws28f">，这时候使用这</span></div><div class="t m0 x5 h9 y695 ff1 fs3 fc0 sc0 ls13 wse5">个标记参数就可能出现一些问题<span class="_ _1"></span>。如果让你选择的话，最好还是定义自己的正则表达<span class="_ _c"></span></div><div class="t m0 x5 h9 y696 ff1 fs3 fc0 sc0 ls0">式模式，这样它可以在不需要额外的标记参数下也能工作的很好。</div><div class="t m0 x5 hd y697 ff2 fs4 fc4 sc0 ls0 ws134">4.9<span class="_ _e"> </span>2.9 <span class="ff1 ls7c">将</span><span class="ws33d">Unico<span class="_ _6"></span>de <span class="ff1">文本标准化</span></span></div><div class="t m0 x5 he y698 ff2 fs2 fc4 sc0 ls0 ws135">4.9.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y699 ff1 fs3 fc0 sc0 ls0 ws38">你正在处理 <span class="ff4 wsc1">Unico<span class="_ _6"></span>de </span>字符串，需要确保所有字符串在底层有相同的表示。</div><div class="t m0 x5 he y69a ff2 fs2 fc4 sc0 ls0 ws135">4.9.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y69b ff1 fs3 fc0 sc0 ls8d">在<span class="ff4 ls0 ws33e">Unico<span class="_ _6"></span>de </span><span class="ls0 wsa0">中，某些字符能够用多个合法的编码表示。<span class="_ _1"></span>为了说明，考虑下面的这个</span></div><div class="t m0 x5 h9 y69c ff1 fs3 fc0 sc0 ls0">例子：</div><div class="t m0 x5 hf y69d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">s1 <span class="fc6 ls33">=</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Spicy Jalape<span class="ff7 ws156">\u00f1</span><span class="ls34">o</span></span>&apos;</span></span></div><div class="t m0 x5 hf y69e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">s2 <span class="fc6 ls33">=</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Spicy Jalapen<span class="ff7 ws156">\u0303</span><span class="ls34">o</span></span>&apos;</span></span></div><div class="t m0 x5 hf y69f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">s1</span></div><div class="t m0 x5 hf y6a0 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">Spicy Jalapeño<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y6a1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">s2</span></div><div class="t m0 x5 hf y6a2 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">Spicy Jalapeño<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y6a3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">s1 <span class="fc6">== </span>s2</span></div><div class="t m0 x5 hf y6a4 ff8 fs5 fc8 sc0 ls0">False</div><div class="t m0 x5 hf y6a5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">len<span class="fc0">(s1)</span></span></div><div class="t m0 x5 hf y6a6 ff8 fs5 fc8 sc0 ls0">14</div><div class="t m0 x5 hf y6a7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fca ws13a">len<span class="fc0">(s2)</span></span></div><div class="t m0 x5 hf y6a8 ff8 fs5 fc8 sc0 ls0">15</div><div class="t m0 x5 hf y6a9 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y6aa ff1 fs3 fc0 sc0 lsf wsdb">这里的文本<span class="_ _c"></span><span class="ff4 ls0 ws33f">”Spicy Jalap<span class="_ _6"></span>eño” <span class="ff1 lsf wsdb">使用了两种形式来表示。第一种使用整体字符<span class="_ _c"></span><span class="ff4 ls0">”ñ”(U</span></span></span></div><div class="t m0 x5 h7 y6ab ff4 fs3 fc0 sc0 ls0 wsa5">+00F1)<span class="ff1 wsa0">，第二种使用拉丁字母</span><span class="ws340">”n” <span class="ff1 wsa0">后面跟一个</span><span class="ls8e">”</span><span class="fff ws305">˜</span><span class="ls89">”</span><span class="ff1 ws38">的组合字符 </span></span>(U+0303)<span class="ff1">。</span></div><div class="t m0 x0 h9 y6ac ff1 fs3 fc0 sc0 ls22 ws119">在需要比较字符串的程序中使用字符的多种表示会产生问题。为了修正这个问题<span class="_ _1"></span>，</div><div class="t m0 x5 h7 y6ad ff1 fs3 fc0 sc0 ls0 ws38">你可以使用 <span class="ff4 ws341">unico<span class="_ _6"></span>dedata </span>模块先将文本标准化：</div><div class="t m0 x5 h10 y6ae ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">unicodedata</span></span></div><div class="t m0 x5 hf y6af ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">t1 <span class="fc6 ls33">=</span><span class="ws13a">unicodedata<span class="fc6">.</span>normalize(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">NFC<span class="ff9 ls34">&apos;</span></span><span class="ws4">, s1)</span></span></span></div><div class="t m0 x5 hf y6b0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">t2 <span class="fc6 ls33">=</span><span class="ws13a">unicodedata<span class="fc6">.</span>normalize(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">NFC<span class="ff9 ls34">&apos;</span></span><span class="ws4">, s2)</span></span></span></div><div class="t m0 x5 hf y6b1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">t1 <span class="fc6">== </span>t2</span></div><div class="t m0 x5 hf y6b2 ff8 fs5 fc8 sc0 ls0">True</div><div class="t m0 x5 hf y6b3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(ascii(t1))</span></span></div><div class="t m0 x5 hf y6b4 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13b">Spicy Jalape\xf1o<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y6b5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">t3 <span class="fc6 ls33">=</span><span class="ws13a">unicodedata<span class="fc6">.</span>normalize(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">NFD<span class="ff9 ls34">&apos;</span></span><span class="ws4">, s1)</span></span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">4.9.<span class="_ _5"> </span>2.9 <span class="ff1 ls81">将</span><span class="ws342">Unico<span class="_ _6"></span>de <span class="ff1 ws343">文本标准化 </span>52</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
