<div id="pf15" class="pf w0 h0" data-page-no="15"><div class="pc pc15 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg15.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">q<span class="fc6 ls0 ws13a">.<span class="fc0">pop()</span></span></span></div><div class="t m0 x5 hf y1ac ff8 fs5 fc8 sc0 ls0">3</div><div class="t m0 x5 hf y1ad ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">q</span></div><div class="t m0 x5 hf y1ae ff8 fs5 fc8 sc0 ls0 ws4">deque([4, 1, 2])</div><div class="t m0 x5 hf y1af ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">q<span class="fc6 ls0 ws13a">.<span class="fc0">popleft()</span></span></span></div><div class="t m0 x5 hf y1b0 ff8 fs5 fc8 sc0 ls0">4</div><div class="t m0 x0 h9 y1b1 ff1 fs3 fc0 sc0 lse ws178">在队列两端插入或删除元素时间复杂度都是 <span class="ff6 ls0 ws179">O(1) </span><span class="wsd8">，而在列表的开头插入或删除元<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y1b2 ff1 fs3 fc0 sc0 ls0 ws14">素的时间复杂度为 <span class="ff6 ws17a">O(N) </span>。</div><div class="t m0 x5 hd y1b3 ff2 fs4 fc4 sc0 ls0 ws134">3.4<span class="_ _e"> </span>1.4 <span class="ff1 ws165">查找最大或最小的 </span><span class="ls3e">N</span><span class="ff1">个元素</span></div><div class="t m0 x5 he y1b4 ff2 fs2 fc4 sc0 ls0 ws135">3.4.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y1b5 ff1 fs3 fc0 sc0 ls0 ws38">怎样从一个集合中获得最大或者最小的 <span class="ff4 ls3">N</span>个元素列表？</div><div class="t m0 x5 he y1b6 ff2 fs2 fc4 sc0 ls0 ws135">3.4.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y1b7 ff4 fs3 fc0 sc0 ls0 ws17b">heap<span class="_ _6"></span>q <span class="ff1 wsa0">模块有两个函数：<span class="ff6 ws17c">nlargest() </span><span class="ls4">和</span><span class="ff6 ws133">nsmallest() </span>可以完美解决这个问题。</span></div><div class="t m0 x5 h10 y1b8 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">heapq</span></div><div class="t m0 x5 hf y1b9 ff8 fs5 fc0 sc0 ls0 ws13c">nums <span class="fc6 ls32">=</span><span class="ls34">[<span class="fc7">1</span><span class="ls32">,</span><span class="fc7">8</span><span class="ls32">,</span><span class="fc7">2</span><span class="ls32">,</span></span><span class="fc7 ws13a">23</span><span class="ls32">,<span class="fc7 ls34">7</span>,<span class="fc6 ls34">-<span class="fc7">4</span></span>,</span><span class="fc7 ws13a">18</span><span class="ls32">,</span><span class="fc7 ws13a">23</span><span class="ls32">,</span><span class="fc7 ws13a">42</span><span class="ls32">,</span><span class="fc7 ws13a">37</span><span class="ls32">,<span class="fc7 ls34">2</span></span>]</div><div class="t m0 x5 hf y1ba ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(heapq<span class="fc6 ls34">.</span>nlargest(<span class="fc7 ls34">3</span><span class="ws13b">, nums)) <span class="ffa fcd ws4"># Prints [42, 37, 23]</span></span></span></div><div class="t m0 x5 hf y1bb ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(heapq<span class="fc6 ls34">.</span>nsmallest(<span class="fc7 ls34">3</span><span class="ws13b">, nums)) <span class="ffa fcd ws4"># Prints [-4, 1, 2]</span></span></span></div><div class="t m0 x0 h9 y1bc ff1 fs3 fc0 sc0 ls0">两个函数都能接受一个关键字参数，用于更复杂的数据结构中：</div><div class="t m0 x5 hf y1bd ff8 fs5 fc0 sc0 ls0 ws16e">portfolio <span class="fc6 ls33">=</span>[</div><div class="t m0 x15 hf y1be ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">name</span><span class="ls34">&apos;</span></span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">IBM</span>&apos;</span><span class="ls33">,<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">shares</span>&apos;</span>:<span class="fc7 ls0 ws13a">100</span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">price</span>&apos;</span><span class="ls32">:<span class="fc7 ls0 ws13a">91.1<span class="fc0">},</span></span></span></div><div class="t m0 x15 hf y1bf ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">name</span><span class="ls34">&apos;</span></span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">AAPL</span>&apos;</span><span class="ls32">,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">shares</span>&apos;</span><span class="ls33">:<span class="fc7 ls0 ws13a">50</span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">price</span>&apos;</span><span class="ls32">:<span class="fc7 ls0 ws13a">543.22<span class="fc0">},</span></span></span></div><div class="t m0 x15 hf y1c0 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">name</span><span class="ls34">&apos;</span></span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">FB</span><span class="ls0 ws13b">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">shares</span>&apos;</span><span class="ls32">:<span class="fc7 ls0 ws13a">200</span><span class="ls33">,<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">price</span><span class="ls34">&apos;</span></span></span>:<span class="fc7 ls0 ws13a">21.09<span class="fc0">},</span></span></span></div><div class="t m0 x15 hf y1c1 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">name</span><span class="ls34">&apos;</span></span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">HPQ</span>&apos;</span><span class="ls33">,<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">shares</span>&apos;</span>:<span class="fc7 ls0 ws13a">35</span>,<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">price</span><span class="ls34">&apos;</span></span><span class="ls32">:<span class="fc7 ls0 ws13a">31.75<span class="fc0">},</span></span></span></span></div><div class="t m0 x15 hf y1c2 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">name</span><span class="ls34">&apos;</span></span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">YHOO</span>&apos;</span><span class="ls32">,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">shares</span>&apos;</span><span class="ls33">:<span class="fc7 ls0 ws13a">45</span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">price</span>&apos;</span><span class="ls32">:<span class="fc7 ls0 ws13a">16.35<span class="fc0">},</span></span></span></div><div class="t m0 x15 hf y1c3 ff8 fs5 fc0 sc0 ls34">{<span class="ff9 fc9 ls0 ws13b">&apos;<span class="ff8 ws13a">name</span><span class="ls34">&apos;</span></span><span class="ls32">:</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">ACME</span>&apos;</span><span class="ls32">,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">shares</span>&apos;</span><span class="ls33">:<span class="fc7 ls0 ws13a">75</span><span class="ls32">,</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">price</span>&apos;</span><span class="ls32">:<span class="fc7 ls0 ws13a">115.65<span class="fc0">}</span></span></span></div><div class="t m0 x5 hf y1c4 ff8 fs5 fc0 sc0 ls0">]</div><div class="t m0 x5 hf y1c5 ff8 fs5 fc0 sc0 ls0 ws15f">cheap <span class="fc6 ls33">=</span><span class="ws13a">heapq<span class="fc6 ls34">.</span>nsmallest(<span class="fc7 ls34">3</span><span class="ws4">, portfolio, key<span class="fc6 ls34">=</span><span class="ff7 fca ws146">lambda </span><span class="ws13b">s: s[<span class="ff9 fc9 ls34">&apos;</span></span></span><span class="fc9">price<span class="ff9 ws13b">&apos;</span></span>])</span></div><div class="t m0 x5 hf y1c6 ff8 fs5 fc0 sc0 ls0 ws16e">expensive <span class="fc6 ls33">=</span><span class="ws13a">heapq<span class="fc6 ls34">.</span>nlargest(<span class="fc7">3</span><span class="ws4">, portfolio, key<span class="fc6 ls34">=</span><span class="ff7 fca ws146">lambda </span><span class="ws13b">s: s[<span class="ff9 fc9 ls34">&apos;</span></span></span><span class="fc9">price<span class="ff9 ls34">&apos;</span></span>])</span></div><div class="t m0 x0 h9 y1c7 ff1 fs3 fc0 sc0 ls0 ws14">译者注：上面代码在对每个元素进行对比的时候，会以 <span class="ff6 ws17d">price </span>的值进行比较。</div><div class="t m0 x5 he y1c8 ff2 fs2 fc4 sc0 ls0 ws135">3.4.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h7 y1c9 ff1 fs3 fc0 sc0 ls40 ws17e">如果你想在一个集合中查找最小或最大的 <span class="ff4 ls41">N</span><span class="ls0 ws17f">个元<span class="_ _6"></span>素，<span class="_ _6"></span>并<span class="_ _6"></span>且 <span class="ff4 ls41">N</span></span><span class="ws180">小于集合元素数量，<span class="_ _c"></span></span></div><div class="t m0 x5 h9 y1ca ff1 fs3 fc0 sc0 ls13 wse5">那么这些函数提供了很好的性能<span class="_ _1"></span>。因为在底层实现里面，首先会先将集合数据进行堆<span class="_ _c"></span></div><div class="t m0 x5 h9 y1cb ff1 fs3 fc0 sc0 ls0">排序后放入一个列表中：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws13e">3.4.<span class="_ _5"> </span>1.4 <span class="ff1 ws16b">查找最大或最小的 </span><span class="ls3f">N</span><span class="ff1 ws181">个元素 </span>12</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
