<div id="pf27" class="pf w0 h0" data-page-no="27"><div class="pc pc27 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg27.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">r</span><span class="ws157">in <span class="ff8 fc0 ws13a">rows_by_date[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">07/01/2012<span class="ff9 ls34">&apos;</span></span>]:</span></span></span></div><div class="t m0 x5 hf y1ac ff7 fs5 fc5 sc0 ls0 ws139">... <span class="fca ws156">print<span class="ff8 fc0">(r)</span></span></div><div class="t m0 x5 h10 y1ad ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y1ae ff8 fs5 fc8 sc0 ls34">{<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">date</span><span class="ff9">&apos;</span><span class="ls33">:<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">07/01/2012<span class="ff9 ws13b">&apos;</span></span>,<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">address<span class="ff9 ws13b">&apos;</span></span>:<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">5412 N CLARK</span></span><span class="ff9">&apos;</span><span class="ls0">}</span></div><div class="t m0 x5 hf y1af ff8 fs5 fc8 sc0 ls34">{<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">date</span><span class="ff9">&apos;</span><span class="ls33">:<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">07/01/2012<span class="ff9 ws13b">&apos;</span></span>,<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">address<span class="ff9 ws13b">&apos;</span></span>:<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">4801 N BROADWAY</span></span><span class="ff9">&apos;</span><span class="ls0">}</span></div><div class="t m0 x5 hf y1b0 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y1b1 ff1 fs3 fc0 sc0 ls0 wsa0">在上面这个例子中，我<span class="_ _6"></span>们没有必要先将记录排序。<span class="_ _6"></span>因此，如果对内存占用不<span class="_ _6"></span>是很关</div><div class="t m0 x5 h9 y1b2 ff1 fs3 fc0 sc0 ls0 ws14">心，这种方式会比先排序然后再通过 <span class="ff6 ws1d1">groupby() </span>函数迭代的方式运行得快一些。</div><div class="t m0 x5 hd y1b3 ff2 fs4 fc4 sc0 ls0 ws211">3.16<span class="_ _e"> </span>1.16 <span class="ff1">过滤序列元素</span></div><div class="t m0 x5 he y1b4 ff2 fs2 fc4 sc0 ls0 ws212">3.16.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y3f5 ff1 fs3 fc0 sc0 ls0">你有一个数据序列，想利用一些规则从中提取出需要的值或者是缩短序列</div><div class="t m0 x5 he y3f6 ff2 fs2 fc4 sc0 ls0 ws212">3.16.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y3f7 ff1 fs3 fc0 sc0 ls0">最简单的过滤序列元素的方法就是使用列表推导。比如：</div><div class="t m0 x5 hf y3f8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">mylist <span class="fc6 ls32">=</span><span class="ls34">[<span class="fc7">1</span><span class="ls32">,</span><span class="fc7">4</span><span class="ls33">,</span></span><span class="fc6 ws13a">-<span class="fc7 ls34">5</span></span><span class="ls32">,</span><span class="fc7 ws13a">10</span><span class="ls32">,<span class="fc6 ls34">-<span class="fc7">7</span></span>,<span class="fc7 ls34">2</span>,<span class="fc7 ls34">3</span><span class="ls33">,</span></span><span class="fc6 ws13a">-<span class="fc7 ls34">1</span></span>]</span></div><div class="t m0 x5 hf y3f9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">[n </span><span class="fca">for <span class="ff8 fc0 ls32">n</span><span class="ws160">in <span class="ff8 fc0 ws145">mylist </span><span class="ws157">if <span class="ff8 fc0 ls32">n<span class="fc6 ls33">&gt;<span class="fc7 ls34">0</span></span><span class="ls0">]</span></span></span></span></span></div><div class="t m0 x5 hf y3fa ff8 fs5 fc8 sc0 ls0 ws4">[1, 4, 10, 2, 3]</div><div class="t m0 x5 hf y3fb ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws159">[n </span><span class="fca">for <span class="ff8 fc0 ls32">n</span><span class="ws160">in <span class="ff8 fc0 ws145">mylist </span><span class="ws157">if <span class="ff8 fc0 ls32">n<span class="fc6 ls33">&lt;<span class="fc7 ls34">0</span></span><span class="ls0">]</span></span></span></span></span></div><div class="t m0 x5 hf y3fc ff8 fs5 fc8 sc0 ls0 ws4">[-5, -7, -1]</div><div class="t m0 x5 hf y3fd ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y3fe ff1 fs3 fc0 sc0 ls3a ws153">使用列表推导的一个潜在缺陷就是如果输入非常大的时候会产生一个非常大的结果</div><div class="t m0 x5 h9 y3ff ff1 fs3 fc0 sc0 ls1e ws111">集<span class="_ _1"></span>，占用大量内存。如果你对内存比<span class="_ _1"></span>较敏感，那么你可以使用生成器表达式迭代<span class="_ _1"></span>产生</div><div class="t m0 x5 h9 y400 ff1 fs3 fc0 sc0 ls0">过滤的元素。比如：</div><div class="t m0 x5 hf y401 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws158">pos <span class="fc6 ls32">=</span><span class="ws159">(n </span></span><span class="fca">for <span class="ff8 fc0 ls33">n</span><span class="ws157">in <span class="ff8 fc0 ws145">mylist </span>if <span class="ff8 fc0 ls33">n<span class="fc6 ls32">&gt;<span class="fc7 ls34">0</span></span><span class="ls0">)</span></span></span></span></div><div class="t m0 x5 hf y402 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">pos</span></div><div class="t m0 x5 hf y403 ff8 fs5 fc8 sc0 ls0 ws4">&lt;generator object &lt;genexpr&gt; at 0x1006a0eb0&gt;</div><div class="t m0 x5 hf y404 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">for <span class="ff8 fc0 ls32">x</span><span class="ws157">in <span class="ff8 fc0">pos:</span></span></span></div><div class="t m0 x5 hf y405 ff7 fs5 fc5 sc0 ls0 ws139">... <span class="fca ws156">print<span class="ff8 fc0">(x)</span></span></div><div class="t m0 x5 h10 y406 ff7 fs5 fc5 sc0 ls0">...</div><div class="t m0 x5 hf y407 ff8 fs5 fc8 sc0 ls0">1</div><div class="t m0 x5 hf y408 ff8 fs5 fc8 sc0 ls0">4</div><div class="t m0 x5 hf y409 ff8 fs5 fc8 sc0 ls0">10</div><div class="t m0 x5 hf y40a ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 hf y40b ff8 fs5 fc8 sc0 ls0">3</div><div class="t m0 x5 hf y40c ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y40d ff1 fs3 fc0 sc0 ls56 ws1fa">有时候<span class="_ _c"></span>，过滤规则比较复杂，不能简单的在<span class="_ _1"></span>列表推导或者生成器表达式中表达出<span class="_ _1"></span></div><div class="t m0 x5 h9 y40e ff1 fs3 fc0 sc0 ls0 wsa0">来。<span class="_ _6"></span>比如，<span class="_ _6"></span>假<span class="_ _6"></span>设<span class="_ _6"></span>过<span class="_ _6"></span>滤<span class="_ _6"></span>的时<span class="_ _6"></span>候<span class="_ _6"></span>需<span class="_ _6"></span>要<span class="_ _6"></span>处<span class="_ _6"></span>理一<span class="_ _6"></span>些<span class="_ _6"></span>异<span class="_ _6"></span>常<span class="_ _6"></span>或<span class="_ _6"></span>者<span class="_ _6"></span>其他<span class="_ _6"></span>复<span class="_ _6"></span>杂<span class="_ _6"></span>情<span class="_ _6"></span>况。<span class="_ _6"></span>这时<span class="_ _6"></span>候<span class="_ _6"></span>你<span class="_ _6"></span>可<span class="_ _6"></span>以<span class="_ _6"></span>将过</div><div class="t m0 x5 h9 y40f ff1 fs3 fc0 sc0 ls0 ws14">滤代码放到一个函数中，然后使用内建的 <span class="ff6 ws1f3">filter() </span>函数。示例如下：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">3.16.<span class="_ _5"> </span>1.16 <span class="ff1 ws292">过滤序列元素 </span>30</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
