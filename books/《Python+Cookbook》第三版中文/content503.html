<div id="pf1f7" class="pf w0 h0" data-page-no="1f7"><div class="pc pc1f7 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg1f7.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x0 h9 y2a ff1 fs3 fc0 sc0 ls2c ws21b">如果你直接将消息作为参数传给 <span class="ff6 ls0 ws1de">SystemExit() <span class="ff1 wsa0">，那<span class="_ _6"></span>么你可以<span class="_ _6"></span>省略其<span class="_ _6"></span>他步骤，<span class="_ _6"></span>比如</span></span></div><div class="t m0 x5 h7 y2b ff4 fs3 fc0 sc0 ls0 wscf1">imp<span class="_ _6"></span>ort <span class="ff1 ws14">语句或将错误消息写入 <span class="ff6">sys.stderr</span></span></div><div class="t m0 x5 hd yf90 ff2 fs4 fc4 sc0 ls0 ws211">15.3<span class="_ _e"> </span>13.3 <span class="ff1">解析命令行选项</span></div><div class="t m0 x5 he yf91 ff2 fs2 fc4 sc0 ls0 ws212">15.3.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 yf92 ff1 fs3 fc0 sc0 ls0 ws14">你的程序如何能够解析命令行选项（位于 <span class="ff4 ws11e8">sys.argv </span>中）</div><div class="t m0 x5 he yf93 ff2 fs2 fc4 sc0 ls0 ws212">15.3.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 yf94 ff6 fs3 fc0 sc0 ls0 ws1f3">argparse <span class="ff1">模块可被用来解析命令行选项。下面一个简单例子演示了最基本的用法：</span></div><div class="t m0 x5 h11 y3173 ffa fs5 fcd sc0 ls0 ws4"># search.py</div><div class="t m0 x5 h15 y3174 ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x5 h11 ycc3 ffa fs5 fc9 sc0 ls0 ws4">Hypothetical command-line tool for searching a collection of</div><div class="t m0 x5 h11 y3175 ffa fs5 fc9 sc0 ls0 ws4">files for one or more text patterns.</div><div class="t m0 x5 h15 y3176 ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x5 h10 y3177 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">argparse</span></div><div class="t m0 x5 hf y3178 ff8 fs5 fc0 sc0 ls0 ws145">parser <span class="fc6 ls33">=</span><span class="ws13a">argparse<span class="fc6 ls34">.</span>ArgumentParser(description<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Search some files</span><span class="ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y3179 ff8 fs5 fc0 sc0 ls0 ws13a">parser<span class="fc6 ls34">.</span>add_argument(dest<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span><span class="fc9">filenames<span class="ff9 ls34">&apos;</span></span>,metavar<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">filename<span class="ff9 ls34">&apos;</span></span><span class="ws13b">, nargs<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span></span><span class="fc9">*<span class="ff9 ls34">&apos;</span></span>)</div><div class="t m0 x5 hf y317a ff8 fs5 fc0 sc0 ls0 ws13a">parser<span class="fc6 ls34">.</span>add_argument(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">-p<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">--pat<span class="ff9 ls34">&apos;</span></span>,metavar<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">pattern<span class="ff9 ls34">&apos;</span></span><span class="ws4">, required<span class="fc6 ls34">=</span></span><span class="fca">True</span>,</div><div class="t m0 x29 hf y317b ff8 fs5 fc0 sc0 ls0 ws13a">dest<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span><span class="fc9">patterns<span class="ff9 ws13b">&apos;</span></span><span class="ws4">, action<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span></span><span class="fc9">append<span class="ff9 ls34">&apos;</span></span>,</div><div class="t m0 x29 hf y317c ff8 fs5 fc0 sc0 ls0 ws13a">help<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws4">text pattern to search for<span class="ff9 ls34">&apos;</span></span>)</div><div class="t m0 x5 hf y317d ff8 fs5 fc0 sc0 ls0 ws13a">parser<span class="fc6 ls34">.</span>add_argument(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">-v<span class="ff9 ws13b">&apos;</span></span><span class="ws4">, dest<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span></span><span class="fc9">verbose<span class="ff9 ls34">&apos;</span></span><span class="ws4">, action<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span></span><span class="fc9">store_true<span class="ff9 ws13b">&apos;</span></span>,</div><div class="t m0 x29 hf y317e ff8 fs5 fc0 sc0 ls0 ws13a">help<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13b">verbose mode<span class="ff9">&apos;</span></span>)</div><div class="t m0 x5 hf y45f ff8 fs5 fc0 sc0 ls0 ws13a">parser<span class="fc6 ls34">.</span>add_argument(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">-o<span class="ff9 ws13b">&apos;</span></span><span class="ws4">, dest<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span></span><span class="fc9">outfile<span class="ff9 ls34">&apos;</span></span><span class="ws4">, action<span class="fc6 ls34">=</span><span class="ff9 fc9 ws13b">&apos;</span></span><span class="fc9">store<span class="ff9 ls34">&apos;</span></span>,</div><div class="t m0 x29 hf y317f ff8 fs5 fc0 sc0 ls0 ws13a">help<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13b">output file<span class="ff9 ls34">&apos;</span></span>)</div><div class="t m0 x5 hf y648 ff8 fs5 fc0 sc0 ls0 ws13a">parser<span class="fc6 ls34">.</span>add_argument(<span class="ff9 fc9 ws13b">&apos;</span><span class="fc9">--speed<span class="ff9 ls34">&apos;</span></span><span class="ws4">, dest<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span></span><span class="fc9">speed<span class="ff9 ws13b">&apos;</span></span><span class="ws4">, action<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span></span><span class="fc9">store<span class="ff9 ls34">&apos;</span></span>,</div><div class="t m0 x29 hf y3180 ff8 fs5 fc0 sc0 ls0 ws13a">choices<span class="fc6">=</span><span class="ls34">{<span class="ff9 fc9">&apos;</span></span><span class="fc9">slow<span class="ff9 ws13b">&apos;</span></span><span class="ls34">,<span class="ff9 fc9">&apos;</span></span><span class="fc9">fast<span class="ff9 ls34">&apos;</span></span><span class="ws13b">}, default<span class="fc6 ls34">=</span><span class="ff9 fc9">&apos;</span></span><span class="fc9">slow<span class="ff9 ls34">&apos;</span></span>,</div><div class="t m0 x29 hf y3181 ff8 fs5 fc0 sc0 ls0 ws13a">help<span class="fc6 ls34">=<span class="ff9 fc9">&apos;</span></span><span class="fc9 ws13b">search speed<span class="ff9">&apos;</span></span>)</div><div class="t m0 x5 hf y3182 ff8 fs5 fc0 sc0 ls0 ws13c">args <span class="fc6 ls32">=</span><span class="ws13a">parser<span class="fc6 ls34">.</span>parse_args()</span></div><div class="t m0 x5 h11 y3183 ffa fs5 fcd sc0 ls0 ws4"># Output the collected arguments</div><div class="t m0 x5 hf y3184 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(args<span class="fc6 ls34">.</span>filenames)</span></div><div class="t m0 x5 hf y3185 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(args<span class="fc6 ls34">.</span>patterns)</span></div><div class="t m0 x5 hf y3186 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(args<span class="fc6 ls34">.</span>verbose)</span></div><div class="t m0 x5 hf y3187 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(args<span class="fc6 ls34">.</span>outfile)</span></div><div class="t m0 x5 hf y3188 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws13a">(args<span class="fc6 ls34">.</span>speed)</span></div><div class="t m0 x0 h9 y3189 ff1 fs3 fc0 sc0 ls0">该程序定义了一个如下使用的命令行解析器：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">15.3.<span class="_ _36"> </span>13.3 <span class="ff1 ws600">解析命令行选项 </span>494</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
