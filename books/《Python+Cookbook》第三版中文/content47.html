<div id="pf2f" class="pf w0 h0" data-page-no="2f"><div class="pc pc2f w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg2f.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">c[<span class="ff9 fc9 ls34">&apos;<span class="ff8">z</span>&apos;</span><span class="ls32">]<span class="fc6">=</span></span><span class="fc7">10</span></span></div><div class="t m0 x5 hf y1ac ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">c[<span class="ff9 fc9 ls34">&apos;<span class="ff8">w</span>&apos;</span><span class="ls32">]<span class="fc6">=</span></span><span class="fc7">40</span></span></div><div class="t m0 x5 hf y1ad ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">del <span class="ff8 fc0 ws13a">c[<span class="ff9 fc9 ls34">&apos;<span class="ff8">x</span><span class="ls0 ws13b">&apos;</span></span>]</span></span></div><div class="t m0 x5 hf y1ae ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">a</span></div><div class="t m0 x5 hf y1af ff8 fs5 fc8 sc0 ls34">{<span class="ff9 ls0 ws13b">&apos;</span>w<span class="ff9">&apos;</span><span class="ls0 ws13b">: 40, </span><span class="ff9">&apos;</span>z<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">: 10}</span></div><div class="t m0 x5 hf y1b0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">del <span class="ff8 fc0 ws13a">c[<span class="ff9 fc9 ls34">&apos;<span class="ff8">y</span><span class="ls0 ws13b">&apos;</span></span>]</span></span></div><div class="t m0 x5 hf y355 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x5 h11 y410 ffa fs5 fcd sc0 ls0">...</div><div class="t m0 x5 hf y411 ff8 fs5 fc2 sc0 ls0 ws13a">KeyError<span class="fc0 ws4">: &quot;Key not found in the first mapping: <span class="ff9 ls34">&apos;<span class="ff8">y</span><span class="ls0 ws13b">&apos;</span></span>&quot;</span></div><div class="t m0 x5 hf yba ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y4f0 ff6 fs3 fc0 sc0 ls0 ws2c7">ChainMap <span class="ff1 ws2c8">对于编程语言中的作用范围变量 <span class="ff4 ls1b">(</span><span class="ws2c9">比如 </span></span><span class="ws2ca">globals <span class="ff4 ls74">,</span><span class="ws2cb">locals <span class="ff1 lsb">等<span class="ff4 ls75">)</span><span class="ls0">是非常有用</span></span></span></span></div><div class="t m0 x5 h9 y4f1 ff1 fs3 fc0 sc0 ls0">的。事实上，有一些方法可以使它变得简单：</div><div class="t m0 x5 hf y4f2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">values <span class="fc6 ls32">=</span>ChainMap()</span></div><div class="t m0 x5 hf y4f3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">values[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">x<span class="ff9 ls34">&apos;</span></span><span class="ls33">]<span class="fc6 ls32">=</span></span><span class="fc7">1</span></span></div><div class="t m0 x5 h11 y4f4 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Add a new mapping</span></div><div class="t m0 x5 hf y4f5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">values <span class="fc6 ls32">=</span><span class="ws13a">values<span class="fc6 ls34">.</span>new_child()</span></span></div><div class="t m0 x5 hf y4f6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">values[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">x<span class="ff9 ls34">&apos;</span></span><span class="ls33">]<span class="fc6 ls32">=</span></span><span class="fc7">2</span></span></div><div class="t m0 x5 h11 y4f7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Add a new mapping</span></div><div class="t m0 x5 hf y4f8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">values <span class="fc6 ls32">=</span><span class="ws13a">values<span class="fc6 ls34">.</span>new_child()</span></span></div><div class="t m0 x5 hf y4f9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">values[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">x<span class="ff9 ls34">&apos;</span></span><span class="ls33">]<span class="fc6 ls32">=</span></span><span class="fc7">3</span></span></div><div class="t m0 x5 hf y4fa ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">values</span></div><div class="t m0 x5 hf y4fb ff8 fs5 fc8 sc0 ls0 ws13a">ChainMap({<span class="ff9 ls34">&apos;<span class="ff8">x</span><span class="ls0 ws13b">&apos;</span></span><span class="ws4">: 3}, {<span class="ff9 ws13b">&apos;</span><span class="ls34">x<span class="ff9">&apos;</span></span><span class="ws13b">: 2}, {<span class="ff9 ls34">&apos;</span></span></span>x<span class="ff9 ls34">&apos;</span><span class="ws4">: 1})</span></div><div class="t m0 x5 hf y4fc ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">values[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">x<span class="ff9 ls34">&apos;</span></span>]</span></div><div class="t m0 x5 hf y4fd ff8 fs5 fc8 sc0 ls0">3</div><div class="t m0 x5 h11 y4fe ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Discard last mapping</span></div><div class="t m0 x5 hf y4ff ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">values <span class="fc6 ls32">=</span><span class="ws13a">values<span class="fc6 ls34">.</span>parents</span></span></div><div class="t m0 x5 hf y500 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">values[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">x<span class="ff9 ls34">&apos;</span></span>]</span></div><div class="t m0 x5 hf y501 ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 h11 y502 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws4"># Discard last mapping</span></div><div class="t m0 x5 hf y503 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">values <span class="fc6 ls32">=</span><span class="ws13a">values<span class="fc6 ls34">.</span>parents</span></span></div><div class="t m0 x5 hf y504 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">values[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">x<span class="ff9 ls34">&apos;</span></span>]</span></div><div class="t m0 x5 hf y505 ff8 fs5 fc8 sc0 ls0">1</div><div class="t m0 x5 hf y506 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0">values</span></div><div class="t m0 x5 hf y507 ff8 fs5 fc8 sc0 ls0 ws13a">ChainMap({<span class="ff9 ls34">&apos;<span class="ff8">x</span><span class="ls0 ws13b">&apos;</span></span><span class="ws4">: 1})</span></div><div class="t m0 x5 hf y508 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y509 ff1 fs3 fc0 sc0 ls0 wsc">作为 <span class="ff6 ws26f">ChainMap </span><span class="ws14">的替代，你可能会考虑使用 <span class="ff6 ws1f3">update() </span>方法将两个字典合并。比如：</span></div><div class="t m0 x5 hf y50a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=</span><span class="ls34">{</span></span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">x<span class="ff9">&apos;</span><span class="fc0 ls32">:</span><span class="fc7">1<span class="fc0 ls32">,</span></span><span class="ff9">&apos;</span>z<span class="ff9">&apos;</span><span class="fc0 ls32">:<span class="fc7">3</span><span class="ls0">}</span></span></span></span></div><div class="t m0 x5 hf y50b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=</span><span class="ls34">{</span></span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">y<span class="ff9">&apos;</span><span class="fc0 ls32">:</span><span class="fc7">2<span class="fc0 ls32">,</span></span><span class="ff9">&apos;</span>z<span class="ff9">&apos;</span><span class="fc0 ls32">:<span class="fc7">4</span><span class="ls0">}</span></span></span></span></div><div class="t m0 x5 hf y50c ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws145">merged <span class="fc6 ls32">=</span><span class="fca ws13a">dict</span>(b)</span></div><div class="t m0 x5 hf y50d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">merged<span class="fc6 ls34">.</span>update(a)</span></div><div class="t m0 x5 hf y50e ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">merged[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">x<span class="ff9 ls34">&apos;</span></span>]</span></div><div class="t m0 x5 hf y50f ff8 fs5 fc8 sc0 ls0">1</div><div class="t m0 x5 hf y510 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">merged[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">y<span class="ff9 ls34">&apos;</span></span>]</span></div><div class="t m0 x5 hf y511 ff8 fs5 fc8 sc0 ls0">2</div><div class="t m0 x5 hf y512 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">merged[<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">z<span class="ff9 ls34">&apos;</span></span>]</span></div><div class="t m0 x5 hf y513 ff8 fs5 fc8 sc0 ls0">3</div><div class="t m0 x5 hf y514 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">3.20.<span class="_ _5"> </span>1.20 <span class="ff1 ws2ad">合并多个字典或映射 </span>38</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
