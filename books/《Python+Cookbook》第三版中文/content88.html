<div id="pf58" class="pf w0 h0" data-page-no="58"><div class="pc pc58 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg58.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws212">4.20.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y236 ff1 fs3 fc0 sc0 ls0 wsa0">大多数情况下，在文本<span class="_ _6"></span>字符串上的操作均可用于<span class="_ _6"></span>字节字符串。然而，这里也<span class="_ _6"></span>有一些</div><div class="t m0 x5 h9 y237 ff1 fs3 fc0 sc0 ls0">需要注意的不同点。首先，字节字符串的索引操作返回整数而不是单独字符。比如：</div><div class="t m0 x5 hf y5b1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">a<span class="fc6 ls33">=<span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13b">Hello World</span><span class="ls32">&apos;</span></span></span></span><span class="ffa fcd ws13b"># Text string</span></div><div class="t m0 x5 hf y5b2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">a[<span class="fc7 ls34">0</span>]</span></div><div class="t m0 x5 hf y5b3 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">H<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y5b4 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">a[<span class="fc7 ls34">1</span>]</span></div><div class="t m0 x5 hf y5b5 ff9 fs5 fc8 sc0 ls34">&apos;<span class="ff8 ls0 ws13a">e<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y5b6 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">b<span class="fc6 ls33">=</span><span class="ls34">b</span></span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Hello World</span><span class="ls33">&apos;</span><span class="ffa fcd"># Byte string</span></span></div><div class="t m0 x5 hf y5b7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">b[<span class="fc7 ls34">0</span>]</span></div><div class="t m0 x5 hf y5b8 ff8 fs5 fc8 sc0 ls0">72</div><div class="t m0 x5 hf y5b9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">b[<span class="fc7 ls34">1</span>]</span></div><div class="t m0 x5 hf y5ba ff8 fs5 fc8 sc0 ls0">101</div><div class="t m0 x5 hf y5bb ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y9da ff1 fs3 fc0 sc0 ls0">这种语义上的区别会对于处理面向字节的字符数据有影响。</div><div class="t m0 x0 h9 y9db ff1 fs3 fc0 sc0 ls0 wsa0">第二点，字节字符串不<span class="_ _6"></span>会提供一个美观的字符串<span class="_ _6"></span>表示，也不能很好的打印<span class="_ _6"></span>出来，除</div><div class="t m0 x5 h9 y9dc ff1 fs3 fc0 sc0 ls0">非它们先被解码为一个文本字符串。比如：</div><div class="t m0 x5 hf y9dd ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls34">b</span></span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Hello World</span>&apos;</span></div><div class="t m0 x5 hf y9de ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0">(s)</span></span></div><div class="t m0 x5 hf y9df ff8 fs5 fc8 sc0 ls34">b<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">Hello World<span class="ff9 ls33">&apos;</span><span class="ws13b"># Observe b</span></span><span class="ff9">&apos;</span><span class="ls0 ws13a">...<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y9e0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws156">print<span class="ff8 fc0 ws13a">(s<span class="fc6 ls34">.</span>decode(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">ascii<span class="ff9 ls34">&apos;</span></span>))</span></span></div><div class="t m0 x5 hf y9e1 ff8 fs5 fc8 sc0 ls0 ws4">Hello World</div><div class="t m0 x5 hf y9e2 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y9e3 ff1 fs3 fc0 sc0 ls0">类似的，也不存在任何适用于字节字符串的格式化操作：</div><div class="t m0 x5 hf y9e4 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">b</span><span class="ff9 fc9 ws13b">&apos;<span class="ffa fcf ws13c">%10s %10d %10.2f</span><span class="ls32">&apos;<span class="ff8 fc6 ls33">%<span class="fc0 ls0 ws13a">(b</span></span><span class="ls34">&apos;</span></span><span class="ff8 ws13a">ACME</span><span class="ls34">&apos;<span class="ff8 fc0 ls32">,<span class="fc7 ls0 ws13a">100</span><span class="ls33">,<span class="fc7 ls0 ws13a">490.1<span class="fc0">)</span></span></span></span></span></span></div><div class="t m0 x5 hf y9e5 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y9e6 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x5 hf y9e7 ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ws4">: unsupported operand type(s) for %: <span class="ff9 ls34">&apos;</span><span class="ws13a">bytes<span class="ff9 ls32">&apos;</span><span class="ws158">and <span class="ff9 ls34">&apos;</span></span>tuple<span class="ff9">&apos;</span></span></span></div><div class="t m0 x5 hf y9e8 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">b</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">{} {} {}</span><span class="ls34">&apos;<span class="ff8 fc6">.<span class="fc0 ls0 ws13a">format(b</span></span>&apos;</span><span class="ff8 ws13a">ACME</span><span class="ls34">&apos;<span class="ff8 fc0 ls32">,<span class="fc7 ls0 ws13a">100</span><span class="ls33">,<span class="fc7 ls0 ws13a">490.1<span class="fc0">)</span></span></span></span></span></span></div><div class="t m0 x5 hf y9e9 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y28a ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x5 hf y9ea ff8 fs5 fc2 sc0 ls0 ws13a">AttributeError<span class="fc0 ls33">:<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0">bytes<span class="ff9 ls32">&apos;</span><span class="ws4">object has no attribute <span class="ff9 ls34">&apos;</span></span>format<span class="ff9">&apos;</span></span></span></div><div class="t m0 x5 hf y28c ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y9eb ff1 fs3 fc0 sc0 ls3a ws153">如果你想格式化字节字符串，你得先使用标准的文本字符串，然后将其编码为字节</div><div class="t m0 x5 h9 y9ec ff1 fs3 fc0 sc0 ls0">字符串。比如：</div><div class="t m0 x5 hf y9ed ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff9 fc9 ls34">&apos;<span class="ff8 ls0 ws13b">{:10s} {:10d} {:10.2f}<span class="ff9">&apos;</span><span class="fc6 ls34">.</span><span class="fc0 ws13a">format(</span></span>&apos;<span class="ff8 ls0 ws13a">ACME</span>&apos;<span class="ff8 fc0 ls32">,<span class="fc7 ls0 ws13a">100</span><span class="ls33">,<span class="fc7 ls0 ws13a">490.1</span><span class="ls34">)<span class="fc6">.</span><span class="ls0 ws13a">encode(</span></span></span></span>&apos;<span class="ff8 ls0 ws13a">ascii</span>&apos;</span><span class="ff8 fc0">)</span></div><div class="t m0 x5 hf y9ee ff8 fs5 fc8 sc0 ls34">b<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">ACME 100 490.10<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y9ef ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y9f0 ff1 fs3 fc0 sc0 ls3a ws153">最后需要注意的是，使用字节字符串可能会改变一些操作的语义，特别是那些跟文</div><div class="t m0 x5 h9 y9f1 ff1 fs3 fc0 sc0 ls0 wsa0">件<span class="_ _6"></span>系统<span class="_ _6"></span>有<span class="_ _6"></span>关<span class="_ _6"></span>的<span class="_ _6"></span>操<span class="_ _6"></span>作。比<span class="_ _6"></span>如，<span class="_ _6"></span>如<span class="_ _6"></span>果<span class="_ _6"></span>你<span class="_ _6"></span>使用<span class="_ _6"></span>一<span class="_ _6"></span>个<span class="_ _6"></span>编<span class="_ _6"></span>码<span class="_ _6"></span>为<span class="_ _6"></span>字节<span class="_ _6"></span>的<span class="_ _6"></span>文<span class="_ _6"></span>件<span class="_ _6"></span>名，<span class="_ _6"></span>而不<span class="_ _6"></span>是<span class="_ _6"></span>一<span class="_ _6"></span>个<span class="_ _6"></span>普<span class="_ _6"></span>通的</div><div class="t m0 x5 h7 y9f2 ff1 fs3 fc0 sc0 ls0 wsa0">文本字符串，会禁用文件名的编码<span class="ff4 ls6">/</span>解码。比如：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.20.<span class="_ _5"> </span>2.20 <span class="ff1 ws23b">字节字符串上的字符串操作 </span>79</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
