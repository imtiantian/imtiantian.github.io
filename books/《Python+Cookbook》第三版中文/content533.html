<div id="pf215" class="pf w0 h0" data-page-no="215"><div class="pc pc215 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg215.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 he y137 ff2 fs2 fc4 sc0 ls0 ws212">16.5.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y236 ff6 fs3 fc0 sc0 ls0 ws1f3">unittest <span class="ff1">模块有装饰器可用来控制对指定测试方法的处理，例如：</span></div><div class="t m0 x5 h10 y33be ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">unittest</span></div><div class="t m0 x5 h10 y33bf ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">os</span></div><div class="t m0 x5 h10 y33c0 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">platform</span></div><div class="t m0 x5 hf y33c1 ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Tests<span class="ff8 fc0 ws13a">(unittest<span class="fc6">.</span>TestCase):</span></span></div><div class="t m0 x15 hf y33c2 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">test_0<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y33c3 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">assertTrue(</span></span>True<span class="fc0">)</span></div><div class="t m0 x15 hf y33c4 ff7 fs5 fc12 sc0 ls0 ws156">@unittest.skip<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">skipped test</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x15 hf y27c1 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">test_1<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y33c5 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">fail(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13b">should have failed!<span class="ff9">&apos;</span></span>)</span></span></div><div class="t m0 x15 hf y33c6 ff7 fs5 fc12 sc0 ls0 ws156">@unittest.skipIf<span class="ff8 fc0 ws13a">(os<span class="fc6">.</span>name<span class="fc6">==<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">posix<span class="ff9 ls34">&apos;</span></span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws4">Not supported on Unix<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x15 hf y33c7 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">test_2<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 h10 y33c8 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">winreg</span></div><div class="t m0 x15 hf y33c9 ff7 fs5 fc12 sc0 ls0 ws156">@unittest.skipUnless<span class="ff8 fc0 ws13a">(platform<span class="fc6 ls34">.</span><span class="ws1f5">system() <span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span></span></span><span class="fc9">Darwin<span class="ff9 ws13b">&apos;</span></span><span class="ls33">,</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Mac specific test</span><span class="ls34">&apos;</span></span>)</span></div><div class="t m0 x15 hf y33ca ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">test_3<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y33cb ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">assertTrue(</span></span>True<span class="fc0">)</span></div><div class="t m0 x15 h10 y33cc ff7 fs5 fc12 sc0 ls0">@unittest.expectedFailure</div><div class="t m0 x15 hf y33cd ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">test_4<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y33ce ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">assertEqual(<span class="fc7 ls34">2<span class="fc6">+</span><span class="ls0">2</span></span><span class="ls33">,<span class="fc7 ls34">5</span></span>)</span></span></div><div class="t m0 x5 hf y33cf ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws16d">__name__ <span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">__main__<span class="ff9 ls34">&apos;</span></span></span>:</span></div><div class="t m0 x15 hf y33d0 ff8 fs5 fc0 sc0 ls0 ws13a">unittest<span class="fc6">.</span>main()</div><div class="t m0 x0 h7 y230d ff1 fs3 fc0 sc0 ls0 wsc">如果你在 <span class="ff4 wsb9f">Mac </span>上运行这段代码，你会得到如下输出：</div><div class="t m0 x5 hf y33d1 ff8 fs5 fc0 sc0 ls0 ws4">bash % python3 testsample.py -v</div><div class="t m0 x5 hf y33d2 ff8 fs5 fc0 sc0 ls0 ws4">test_0 (__main__.Tests) ... ok</div><div class="t m0 x5 hf y33d3 ff8 fs5 fc0 sc0 ls0 ws4">test_1 (__main__.Tests) ... skipped <span class="ff9 ls34">&apos;</span><span class="ws13b">skipped test<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y33d4 ff8 fs5 fc0 sc0 ls0 ws4">test_2 (__main__.Tests) ... skipped <span class="ff9 ls34">&apos;</span>Not supported on Unix<span class="ff9">&apos;</span></div><div class="t m0 x5 hf y33d5 ff8 fs5 fc0 sc0 ls0 ws4">test_3 (__main__.Tests) ... ok</div><div class="t m0 x5 hf y33d6 ff8 fs5 fc0 sc0 ls0 ws4">test_4 (__main__.Tests) ... expected failure</div><div class="t m0 x5 hf y33d7 ff8 fs5 fc0 sc0 ls0">----------------------------------------------------------------------</div><div class="t m0 x5 hf y33d8 ff8 fs5 fc0 sc0 ls0 ws4">Ran 5 tests in 0.002s</div><div class="t m0 x5 hf y33d9 ff8 fs5 fc0 sc0 ls0 ws4">OK (skipped=2, expected failures=1)</div><div class="t m0 x5 he y5f6 ff2 fs2 fc4 sc0 ls0 ws212">16.5.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y33da ff6 fs3 fc0 sc0 ls0 ws60f">skip() <span class="ff1 lsa8 ws12b3">装饰器能被用来忽略某个你不想运行的测试。 </span><span class="wsdbf">skipIf() <span class="ff1 ls212">和</span>skipUnless()</span></div><div class="t m0 x5 h7 y33db ff1 fs3 fc0 sc0 ls0 ws31b">对于你只想在某个特定平台或 <span class="ff4 ws12b4">Python </span>版本或其他依赖成立时才运行测试的时候非常有</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">16.5.<span class="_ _36"> </span>14.5 <span class="ff1 ws544">忽略或期望测试失败 </span>524</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
