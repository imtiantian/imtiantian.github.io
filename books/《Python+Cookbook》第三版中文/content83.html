<div id="pf53" class="pf w0 h0" data-page-no="53"><div class="pc pc53 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg53.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 h11 y15f ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;exprparse.py&quot;, line 93, in factor</div><div class="t m0 x15 h11 y160 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>exprval = self.expr()</div><div class="t m0 x15 h11 y956 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;exprparse.py&quot;, line 67, in expr</div><div class="t m0 x15 h11 y957 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>right = self.term()</div><div class="t m0 x15 h11 y958 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;exprparse.py&quot;, line 77, in term</div><div class="t m0 x15 h11 y959 ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>termval = self.factor()</div><div class="t m0 x15 h11 y95a ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>File &quot;exprparse.py&quot;, line 97, in factor</div><div class="t m0 x15 h11 y95b ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>raise SyntaxError(&quot;Expected NUMBER or LPAREN&quot;)</div><div class="t m0 x15 h11 y95c ffa fs5 fcd sc0 ls0 ws4">#<span class="_ _22"> </span>SyntaxError: Expected NUMBER or LPAREN</div><div class="t m0 x5 hf y95d ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 fc0 ws16d">__name__ <span class="fc6 ws159">== <span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">__main__<span class="ff9 ls34">&apos;</span></span></span>:</span></div><div class="t m0 x15 hf y95e ff8 fs5 fc0 sc0 ls0">descent_parser()</div><div class="t m0 x5 he y95f ff2 fs2 fc4 sc0 ls0 ws212">4.19.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y960 ff1 fs3 fc0 sc0 ls30 ws138">文本解析是一个很大的主题，一般会占用学生学习编译课程时刚开始的三周时间<span class="_ _c"></span>。</div><div class="t m0 x5 h9 y961 ff1 fs3 fc0 sc0 ls13 wse5">如果你在找寻关于语法<span class="_ _1"></span>，解析算法等相关的背景知识的话，你应该去看一下编译器书<span class="_ _c"></span></div><div class="t m0 x5 h9 y962 ff1 fs3 fc0 sc0 ls0">籍。很显然，关于这方面的内容太多，不可能在这里全部展开。</div><div class="t m0 x0 h9 y963 ff1 fs3 fc0 sc0 ls0 wsa0">尽管如此，编写一个递<span class="_ _6"></span>归下降解析器的整体思路<span class="_ _6"></span>是比较简单的。开始的时<span class="_ _6"></span>候，你先</div><div class="t m0 x5 h9 y964 ff1 fs3 fc0 sc0 ls13 wse5">获得所有的语法规则<span class="_ _1"></span>，然后将其转换为一个函数或者方法。因此如果你的语法类似这<span class="_ _c"></span></div><div class="t m0 x5 h9 y341 ff1 fs3 fc0 sc0 ls0">样：</div><div class="t m0 x5 hf y965 ff8 fs5 fc0 sc0 ls0 ws4">expr ::<span class="fc6 ls33">=</span><span class="ws13b">term { (<span class="ff9 fc9 ls34">&apos;<span class="ff8">+</span>&apos;</span><span class="ffd fc6">|<span class="ff9 fc9">&apos;<span class="ff8 ls34">-<span class="ff9">&apos;</span></span></span></span>) term }<span class="fc6">*</span></span></div><div class="t m0 x5 hf y966 ff8 fs5 fc0 sc0 ls0 ws4">term ::<span class="fc6 ls33">=</span><span class="ws13b">factor { (<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13a">*<span class="ff9 ls34">&apos;</span></span><span class="ffd fc6">|<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">/<span class="ff9 ls34">&apos;</span></span></span>) factor }<span class="fc6">*</span></div><div class="t m0 x5 hf y967 ff8 fs5 fc0 sc0 ls0 ws4">factor ::<span class="fc6 ls32">=<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9 ws13a">(<span class="ff9 ls33">&apos;</span></span><span class="ws13c">expr <span class="ff9 fc9 ws13b">&apos;<span class="ff8 ls34">)</span>&apos;</span></span></div><div class="t m0 x15 hf y968 ffd fs5 fc6 sc0 lsbd">|<span class="ff8 fc0 ls0">NUM</span></div><div class="t m0 x0 h9 y969 ff1 fs3 fc0 sc0 ls0">你应该首先将它们转换成一组像下面这样的方法：</div><div class="t m0 x5 hf y96a ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">ExpressionEvaluator<span class="ff8 fc0">:</span></span></div><div class="t m0 x15 hf y96b ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x15 hf y96c ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">expr<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x15 hf y96d ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x15 hf y96e ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">term<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x15 hf y96f ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x15 hf y970 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">factor<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0">):</span></span></span></div><div class="t m0 x15 hf y971 ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h7 y972 ff1 fs3 fc0 sc0 ls35 ws440">每个方法要完成的任务很简单 <span class="ff4 lsbe">-</span><span class="ws144">它必须从左至右遍历语法规则的每一部分，处理每</span></div><div class="t m0 x5 h9 y973 ff1 fs3 fc0 sc0 ls0 wsa0">个<span class="_ _6"></span>令牌。<span class="_ _6"></span>从<span class="_ _6"></span>某<span class="_ _6"></span>种<span class="_ _6"></span>意<span class="_ _6"></span>义上<span class="_ _6"></span>讲，<span class="_ _6"></span>方<span class="_ _6"></span>法<span class="_ _6"></span>的<span class="_ _6"></span>目的<span class="_ _6"></span>就<span class="_ _6"></span>是<span class="_ _6"></span>要<span class="_ _6"></span>么<span class="_ _6"></span>处<span class="_ _6"></span>理完<span class="_ _6"></span>语<span class="_ _6"></span>法<span class="_ _6"></span>规<span class="_ _6"></span>则，<span class="_ _6"></span>要么<span class="_ _6"></span>产<span class="_ _6"></span>生<span class="_ _6"></span>一<span class="_ _6"></span>个<span class="_ _6"></span>语法</div><div class="t m0 x5 h9 y7c7 ff1 fs3 fc0 sc0 ls0">错误。为了这样做，需采用下面的这些实现方法：</div><div class="t m0 x1f h7 y974 ffe fs3 fc0 sc0 lsbf">•<span class="ff1 ls0 ws441">如果规则中的下个符号是另外一个语法规则的名字 <span class="ff4 wsa5">(</span><span class="ws442">比如 <span class="ff4 ws443">term </span><span class="lsc0">或</span><span class="ff4 wsa5">factor)</span><span class="wsa0">，<span class="_ _c"></span>就简单</span></span></span></div><div class="t m0 x20 h7 y975 ff1 fs3 fc0 sc0 ls13 wse5">的调用同名的方法即可<span class="_ _1"></span>。这就是该算法中<span class="ff4 lsc1">”</span><span class="ls0 wsa0">下降<span class="ff4 lsc1">”</span></span><span class="ws444">的由来 <span class="ff4 lsc2">-</span></span>控制下降到另一个语</div><div class="t m0 x20 h7 y976 ff1 fs3 fc0 sc0 ls0 ws38">法规则中去。有时候规则会调用已经执行的方法 <span class="ff4 wsa5">(</span><span class="wsc">比如，在 <span class="ff6 ws305">factor ::= &apos;(&apos;expr</span></span></div><div class="t m0 x20 h7 y977 ff6 fs3 fc0 sc0 ls0 ws15e">&apos;)&apos; <span class="ff1 ws14">中对 <span class="ff4 ws445">expr </span><span class="wsa0">的调用<span class="ff4 ls1b">)</span>。这就是算法中<span class="ff4 lsc3">”</span>递归<span class="ff4 ls89">”</span>的由来。</span></span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.19.<span class="_ _5"> </span>2.19 <span class="ff1 ws42c">实现一个简单的递归下降分析器 </span>74</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
