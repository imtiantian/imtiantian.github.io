<div id="pf164" class="pf w0 h0" data-page-no="164"><div class="pc pc164 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg164.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">MultipleMeta<span class="ff8 fc0 ls34">(</span></span><span class="ff8 ws13a">type<span class="fc0">):</span></span></div><div class="t m0 x15 h15 y1ac ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x15 h11 y1ad ffa fs5 fc9 sc0 ls0 ws4">Metaclass that allows multiple dispatch of methods</div><div class="t m0 x15 h15 y1ae ffb fs5 fc9 sc0 ls0">&apos;&apos;&apos;</div><div class="t m0 x15 hf y1af ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__new__<span class="fc0 ws4">(cls, clsname, bases, clsdict):</span></span></div><div class="t m0 x16 hf y1b0 ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 ws13a">type<span class="fc6 ls34">.</span><span class="fc0 ws13b">__new__(cls, clsname, bases, </span>dict<span class="fc0">(clsdict))</span></span></div><div class="t m0 x15 h10 y410 ff7 fs5 fc12 sc0 ls0">@classmethod</div><div class="t m0 x15 hf y411 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__prepare__<span class="fc0 ws13b">(cls, clsname, bases):</span></span></div><div class="t m0 x16 hf yba ff7 fs5 fca sc0 ls0 ws146">return <span class="ff8 fc0">MultiDict()</span></div><div class="t m0 x0 h9 y729 ff1 fs3 fc0 sc0 ls0">为了使用这个类，你可以像下面这样写：</div><div class="t m0 x5 hf y13aa ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Spam<span class="ff8 fc0 ws13a">(metaclass<span class="fc6">=</span>MultipleMeta):</span></span></div><div class="t m0 x15 hf y13ab ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">bar<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, x:</span>int<span class="fc0 ws13b">, y:</span>int<span class="fc0">):</span></span></span></div><div class="t m0 x16 hf y4f3 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Bar 1:</span>&apos;</span><span class="ls0 ws13b">, x, y)</span></span></div><div class="t m0 x15 hf y4f5 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">bar<span class="fc0 ls34">(</span><span class="fca">self<span class="fc0 ws13b">, s:</span>str<span class="fc0 ws13b">, n:</span><span class="ws158">int <span class="fc6 ls32">=<span class="fc7 ls34">0</span></span><span class="fc0">):</span></span></span></span></div><div class="t m0 x16 hf y4f6 ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ls34">(<span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13b">Bar 2:</span>&apos;</span><span class="ls0 ws13b">, s, n)</span></span></div><div class="t m0 x5 h11 y4f8 ffa fs5 fcd sc0 ls0 ws4"># Example: overloaded __init__</div><div class="t m0 x5 h10 y4f9 ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">time</span></div><div class="t m0 x5 hf y4fb ff7 fs5 fca sc0 ls0 ws16a">class <span class="fcc ws156">Date<span class="ff8 fc0 ws13a">(metaclass<span class="fc6">=</span>MultipleMeta):</span></span></div><div class="t m0 x15 hf y4fc ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span><span class="ws4">, year: </span><span class="fca">int</span><span class="ws4">, month:</span><span class="fca">int</span><span class="ws4">, day:</span><span class="fca">int</span>):</span></span></div><div class="t m0 x16 hf y2517 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws13c">year </span><span class="ls33">=</span><span class="fc0">year</span></span></div><div class="t m0 x16 hf y2518 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws458">month </span><span class="ls32">=</span><span class="fc0">month</span></span></div><div class="t m0 x16 hf y2519 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0 ws158">day </span><span class="ls33">=</span><span class="fc0">day</span></span></div><div class="t m0 x15 hf y501 ff7 fs5 fca sc0 ls0 ws139">def <span class="ff8 fcb ws13a">__init__<span class="fc0">(<span class="fca">self</span>):</span></span></div><div class="t m0 x16 hf y502 ff8 fs5 fc0 sc0 ls32">t<span class="fc6 ls33">=</span><span class="ls0 ws13a">time<span class="fc6">.</span>localtime()</span></div><div class="t m0 x16 hf y503 ff8 fs5 fca sc0 ls0 ws13a">self<span class="fc6">.<span class="fc0">__init__(t</span>.<span class="fc0 ws4">tm_year, t</span>.<span class="fc0 ws4">tm_mon, t</span><span class="ls34">.</span><span class="fc0">tm_mday)</span></span></div><div class="t m0 x0 h9 y1908 ff1 fs3 fc0 sc0 ls0">下面是一个交互示例来验证它能正确的工作：</div><div class="t m0 x5 hf y251a ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">s<span class="fc6 ls33">=</span><span class="ls0">Spam()</span></span></div><div class="t m0 x5 hf y251b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">bar(</span></span><span class="fc7">2</span><span class="ls32">,</span><span class="fc7">3</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y251c ff8 fs5 fc8 sc0 ls0 ws4">Bar 1: 2 3</div><div class="t m0 x5 hf y251d ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">bar(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">hello<span class="ff9 ws13b">&apos;</span><span class="fc0">)</span></span></span></span></div><div class="t m0 x5 hf y251e ff8 fs5 fc8 sc0 ls0 ws4">Bar 2: hello 0</div><div class="t m0 x5 hf y1844 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">bar(</span></span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">hello<span class="ff9 ws13b">&apos;</span></span></span><span class="ls33">,</span><span class="fc7">5</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y1845 ff8 fs5 fc8 sc0 ls0 ws4">Bar 2: hello 5</div><div class="t m0 x5 hf y1846 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls34">s<span class="fc6 ls0 ws13a">.<span class="fc0">bar(</span></span><span class="fc7">2</span><span class="ls32">,</span><span class="ff9 fc9">&apos;<span class="ff8 ls0 ws13a">hello</span>&apos;</span><span class="ls0">)</span></span></div><div class="t m0 x5 hf y1847 ff8 fs5 fce sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x15 hf y1848 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;&lt;stdin&gt;&quot;</span><span class="ws145">, line <span class="fc7 ls34">1</span><span class="ls32">,</span><span class="ff7 fca ws160">in </span><span class="fc6 ws13a">&lt;<span class="fc0">module</span>&gt;</span></span></div><div class="t m0 x15 hf y1849 ff8 fs5 fc0 sc0 ls0 ws13c">File <span class="fc9 ws13a">&quot;multiple.py&quot;</span><span class="ws13b">, line <span class="fc7 ws13a">42</span><span class="ls32">,</span><span class="ff7 fca ws157">in </span>__call__</span></div><div class="t m0 x16 hf y184a ff7 fs5 fca sc0 ls0 ws16a">raise <span class="ff8 ws13a">TypeError<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws4">No matching method for types {}<span class="ff9 ws13b">&apos;</span><span class="fc6 ls34">.</span></span>format(types))</span></span></div><div class="t m0 x5 hf y184b ff8 fs5 fc2 sc0 ls0 ws13a">TypeError<span class="fc0 ws4">: No matching method for types (&lt;class <span class="ff9 ls34">&apos;</span><span class="ws13a">int<span class="ff9 ls34">&apos;</span><span class="ws13b">&gt;, &lt;class <span class="ff9 ls34">&apos;</span></span>str<span class="ff9 ws13b">&apos;</span>&gt;)</span></span></div><div class="t m0 x5 h11 y251f ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws13b"># Overloaded __init__</span></div><div class="t m0 x5 hf y2520 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">d<span class="fc6 ls33">=</span><span class="ls0 ws13a">Date(<span class="fc7">2012</span><span class="ls33">,</span><span class="fc7">12</span><span class="ls33">,</span><span class="fc7">21</span>)</span></span></div><div class="t m0 x5 h11 y2521 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ffa fcd ws13b"># Get today<span class="ffb ls34">&apos;</span>s date</span></div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsae0">11.20.<span class="_ _5"> </span>9.20 <span class="ff1 wsc0a">利用函数注解实现方法重载 </span>347</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
