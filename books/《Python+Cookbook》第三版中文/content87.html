<div id="pf57" class="pf w0 h0" data-page-no="57"><div class="pc pc57 w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg57.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hd y112 ff2 fs4 fc4 sc0 ls0 ws211">4.20<span class="_ _e"> </span>2.20 <span class="ff1">字节字符串上的字符串操作</span></div><div class="t m0 x5 he y113 ff2 fs2 fc4 sc0 ls0 ws212">4.20.1 <span class="ff1">问题</span></div><div class="t m0 x0 h7 y2b2 ff1 fs3 fc0 sc0 ls0 ws14">你想在字节字符串上执行普通的文本操作 <span class="ff4 wsa5">(</span><span class="wsa0">比如移除，搜索和替换<span class="ff4 ls1b">)</span>。</span></div><div class="t m0 x5 he y2b3 ff2 fs2 fc4 sc0 ls0 ws212">4.20.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y2b4 ff1 fs3 fc0 sc0 ls0">字节字符串同样也支持大部分和文本字符串一样的内置操作。比如：</div><div class="t m0 x5 hf y618 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">data <span class="fc6 ls32">=</span><span class="ls34">b</span><span class="ff9 fc9 ws13b">&apos;<span class="ff8 ws4">Hello World</span>&apos;</span></span></div><div class="t m0 x5 hf y619 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data[<span class="fc7">0</span><span class="ls34">:<span class="fc7">5</span></span>]</span></div><div class="t m0 x5 hf y61a ff8 fs5 fc8 sc0 ls34">b<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws13a">Hello<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y61b ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data<span class="fc6 ls34">.</span>startswith(b<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Hello<span class="ff9 ws13b">&apos;</span></span>)</span></div><div class="t m0 x5 hf y9c0 ff8 fs5 fc8 sc0 ls0">True</div><div class="t m0 x5 hf y9c1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data<span class="fc6 ls34">.</span>split()</span></div><div class="t m0 x5 hf y752 ff8 fs5 fc8 sc0 ls0 ws13a">[b<span class="ff9 ls34">&apos;</span>Hello<span class="ff9 ls34">&apos;</span><span class="ws13b">, b<span class="ff9">&apos;</span></span>World<span class="ff9 ls34">&apos;</span>]</div><div class="t m0 x5 hf y753 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data<span class="fc6 ls34">.</span>replace(b<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Hello<span class="ff9 ls34">&apos;</span></span><span class="ws4">, b<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Hello Cruel<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y754 ff8 fs5 fc8 sc0 ls34">b<span class="ff9 ls0 ws13b">&apos;</span><span class="ls0 ws4">Hello Cruel World<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y755 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y561 ff1 fs3 fc0 sc0 ls0">这些操作同样也适用于字节数组。比如：</div><div class="t m0 x5 hf y9c2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13c">data <span class="fc6 ls32">=</span><span class="fca ws13a">bytearray<span class="fc0">(b<span class="ff9 fc9 ls34">&apos;</span><span class="fc9 ws13b">Hello World<span class="ff9">&apos;</span></span>)</span></span></span></div><div class="t m0 x5 hf y9c3 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data[<span class="fc7">0</span><span class="ls34">:<span class="fc7">5</span></span>]</span></div><div class="t m0 x5 hf y9c4 ff8 fs5 fc8 sc0 ls0 ws13a">bytearray(b<span class="ff9 ls34">&apos;</span>Hello<span class="ff9 ls34">&apos;</span>)</div><div class="t m0 x5 hf y9c5 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data<span class="fc6 ls34">.</span>startswith(b<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Hello<span class="ff9 ws13b">&apos;</span></span>)</span></div><div class="t m0 x5 hf y9c6 ff8 fs5 fc8 sc0 ls0">True</div><div class="t m0 x5 hf y9c7 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data<span class="fc6 ls34">.</span>split()</span></div><div class="t m0 x5 hf y9c8 ff8 fs5 fc8 sc0 ls0 ws13a">[bytearray(b<span class="ff9 ws13b">&apos;</span>Hello<span class="ff9 ls34">&apos;</span><span class="ws13b">), bytearray(b<span class="ff9 ls34">&apos;</span></span>World<span class="ff9 ls34">&apos;</span>)]</div><div class="t m0 x5 hf y9c9 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">data<span class="fc6 ls34">.</span>replace(b<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Hello<span class="ff9 ls34">&apos;</span></span><span class="ws4">, b<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">Hello Cruel<span class="ff9 ls34">&apos;</span></span>)</span></span></div><div class="t m0 x5 hf y9ca ff8 fs5 fc8 sc0 ls0 ws13a">bytearray(b<span class="ff9 ls34">&apos;</span><span class="ws13b">Hello Cruel World<span class="ff9 ls34">&apos;</span>)</span></div><div class="t m0 x5 hf y9cb ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y9cc ff1 fs3 fc0 sc0 ls3a ws153">你可以使用正则表达式匹配字节字符串，但是正则表达式本身必须也是字节串。比</div><div class="t m0 x5 h9 y9cd ff1 fs3 fc0 sc0 ls0">如：</div><div class="t m0 x5 hf y9ce ff8 fs5 fc0 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 hf y9cf ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; data = b<span class="ff9 ws13b">&apos;</span><span class="ws13a">FOO:BAR,SPAM<span class="ff9">&apos;</span></span></div><div class="t m0 x5 hf y9d0 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; import re</div><div class="t m0 x5 hf y9d1 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; re.split(<span class="ff9 ls34">&apos;</span><span class="ws13a">[:,]<span class="ff9 ls34">&apos;</span>,data)</span></div><div class="t m0 x5 hf y9d2 ff8 fs5 fc0 sc0 ls0 ws4">Traceback (most recent call last):</div><div class="t m0 x5 hf y9d3 ff8 fs5 fc0 sc0 ls0 ws4">File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</div><div class="t m0 x5 hf y9d4 ff8 fs5 fc0 sc0 ls0 ws4">File &quot;/usr/local/lib/python3.3/re.py&quot;, line 191, in split</div><div class="t m0 x5 hf y9d5 ff8 fs5 fc0 sc0 ls0 ws4">return _compile(pattern, flags).split(string, maxsplit)</div><div class="t m0 x5 hf y9d6 ff8 fs5 fc0 sc0 ls0 ws4">TypeError: can<span class="ff9 ls34">&apos;</span>t use a string pattern on a bytes-like object</div><div class="t m0 x5 hf y9d7 ff8 fs5 fc0 sc0 ls0 ws4">&gt;&gt;&gt; re.split(b<span class="ff9 ls34">&apos;</span><span class="ws13a">[:,]<span class="ff9 ls34">&apos;</span></span>,data) # Notice: pattern as bytes</div><div class="t m0 x5 hf y9d8 ff8 fs5 fc0 sc0 ls0 ws13a">[b<span class="ff9 ls34">&apos;</span>FOO<span class="ff9 ls34">&apos;</span><span class="ws4">, b<span class="ff9 ls34">&apos;</span></span>BAR<span class="ff9 ls34">&apos;</span><span class="ws13b">, b<span class="ff9 ls34">&apos;</span></span>SPAM<span class="ff9 ws13b">&apos;</span>]</div><div class="t m0 x5 hf y9d9 ff8 fs5 fc0 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">4.20.<span class="_ _5"> </span>2.20 <span class="ff1 ws23b">字节字符串上的字符串操作 </span>78</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
