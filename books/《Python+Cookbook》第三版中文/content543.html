<div id="pf21f" class="pf w0 h0" data-page-no="21f"><div class="pc pc21f w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg21f.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x15 hf y1ab ff8 fs5 fc0 sc0 ls0 ws13b">func(2, 3, logfile=<span class="ff9">&apos;</span><span class="ws13a">log.txt</span><span class="ff9">&apos;</span>)</div><div class="t m0 x19 hf y1ac ff8 fs5 fc0 sc0 ls0 ws4">File &quot;example.py&quot;, line 5, in func</div><div class="t m0 x15 hf y1ad ff8 fs5 fc0 sc0 ls0 ws13a">warnings.warn(<span class="ff9 ls34">&apos;</span><span class="ws4">logfile argument is deprecated<span class="ff9 ws13b">&apos;</span>, DeprecationWarning)</span></div><div class="t m0 x5 hf y1ae ff8 fs5 fc0 sc0 ls0 ws4">DeprecationWarning: logfile argument is deprecated</div><div class="t m0 x5 hf y1af ff8 fs5 fc0 sc0 ls0 ws4">bash %</div><div class="t m0 x5 he y34b7 ff2 fs2 fc4 sc0 ls0 wsadf">16.11.3 <span class="ff1">讨论</span></div><div class="t m0 x0 h9 y34b8 ff1 fs3 fc0 sc0 ls0 wsa0">在你维护软件，提示用<span class="_ _6"></span>户某些信息，但是又不需要<span class="_ _6"></span>将其上升为异常级别，那<span class="_ _6"></span>么输出</div><div class="t m0 x5 h9 y34b9 ff1 fs3 fc0 sc0 ls1e ws111">警告信息就会很有用了<span class="_ _1"></span>。例如，假设<span class="_ _1"></span>你准备修改某个函数库或框架的功能，你可<span class="_ _1"></span>以先</div><div class="t m0 x5 h9 y34ba ff1 fs3 fc0 sc0 ls13 wse5">为你要更改的部分输出警告信息<span class="_ _1"></span>，同时向后兼容一段时间。你还可以警告用户一些对<span class="_ _c"></span></div><div class="t m0 x5 h9 y34bb ff1 fs3 fc0 sc0 ls0">代码有问题的使用方式。</div><div class="t m0 x0 h9 y34bc ff1 fs3 fc0 sc0 ls3a ws153">作为另外一个内置函数库的警告使用例子，下面演示了一个没有关闭文件就销毁它</div><div class="t m0 x5 h9 y34bd ff1 fs3 fc0 sc0 ls0">时产生的警告消息：</div><div class="t m0 x5 h10 y34be ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">warnings</span></span></div><div class="t m0 x5 hf y34bf ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">warnings<span class="fc6">.</span>simplefilter(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">always<span class="ff9 ls34">&apos;</span></span>)</span></div><div class="t m0 x5 hf y34c0 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ls32">f<span class="fc6 ls33">=<span class="fca ls0 ws13a">open<span class="fc0">(<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">/etc/passwd<span class="ff9 ls34">&apos;</span></span>)</span></span></span></span></div><div class="t m0 x5 hf y34c1 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca">del <span class="ff8 fc0">f</span></span></div><div class="t m0 x5 hf y2f9e ff8 fs5 fc8 sc0 ls0 ws4">__main__:1: ResourceWarning: unclosed file &lt;_io.TextIOWrapper name=<span class="ff9 ws13b">&apos;</span><span class="ws13a">/etc/passwd<span class="ff9">&apos;</span></span></div><div class="t m0 x4b hf y34c2 ff8 fs5 fc8 sc0 ls0 ws13a">mode=<span class="ff9 ls34">&apos;<span class="ff8">r</span><span class="ls32">&apos;</span></span>encoding=<span class="ff9 ls34">&apos;</span>UTF-8<span class="ff9 ls34">&apos;</span>&gt;</div><div class="t m0 x5 hf y34c3 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h9 y34c4 ff1 fs3 fc0 sc0 ls0 wsa0">默认情<span class="_ _6"></span>况下，<span class="_ _6"></span>并不是<span class="_ _6"></span>所有<span class="_ _6"></span>警告消<span class="_ _6"></span>息都<span class="_ _6"></span>会出现。<span class="_ _6"></span><span class="ff6 ws12ed">-W </span><span class="ws12ee">选项<span class="_ _6"></span>能控<span class="_ _6"></span>制警告<span class="_ _6"></span>消息<span class="_ _6"></span>的输出。 <span class="ff6 ws303">-<span class="_ _6"></span>W</span></span></div><div class="t m0 x5 h9 y1a20 ff6 fs3 fc0 sc0 ls0 wsb5f">all <span class="ff1 wsa0">会输出所有警告消息，</span><span class="ws12ef">-W<span class="_ _11"> </span>ignore <span class="ff1 wsa0">忽略掉所有警告，</span><span class="ws12f0">-W<span class="_ _11"> </span>error <span class="ff1 wsa0">将警告转换成异常。</span></span></span></div><div class="t m0 x5 h9 y34c5 ff1 fs3 fc0 sc0 ls2d ws12f1">另外一种选择，你还可以使用 <span class="ff6 ls0 ws12f2">warnings.simplefilter() </span><span class="ws12f3">函数控制输出<span class="_ _c"></span>。 <span class="ff6 ls0 ws4f6">always <span class="ff1">参</span></span></span></div><div class="t m0 x5 h9 y34c6 ff1 fs3 fc0 sc0 ls0 wsa0">数会让所有警告消息出现，<span class="ff6 ws23a">`ignore </span>忽略调所有的警告，<span class="ff6 ws19e">error </span>将警告转换成异常。</div><div class="t m0 x0 h9 y1516 ff1 fs3 fc0 sc0 ls0 ws12f4">对于简<span class="_ _6"></span>单的生<span class="_ _6"></span>成警<span class="_ _6"></span>告消息<span class="_ _6"></span>的情况<span class="_ _6"></span>这些已<span class="_ _6"></span>经足够<span class="_ _6"></span>了。 <span class="ff6 ws214">warnings </span><span class="wsa0">模块对<span class="_ _6"></span>过滤<span class="_ _6"></span>和警告<span class="_ _6"></span>消</span></div><div class="t m0 x5 h7 y34c7 ff1 fs3 fc0 sc0 ls0 ws63">息处理提供了大量的更高级的配置选项。更多信息请参考 <span class="ff4 fc3 ws5c">Python <span class="ff1">文档</span></span></div><div class="t m0 x5 hd y34c8 ff2 fs4 fc4 sc0 ls0 wsd91">16.12<span class="_ _e"> </span>14.12 <span class="ff1">调试基本的程序崩溃错误</span></div><div class="t m0 x5 he y66a ff2 fs2 fc4 sc0 ls0 wsadf">16.12.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y34c9 ff1 fs3 fc0 sc0 ls0">你的程序奔溃后该怎样去调试它？</div><div class="t m0 x5 he y34ca ff2 fs2 fc4 sc0 ls0 wsadf">16.12.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h9 y34cb ff1 fs3 fc0 sc0 ls0 ws12f5">如果<span class="_ _6"></span>你<span class="_ _6"></span>的<span class="_ _6"></span>程序<span class="_ _6"></span>因<span class="_ _6"></span>为某<span class="_ _6"></span>个<span class="_ _6"></span>异<span class="_ _6"></span>常而<span class="_ _6"></span>奔<span class="_ _6"></span>溃，运<span class="_ _6"></span>行 <span class="ff6 ws12f6">python3 -<span class="_ _6"></span>i someprogram.py<span class="_ _7"> </span></span><span class="wsa0">可执<span class="_ _6"></span>行<span class="_ _6"></span>简</span></div><div class="t m0 x5 h7 y34cc ff1 fs3 fc0 sc0 ls0 ws12f7">单<span class="_ _6"></span>的调<span class="_ _6"></span>试。 <span class="ff6 ws12f8">-<span class="_ _6"></span>i </span><span class="ls40 ws12f9">选项可让程序结束后打开一个交互式 </span><span class="ff4 wsa5">shell</span><span class="ls40 ws180">。然后你就能查看环境<span class="_ _1"></span>，例</span></div><div class="t m0 x5 h9 y34cd ff1 fs3 fc0 sc0 ls0">如，假设你有下面的代码：</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 wsd97">16.12.<span class="_ _36"> </span>14.12 <span class="ff1 wse2d">调试基本的程序崩溃错误 </span>534</div><a class="l" href="https://docs.python.org/3/library/warnings.html"><div class="d m1" style="border-style:none;position:absolute;left:562.165500px;bottom:497.101500px;width:65.370000px;height:16.821000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
