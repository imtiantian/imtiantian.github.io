<div id="pf17b" class="pf w0 h0" data-page-no="17b"><div class="pc pc17b w0 h0"><img class="bi x13 y5 w2 ha" alt="" src="bg17b.png"/><div class="t m0 xd h9 y75 ff1 fs3 fc0 sc0 lsb">《<span class="ff2 ls0 wsce">Python Co<span class="_ _6"></span>okb<span class="_ _6"></span>o<span class="_ _6"></span>ok</span><span class="ls0 wsa0">》第三版<span class="ff2 wsce">, Release 2.0.0</span></span></div><div class="t m0 x5 hf y1ab ff7 fs5 fca sc0 ls0 ws157">if <span class="ff8 ws13a">isinstance<span class="fc0 ws4">(x, mymodule<span class="fc6 ls34">.<span class="fc0">a</span></span></span><span class="fc6">.<span class="fc0 ws158">A): <span class="ffa fcd ws4"># Ok</span></span></span></span></div><div class="t m0 x5 hf y1ac ff8 fs5 fc6 sc0 ls0 ws13a">...</div><div class="t m0 x0 h7 y85b ff1 fs3 fc0 sc0 ls0 wsa0">延迟加载的真实例子<span class="ff4 ls83">,</span><span class="ws14">见标准库 <span class="ff4 wscf0">m<span class="_ _1"></span>ultipro<span class="_ _6"></span>cessing/<span class="_ _e"> </span>init<span class="_ _e"> </span>.p<span class="_ _1"></span>y <span class="ff1 wsa0">的源码</span>.</span></span></div><div class="t m0 x5 hd y270e ff2 fs4 fc4 sc0 ls0 ws211">12.5<span class="_ _e"> </span>10.5 <span class="ff1">利用命名空间导入目录分散的代码</span></div><div class="t m0 x5 he y270f ff2 fs2 fc4 sc0 ls0 ws212">12.5.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 y169 ff1 fs3 fc0 sc0 ls0 wsa0">你可能有大量的代码，<span class="_ _6"></span>由不同的人来分散地维护。<span class="_ _6"></span>每个部分被组织为文件<span class="_ _6"></span>目录，如</div><div class="t m0 x5 h9 y2710 ff1 fs3 fc0 sc0 ls1e ws111">一个包<span class="_ _1"></span>。然而，你希望能用共同的包<span class="_ _1"></span>前缀将所有组件连接起来，不是将每一个部<span class="_ _1"></span>分作</div><div class="t m0 x5 h9 y2711 ff1 fs3 fc0 sc0 ls0">为独立的包来安装。</div><div class="t m0 x5 he y2712 ff2 fs2 fc4 sc0 ls0 ws212">12.5.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 ydc6 ff1 fs3 fc0 sc0 ls18 ws231">从本质上讲，你要定义一个顶级 <span class="ff4 ls0 ws453">Python </span><span class="ws110">包，作为一个大集合分开维护子包的命名<span class="_ _1"></span></span></div><div class="t m0 x5 h9 ydc7 ff1 fs3 fc0 sc0 ls13 wse5">空间<span class="_ _1"></span>。这个问题经常出现在大的应用框架中，框架开发者希望鼓励用户发布插件或附<span class="_ _c"></span></div><div class="t m0 x5 h9 y2713 ff1 fs3 fc0 sc0 ls0">加包。</div><div class="t m0 x0 h9 y2714 ff1 fs3 fc0 sc0 ls6d ws2a0">在统一不同的目录里统一相同的命名空间<span class="_ _8"></span>，但是要删去用来将组件联合起来<span class="_ _8"></span></div><div class="t m0 x5 h7 y2715 ff1 fs3 fc0 sc0 ls1ac">的<span class="ff4 ls0 wscf0">init<span class="_ _e"> </span>.p<span class="_ _1"></span>y <span class="ff1 ws63">文件。假设你有 </span><span class="ws5c">Python <span class="ff1">代码的两个不同的目录如下：</span></span></span></div><div class="t m0 x5 hf y2716 ff8 fs5 fc0 sc0 ls0 ws13a">foo<span class="fc6 ls34">-</span>package<span class="fc6">/</span></div><div class="t m0 x15 hf y2717 ff8 fs5 fc0 sc0 ls0 ws13a">spam<span class="fc6">/</span></div><div class="t m0 x16 hf y2718 ff8 fs5 fc0 sc0 ls0 ws13a">blah<span class="fc6">.</span>py</div><div class="t m0 x5 hf y2719 ff8 fs5 fc0 sc0 ls0 ws13a">bar<span class="fc6 ls34">-</span>package<span class="fc6">/</span></div><div class="t m0 x15 hf y271a ff8 fs5 fc0 sc0 ls0 ws13a">spam<span class="fc6">/</span></div><div class="t m0 x16 hf y271b ff8 fs5 fc0 sc0 ls0 ws13a">grok<span class="fc6">.</span>py</div><div class="t m0 x0 h7 y271c ff1 fs3 fc0 sc0 ls0 wsd34">在 这<span class="_ _1c"> </span><span class="ff4 ls1b9">2</span><span class="ls1ba wsd35">个目录里<span class="_ _1d"></span>，都有着共同的命名空间 <span class="ff4 ls0 wsa5">spam</span><span class="wsd36">。在任何一个目录里都没<span class="_ _1d"></span></span></span></div><div class="t m0 x5 h7 y271d ff1 fs3 fc0 sc0 ls1ac">有<span class="ff4 ls0 wscf0">init<span class="_ _e"> </span>.p<span class="_ _1"></span>y <span class="ff1">文件。</span></span></div><div class="t m0 x0 h7 y271e ff1 fs3 fc0 sc0 ls0 ws8f9">让我们看看，如果将 <span class="ff4 wsd37">fo<span class="_ _6"></span>o-pac<span class="_ _1"></span>kage <span class="ff1 ls2a">和</span><span class="ws60f">bar-pac<span class="_ _1"></span>kage <span class="ff1 wsd38">都加到 </span><span class="wsd39">python <span class="ff1 wsa0">模块路径并尝试导</span></span></span></span></div><div class="t m0 x5 h9 y271f ff1 fs3 fc0 sc0 ls0">入会发生什么</div><div class="t m0 x5 h10 y14e2 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">sys</span></span></div><div class="t m0 x5 hf y2720 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="ff8 fc0 ws13a">sys<span class="fc6 ls34">.</span>path<span class="fc6">.</span>extend([<span class="ff9 fc9 ls34">&apos;</span><span class="fc9">foo-package<span class="ff9 ls34">&apos;</span></span><span class="ls32">,<span class="ff9 fc9 ls34">&apos;</span></span><span class="fc9">bar-package<span class="ff9 ls34">&apos;</span></span>])</span></div><div class="t m0 x5 h10 y2721 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">spam.blah</span></span></div><div class="t m0 x5 h10 y2722 ff7 fs5 fc5 sc0 ls0 ws139">&gt;&gt;&gt; <span class="fca ws146">import <span class="fcc">spam.grok</span></span></div><div class="t m0 x5 hf y2723 ff8 fs5 fc8 sc0 ls0">&gt;&gt;&gt;</div><div class="t m0 x0 h7 y2724 ff1 fs3 fc0 sc0 ls42 wsd3a">两个不同的包目录被合并到一起，你可以导入 <span class="ff4 ls0 wsd3b">spam.blah </span><span class="ls57">和<span class="ff4 ls0 wsa5">spam.grok</span></span><span class="ws186">，并且它们<span class="_ _1"></span></span></div><div class="t m0 x5 h9 y2725 ff1 fs3 fc0 sc0 ls0">能够工作。</div><div class="t m0 x5 h9 y29 ff2 fs3 fc0 sc0 ls0 ws21d">12.5.<span class="_ _5"> </span>10.5 <span class="ff1 wsd3c">利用命名空间导入目录分散的代码 </span>370</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
