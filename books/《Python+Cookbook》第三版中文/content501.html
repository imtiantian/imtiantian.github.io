<div id="pf1f5" class="pf w0 h0" data-page-no="1f5"><div class="pc pc1f5 w0 h0"><img class="bi x13 y5 w2 hb" alt="" src="bg1f5.png"/><div class="t m0 xe h8 y76 ff2 fs3 fc0 sc0 ls0">CHAPTER</div><div class="t m0 x49 hc y77 ff2 fs4 fc0 sc0 ls0">FIFTEEN</div><div class="t m0 x4a hd y78 ff1 fs4 fc0 sc0 ls0">第十三章：脚本编程与系统管理</div><div class="t m0 x0 h7 y79 ff1 fs3 fc0 sc0 ls0 ws11df">许多人<span class="_ _6"></span>使用 <span class="ff4 ws1152">Python </span><span class="ws86e">作为一<span class="_ _6"></span>个 <span class="ff4 ws11e0">shell </span><span class="ls2c ws12f">脚本的替代，用来实现常用系统任务的自动化<span class="_ _1"></span>，</span></span></div><div class="t m0 x5 h9 ycf ff1 fs3 fc0 sc0 ls13 wse5">如文件的操作<span class="_ _1"></span>，系统的配置等。本章的主要目标是描述光宇编写脚本时候经常遇到的<span class="_ _c"></span></div><div class="t m0 x5 h7 yd0 ff1 fs3 fc0 sc0 ls22 ws11e1">一些功能。例如<span class="_ _c"></span>，解析命令行选项、获取有用的系统配置数据等等。第 <span class="ff4 ls152">5</span><span class="ws119">章也包含了<span class="_ _c"></span></span></div><div class="t m0 x5 h9 yd1 ff1 fs3 fc0 sc0 ls0">与文件和目录相关的一般信息。</div><div class="t m0 x0 h7 yd2 ff4 fs3 fc0 sc0 ls0 wsa5">Con<span class="_ _1"></span>ten<span class="_ _1"></span>ts:</div><div class="t m0 x5 hd yd3 ff2 fs4 fc4 sc0 ls0 ws211">15.1<span class="_ _e"> </span>13.1 <span class="ff1 ws117f">通过重定向</span><span class="ls198">/</span><span class="ff1 ws117f">管道</span><span class="ls198">/</span><span class="ff1">文件接受输入</span></div><div class="t m0 x5 he yd4 ff2 fs2 fc4 sc0 ls0 ws212">15.1.1 <span class="ff1">问题</span></div><div class="t m0 x0 h9 yd5 ff1 fs3 fc0 sc0 ls3a ws153">你希望你的脚本接受任何用户认为最简单的输入方式。包括将命令行的输出通过管</div><div class="t m0 x5 h9 yd6 ff1 fs3 fc0 sc0 ls13 wse5">道传递给该脚本<span class="_ _1"></span>、重定向文件到该脚本，或在命令行中传递一个文件名或文件名列表<span class="_ _c"></span></div><div class="t m0 x5 h9 y524 ff1 fs3 fc0 sc0 ls0">给该脚本。</div><div class="t m0 x5 he y525 ff2 fs2 fc4 sc0 ls0 ws212">15.1.2 <span class="ff1">解决方案</span></div><div class="t m0 x0 h7 y3158 ff4 fs3 fc0 sc0 ls0 ws5c">Python <span class="ff1 ws38">内置的 <span class="ff6 ws1d1">fileinput </span>模块让这个变得简单。如果你有一个下面这样的脚本：</span></div><div class="t m0 x5 h11 y3159 ffa fs5 fcd sc0 ls0 ws4">#!/usr/bin/env python3</div><div class="t m0 x5 h10 y315a ff7 fs5 fca sc0 ls0 ws146">import <span class="fcc">fileinput</span></div><div class="t m0 x5 hf y315b ff7 fs5 fca sc0 ls0 ws15a">with <span class="ff8 fc0 ws13a">fileinput<span class="fc6 ls34">.</span><span class="ws155">input() </span></span><span class="ws157">as <span class="ff8 fc0">f_input:</span></span></div><div class="t m0 x15 hf y315c ff7 fs5 fca sc0 ls0 ws139">for <span class="ff8 fc0 ws161">line </span><span class="ws160">in <span class="ff8 fc0">f_input:</span></span></div><div class="t m0 x16 hf y315d ff7 fs5 fca sc0 ls0 ws156">print<span class="ff8 fc0 ws4">(line, end<span class="fc6 ws13a">=<span class="ff9 fc9 ls34">&apos;&apos;</span></span>)</span></div><div class="t m0 x0 h9 y315e ff1 fs3 fc0 sc0 ls63 ws21f">那么你就能以前面提到的所有方式来为此脚本提供输入<span class="_ _c"></span>。假设你将此脚本保存为<span class="_ _1"></span></div><div class="t m0 x5 h9 y350 ff6 fs3 fc0 sc0 ls0 ws1d1">filein.py <span class="ff1">并将其变为可执行文件，那么你可以像下面这样调用它，得到期望的输出：</span></div><div class="t m0 x5 hf y315f ff8 fs5 fc13 sc0 ls32">$<span class="fc0 ls0 ws15c">ls <span class="ffd ls215">|</span><span class="ws11e2">./filein.py <span class="ffa fcd ws4"># Prints a directory listing to stdout.</span></span></span></div><div class="t m0 x5 hf y3160 ff8 fs5 fc13 sc0 ls32">$<span class="fc0 ls0 ws4">./filein.py /etc/passwd<span class="_ _3a"> </span><span class="ffa fcd"># Reads /etc/passwd to stdout.</span></span></div><div class="t m0 x5 hf y3161 ff8 fs5 fc13 sc0 ls32">$<span class="fc0 ls0 ws4">./filein.py &lt; /etc/passwd <span class="ffa fcd"># Reads /etc/passwd to stdout.</span></span></div><div class="t m0 x26 h8 y29 ff2 fs3 fc0 sc0 ls0">492</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
